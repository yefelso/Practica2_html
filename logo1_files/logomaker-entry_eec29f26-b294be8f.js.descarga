(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{118:function(e,t,n){var r,o,i,l,a=t,s=n(0),u=n(1),c=n(429),h=n(135),d=n(462),g=n(340),C=n(155),f=n(117),S=n(82),m=n(139),w=n(253),p=n(206),T=n(334),E=n(115),_=n(50),v=n(90),b=n(467);a.InteractionMode=s.defineEnum("InteractionMode",{DefaultInteraction:0,SelectionFocused:1,AutomaticGrid:2}),a.ClickMessage=(r=function(e,t){this.state=e,_.TheoMessage.call(this,r.TYPE,t)},s.defineClass({name:"ClickMessage",ctor:r,superName:"TheoMessage",statics:{TYPE:{get:function(){return"ClickMessage"}}}}),r),a.DoubleClickMessage=(o=function(e,t){this.state=e,_.TheoMessage.call(this,o.TYPE,t)},s.defineClass({name:"DoubleClickMessage",ctor:o,superName:"TheoMessage",statics:{TYPE:{get:function(){return"DoubleClickMessage"}}}}),o),a.DesignControllerPSMDelegate=(i=function(e){this.dc=e},s.defineClass({name:"DesignControllerPSMDelegate",ctor:i,statics:{_implements:function(e){return"IPSMDelegate"==e}},props:{handleEvent:function(e){var t,n,r,o;(t=s.as(e,S.PSMFormaDragControllerEvent))?this.dc.designControllerHandlesPointers?this.dc.designController.handles.handleFormaDragEvents(t):t.dragDelegate.dragController.onEvent(t):(n=s.as(e,S.BeginPointerTrackingEvent))?s.opt(n.forma.controller,function(e){return e.onEvent(n)}):(r=s.as(e,S.FormaClickEvent))?this.dc.designControllerHandlesPointers?this.dc.designController.click.handleClick(r):s.opt(r.forma.controller,function(e){return e.onEvent(r)}):(o=s.as(e,S.FormaDoubleClickEvent))&&(this.dc.designControllerHandlesPointers?this.dc.designController.click.handleDoubleClick(o):s.opt(o.forma.controller,function(e){return e.onEvent(o)}))}}}),i),a.DocumentController=(l=function(){this.blockNonSelectedUpdates_=!1,this.interactionMode_=a.InteractionMode.DefaultInteraction,this.pointerStateMachine_=null,this.viewScale_=1,this.designControllerHandlesPointers=!1,this.designControllerHandlesSwap=!0,this.controllerFactory_=new C.FormaControllerFactory(null),this.pointers_=new w.PointersState,this.selection_=new T.SelectionState,this.editorModel_=new g.EditorModel,this.designControllerFactory_=new d.DesignControllerFactory,this.controllerSettingsState_=new c.ControllerSettingsState,this.undoRedoMgr_=new b.UndoRedoManager,this.designController_=h.DesignController.NullController,v.TheoPublishingObject.call(this),this.controllerFactory_.owner=this,this.pointers_.owner=this,this.selection_.owner=this,this.editorModel_.owner=this,this.designControllerFactory_.owner=this,this.controllerSettingsState_.owner=this,this.undoRedoMgr_.owner=this,this.updateEditorModel(),this.selection_.subscribe(this,T.SelectionStateChangedMessage.TYPE),this.pointers_.subscribe(this,w.PointersStateChangeMessage.TYPE),u.CoreAssert.creatingDocumentSingleton(this)},s.defineClass({name:"DocumentController",ctor:l,superName:"TheoPublishingObject",statics:{_implements:function(e){return"TheoMessageSubscriber"==e||"TheoMessagePublisher"==e}},props:{controllerFactory:{get:function(){return this.controllerFactory_}},document:{get:function(){return this.doc_}},selection:{get:function(){return this.selection_}},model:{get:function(){return this.editorModel_}},designController:{get:function(){return this.designController_}},controllerSettingsState:{get:function(){return this.controllerSettingsState_}},pointers:{get:function(){return this.pointers_}},pointerStateMachine:{get:function(){return this.pointerStateMachine_}},undoRedoMgr:{get:function(){return this.undoRedoMgr_}},updateEditorModel:function(){this.designController_=this.designControllerFactory_.getNewDesignController(),this.model.beginUpdates(),s.opt(this.designController_,function(e){return e.configureEditorModel()}),this.model.updatesComplete()},onMessage:function(e){var t,n,r;if(e instanceof T.SelectionStateChangedMessage)this.updateEditorModel();else if(t=s.as(e,w.PointersStateChangeMessage))null==this.pointerStateMachine_&&t.changeType==w.PointersStateChangeTypeEnum.PointersDown?(this.pointerStateMachine_=new p.PointerStateMachine(new f.FormaPagePointerStateMachineDelegate(new a.DesignControllerPSMDelegate(this))),this.pointerStateMachine_.attach(this,this.pointers),this.pointerStateMachine_.onMessage(t)):null!=this.pointerStateMachine_&&0==this.pointers.pointerDownCount()&&(this.pointerStateMachine_.onMessage(t),this.pointerStateMachine_.detach(),this.pointerStateMachine_=null);else if(n=s.as(e,m.FormaEndUpdateMessage))this.selection.isSelected(n.event.forma)&&s.opt(this.designController_,function(e){return e.handles.updateHandles()});else if(r=s.as(e,E.TheoDocumentDidDecodeMessage)){var o;(o=s.opt(r.document,function(e){return e.firstPage}))&&this.subscribeToPage(o)}},notifyClick:function(e){this.publish(new a.ClickMessage(e,this))},notifyDoubleClick:function(e){this.publish(new a.DoubleClickMessage(e,this))},formaUpdateSubscription:{get:function(){return this.formaUpdateSubscription_},set:function(e){var t;(t=this.formaUpdateSubscription_)&&t.unsubscribe(),this.formaUpdateSubscription_=e}},subscribeToPage:function(e){this.formaUpdateSubscription=e.subscribe(this,m.FormaEndUpdateMessage.TYPE)},attach:function(e){var t,n=this;this.doc_=e,(t=s.opt(this.doc_,function(e){return e.firstPage}))&&this.subscribeToPage(t),s.opt(e,function(e){return e.subscribe(n,E.TheoDocumentDidDecodeMessage.TYPE)}),this.undoRedoMgr_.setup()},canDoAction:function(e){return this.designController.actions.canDoAction(e)},doAction:function(e){var t=!1;this.doActionWithCompletion(e,function(e){t=!0}),t||u.CoreAssert.warning("You've called doAction() which may presume the action is synchronous, but it's not. Consider using doActionWithCompletion instead.")},doActionWithCompletion:function(e,t){this.designController.actions.doActionWithCallback(e,t)},allowSelectionChanges:{get:function(){return this.interactionMode_!=a.InteractionMode.SelectionFocused}},setSelectionFocusedInteraction:function(){this.interactionMode_=a.InteractionMode.SelectionFocused},inSelectionFocusedInteractionMode:{get:function(){return this.interactionMode_==a.InteractionMode.SelectionFocused}},setAutomaticLayoutInteractionMode:function(){this.interactionMode_=a.InteractionMode.AutomaticGrid},inAutomaticLayoutInteractionMode:{get:function(){return this.interactionMode_==a.InteractionMode.AutomaticGrid}},setDefaultInteractionMode:function(){this.interactionMode_=a.InteractionMode.DefaultInteraction},inDefaultInteractionMode:{get:function(){return this.interactionMode_==a.InteractionMode.DefaultInteraction}},interactionMode:{get:function(){return this.interactionMode_},set:function(e){this.interactionMode_=e}},viewScale:{get:function(){return this.viewScale_},set:function(e){this.viewScale_=e}},updateHandles:function(){s.opt(this.designController_,function(e){return e.handles.updateHandles()})}}}),l)},156:function(e,t,n){var r,o,i,l,a,s=t,u=n(0),c=n(4);s.ControllerSettings=(r=function(e){this.type=e,c.CoreObject.call(this)},u.defineClass({name:"ControllerSettings",ctor:r,superName:"CoreObject"}),r),s.TypeLockupControllerSettings=(o=function(e){this.controller=e,s.ControllerSettings.call(this,o.TYPE)},u.defineClass({name:"TypeLockupControllerSettings",ctor:o,superName:"ControllerSettings",statics:{TYPE:{get:function(){return"TypeLockupControllerSettings"}}}}),o),s.ImageControllerSettings=(i=function(e){this.controller=e,s.ControllerSettings.call(this,i.TYPE)},u.defineClass({name:"ImageControllerSettings",ctor:i,superName:"ControllerSettings",statics:{TYPE:{get:function(){return"ImageControllerSettings"}}}}),i),s.RootControllerSettings=(l=function(e){this.controller=e,s.ControllerSettings.call(this,l.TYPE)},u.defineClass({name:"RootControllerSettings",ctor:l,superName:"ControllerSettings",statics:{TYPE:{get:function(){return"RootControllerSettings"}}}}),l),s.ShapeControllerSettings=(a=function(e){this.controller=e,s.ControllerSettings.call(this,a.TYPE)},u.defineClass({name:"ShapeControllerSettings",ctor:a,superName:"ControllerSettings",statics:{TYPE:{get:function(){return"ShapeControllerSettings"}}}}),a)},168:function(e,t,n){var r,o,i,l,a,s,u,c,h,d,g=t,C=n(0),f=n(4);g.BaseHandle=(r=function(){f.CoreObject.call(this)},C.defineClass({name:"BaseHandle",ctor:r,superName:"CoreObject"}),r),g.TransformType=C.defineEnum("TransformType",{None:0,RotateAboutCenter:1,Translate:2,ProportionalScaleAboutCenter:3,TopLeftCornerTranslate:4,TopRightCornerTranslate:5,BottomLeftCornerTranslate:6,BottomRightCornerTranslate:7,LeftSideTranslate:8,RightSideTranslate:9,TopSideTranslate:10,BottomSideTranslate:11,LetterSpacing:12,LineSpacing:13}),g.BoxReference=(o=function(e,t){this.placement=e,this.bounds=t},C.defineClass({name:"BoxReference",ctor:o,superName:"CoreObject"}),o),g.BoxHandleDisplayHint=C.defineEnum("BoxHandleDisplayHint",{ThinOutline:0,TextFrame:1,SuppressRotationHandle:2,SuppressResizeAnimation:3}),g.BoxTransformHandles=(i=function(e,t,n,r,o){this.reference=e,this.allowedTransforms=C.clone(t),this.displayHints=C.clone(n),this.activeTransform=r,this.handlesTarget=o},C.defineClass({name:"BoxTransformHandles",ctor:i,superName:"BaseHandle"}),i),g.BoxTransformMultipleFormae=(l=function(e,t,n,r,o,i){this.formaIDs=C.clone(i),g.BoxTransformHandles.call(this,e,C.clone(t),C.clone(n),r,o)},C.defineClass({name:"BoxTransformMultipleFormae",ctor:l,superName:"BoxTransformHandles"}),l),g.HandleTransformStage=C.defineEnum("HandleTransformStage",{Begin:0,Update:1,End:2}),g.HandleTransformEvent=(a=function(e,t){this.viewportScale=1,this.handle=e,this.stage=t},C.defineClass({name:"HandleTransformEvent",ctor:a,superName:"CoreObject"}),a),g.TranslateTransformEvent=(s=function(e,t,n){this.event=n,g.HandleTransformEvent.call(this,e,t)},C.defineClass({name:"TranslateTransformEvent",ctor:s,superName:"HandleTransformEvent"}),s),g.MoveTransformEvent=(u=function(e,t,n){this.totalDelta=n,g.HandleTransformEvent.call(this,e,t)},C.defineClass({name:"MoveTransformEvent",ctor:u,superName:"HandleTransformEvent"}),u),g.RotateAboutCenterTransformEvent=(c=function(e,t,n){this.totalDeltaRadians=n,g.HandleTransformEvent.call(this,e,t)},C.defineClass({name:"RotateAboutCenterTransformEvent",ctor:c,superName:"HandleTransformEvent"}),c),g.CornerTranslateTransformEvent=(h=function(e,t,n,r){this.transformType=n,this.position=r,g.HandleTransformEvent.call(this,e,t)},C.defineClass({name:"CornerTranslateTransformEvent",ctor:h,superName:"HandleTransformEvent"}),h),g.SideTranslateTransformEvent=(d=function(e,t,n,r){this.transformType=n,this.position=r,g.HandleTransformEvent.call(this,e,t)},C.defineClass({name:"SideTranslateTransformEvent",ctor:d,superName:"HandleTransformEvent"}),d)},239:function(e,t,n){var r,o,i=t,l=n(0),a=n(1),s=n(4),u=n(104),c=n(26),h=n(25),d=n(116),g=n(8),C=n(21),f=n(316),S=n(10);i.GridLibrary=(r=function(){this.gridStyles=[new d.GridStyle("Single","Simple",[new h.GridCell(new S.TheoRect(0,0,1,1))],void 0,void 0,void 0,c.CropType.PreserveFocus),new d.GridStyle("Single-Overlap","Banner",[new h.GridCell(new S.TheoRect(0,0,1,1)),new h.GridCell(new S.TheoRect(.25,0,.75,1),null,.75)]),new d.GridStyle("Single-Center-Overlap","Banner",[new h.GridCell(new S.TheoRect(0,0,1,1)),new h.GridCell(new S.TheoRect(.25,.25,.75,.75),null,.75)]),new d.GridStyle("Half-2",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,1)),new h.GridCell(new S.TheoRect(.5001,0,1,1))]),new d.GridStyle("Third-2",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,1,1))]),new d.GridStyle("Half-2-1",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,.5001)),new h.GridCell(new S.TheoRect(0,.5001,.5001,1)),new h.GridCell(new S.TheoRect(.5001,0,1,1))]),new d.GridStyle("Third-2-1",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,1,.5001)),new h.GridCell(new S.TheoRect(1/3,.5001,1,1))]),new d.GridStyle("Third-3",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1))]),new d.GridStyle("Half-2-2",void 0,[new h.GridCell(new S.TheoRect(0,0,.5,.5)),new h.GridCell(new S.TheoRect(0,.5,.5,1)),new h.GridCell(new S.TheoRect(.5,0,1,.5)),new h.GridCell(new S.TheoRect(.5,.5,1,1))]),new d.GridStyle("Half-3-1",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1/3)),new h.GridCell(new S.TheoRect(0,1/3,1/3,2/3)),new h.GridCell(new S.TheoRect(0,2/3,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,1,1))]),new d.GridStyle("Half-1-3",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,1)),new h.GridCell(new S.TheoRect(.5001,0,1,1/3)),new h.GridCell(new S.TheoRect(.5001,1/3,1,2/3)),new h.GridCell(new S.TheoRect(.5001,2/3,1,1))]),new d.GridStyle("Third-1-2-1",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,.5001)),new h.GridCell(new S.TheoRect(1/3,.5001,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1))]),new d.GridStyle("Half-2-2-Offset",void 0,[new h.GridCell(new S.TheoRect(.5,0,1,.35)),new h.GridCell(new S.TheoRect(0,.65,.5,1)),new h.GridCell(new S.TheoRect(0,0,.5,.65)),new h.GridCell(new S.TheoRect(.5,.35,1,1))]),new d.GridStyle("Fourth-1",void 0,[new h.GridCell(new S.TheoRect(0,0,.25,1)),new h.GridCell(new S.TheoRect(.25,0,.5001,1)),new h.GridCell(new S.TheoRect(.5001,0,.75,1)),new h.GridCell(new S.TheoRect(.75,0,1,1))]),new d.GridStyle("Half-2-3",void 0,[new h.GridCell(new S.TheoRect(0,0,1,.5001)),new h.GridCell(new S.TheoRect(0,.5001,.5001,1)),new h.GridCell(new S.TheoRect(.5001,.5001,1,.75)),new h.GridCell(new S.TheoRect(.5001,.75,1,1))]),new d.GridStyle("Half-1-3",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,1)),new h.GridCell(new S.TheoRect(.5001,0,.75,.5001)),new h.GridCell(new S.TheoRect(.75,0,1,.5001)),new h.GridCell(new S.TheoRect(.5001,.5001,1,1))]),new d.GridStyle("Third-2-3-2",void 0,[new h.GridCell(new S.TheoRect(0,0,.75,.25)),new h.GridCell(new S.TheoRect(.75,0,1,.75)),new h.GridCell(new S.TheoRect(.25,.25,.75,.75)),new h.GridCell(new S.TheoRect(0,.25,.25,1)),new h.GridCell(new S.TheoRect(.25,.75,1,1))]),new d.GridStyle("Third-1-3-1",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,1/3)),new h.GridCell(new S.TheoRect(1/3,1/3,2/3,2/3)),new h.GridCell(new S.TheoRect(1/3,2/3,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1))]),new d.GridStyle("Fifth-5",void 0,[new h.GridCell(new S.TheoRect(0,0,.2,1)),new h.GridCell(new S.TheoRect(.2,0,.4,1)),new h.GridCell(new S.TheoRect(.4,0,.6,1)),new h.GridCell(new S.TheoRect(.6,0,.8,1)),new h.GridCell(new S.TheoRect(.8,0,1,1))]),new d.GridStyle("Third-2-1-2",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,2/3)),new h.GridCell(new S.TheoRect(0,2/3,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1/3)),new h.GridCell(new S.TheoRect(2/3,1/3,1,1))]),new d.GridStyle("Third-1-1-4",void 0,[new h.GridCell(new S.TheoRect(0,0,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,.25)),new h.GridCell(new S.TheoRect(2/3,.25,1,.5001)),new h.GridCell(new S.TheoRect(2/3,.5001,1,.75)),new h.GridCell(new S.TheoRect(2/3,.75,1,1))]),new d.GridStyle("Split-3-2",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,.5001)),new h.GridCell(new S.TheoRect(0,.5001,.5001,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,.5001)),new h.GridCell(new S.TheoRect(2/3,0,1,.5001)),new h.GridCell(new S.TheoRect(.5001,.5001,1,1))]),new d.GridStyle("Split-2-3",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,.5001)),new h.GridCell(new S.TheoRect(0,.5001,1/3,1)),new h.GridCell(new S.TheoRect(.5001,0,1,.5001)),new h.GridCell(new S.TheoRect(1/3,.5001,2/3,1)),new h.GridCell(new S.TheoRect(2/3,.5001,1,1))]),new d.GridStyle("Half-3-3",void 0,[new h.GridCell(new S.TheoRect(0,0,.5,1/3)),new h.GridCell(new S.TheoRect(0,1/3,.5,2/3)),new h.GridCell(new S.TheoRect(0,2/3,.5,1)),new h.GridCell(new S.TheoRect(.5,0,1,1/3)),new h.GridCell(new S.TheoRect(.5,1/3,1,2/3)),new h.GridCell(new S.TheoRect(.5,2/3,1,1))]),new d.GridStyle("Split-2-2-2",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,2/3)),new h.GridCell(new S.TheoRect(0,2/3,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,.5001)),new h.GridCell(new S.TheoRect(1/3,.5001,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1/3)),new h.GridCell(new S.TheoRect(2/3,1/3,1,1))]),new d.GridStyle("Quarter-2-2-2-2",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,2/3)),new h.GridCell(new S.TheoRect(0,2/3,.25,1)),new h.GridCell(new S.TheoRect(.25,2/3,.5001,1)),new h.GridCell(new S.TheoRect(.5001,0,.75,1/3)),new h.GridCell(new S.TheoRect(.75,0,1,1/3)),new h.GridCell(new S.TheoRect(.5001,1/3,1,1))]),new d.GridStyle("Third-2-2-3",void 0,[new h.GridCell(new S.TheoRect(0,0,2/3,2/3)),new h.GridCell(new S.TheoRect(0,2/3,1/3,1)),new h.GridCell(new S.TheoRect(1/3,2/3,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1/3)),new h.GridCell(new S.TheoRect(2/3,1/3,1,2/3)),new h.GridCell(new S.TheoRect(2/3,2/3,1,1))]),new d.GridStyle("Third-3-2-2",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1/3)),new h.GridCell(new S.TheoRect(0,1/3,1/3,2/3)),new h.GridCell(new S.TheoRect(0,2/3,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,1,2/3)),new h.GridCell(new S.TheoRect(1/3,2/3,2/3,1)),new h.GridCell(new S.TheoRect(2/3,2/3,1,1))]),new d.GridStyle("Split-3-1-3",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1/3)),new h.GridCell(new S.TheoRect(0,1/3,1,2/3)),new h.GridCell(new S.TheoRect(0,2/3,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,1/3)),new h.GridCell(new S.TheoRect(1/3,2/3,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1/3)),new h.GridCell(new S.TheoRect(2/3,2/3,1,1))]),new d.GridStyle("Split-2-3-2",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,1/3)),new h.GridCell(new S.TheoRect(0,1/3,1/3,2/3)),new h.GridCell(new S.TheoRect(0,2/3,.5001,1)),new h.GridCell(new S.TheoRect(1/3,1/3,2/3,2/3)),new h.GridCell(new S.TheoRect(.5001,0,1,1/3)),new h.GridCell(new S.TheoRect(2/3,1/3,1,2/3)),new h.GridCell(new S.TheoRect(.5001,2/3,1,1))]),new d.GridStyle("Half-4-4",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,.25)),new h.GridCell(new S.TheoRect(0,.25,.5001,.5001)),new h.GridCell(new S.TheoRect(0,.5001,.5001,.75)),new h.GridCell(new S.TheoRect(0,.75,.5001,1)),new h.GridCell(new S.TheoRect(.5001,0,1,.25)),new h.GridCell(new S.TheoRect(.5001,.25,1,.5001)),new h.GridCell(new S.TheoRect(.5001,.5001,1,.75)),new h.GridCell(new S.TheoRect(.5001,.75,1,1))]),new d.GridStyle("Split-3-2-3",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1/3)),new h.GridCell(new S.TheoRect(0,1/3,.5001,2/3)),new h.GridCell(new S.TheoRect(0,2/3,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,1/3)),new h.GridCell(new S.TheoRect(1/3,2/3,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1/3)),new h.GridCell(new S.TheoRect(.5001,1/3,1,2/3)),new h.GridCell(new S.TheoRect(2/3,2/3,1,1))]),new d.GridStyle("Third-3-3-3",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,1/3)),new h.GridCell(new S.TheoRect(0,1/3,1/3,2/3)),new h.GridCell(new S.TheoRect(0,2/3,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,1/3)),new h.GridCell(new S.TheoRect(1/3,1/3,2/3,2/3)),new h.GridCell(new S.TheoRect(1/3,2/3,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,1/3)),new h.GridCell(new S.TheoRect(2/3,1/3,1,2/3)),new h.GridCell(new S.TheoRect(2/3,2/3,1,1))]),new d.GridStyle("Third-4-1-4",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,.25)),new h.GridCell(new S.TheoRect(0,.25,1/3,.5001)),new h.GridCell(new S.TheoRect(0,.5001,1/3,.75)),new h.GridCell(new S.TheoRect(0,.75,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,.25)),new h.GridCell(new S.TheoRect(2/3,.25,1,.5001)),new h.GridCell(new S.TheoRect(2/3,.5001,1,.75)),new h.GridCell(new S.TheoRect(2/3,.75,1,1))]),new d.GridStyle("Third-4-3-2",void 0,[new h.GridCell(new S.TheoRect(0,0,1/3,.25)),new h.GridCell(new S.TheoRect(0,.25,1/3,.5001)),new h.GridCell(new S.TheoRect(0,.5001,1/3,.75)),new h.GridCell(new S.TheoRect(0,.75,1/3,1)),new h.GridCell(new S.TheoRect(1/3,0,2/3,1/3)),new h.GridCell(new S.TheoRect(1/3,1/3,2/3,2/3)),new h.GridCell(new S.TheoRect(1/3,2/3,2/3,1)),new h.GridCell(new S.TheoRect(2/3,0,1,.5001)),new h.GridCell(new S.TheoRect(2/3,.5001,1,1))]),new d.GridStyle("Split-2-3-4",void 0,[new h.GridCell(new S.TheoRect(0,0,.5001,1/3)),new h.GridCell(new S.TheoRect(0,1/3,1/3,2/3)),new h.GridCell(new S.TheoRect(0,2/3,.25,1)),new h.GridCell(new S.TheoRect(.5001,0,1,1/3)),new h.GridCell(new S.TheoRect(1/3,1/3,2/3,2/3)),new h.GridCell(new S.TheoRect(.25,2/3,.5001,1)),new h.GridCell(new S.TheoRect(2/3,1/3,1,2/3)),new h.GridCell(new S.TheoRect(.5001,2/3,.75,1)),new h.GridCell(new S.TheoRect(.75,2/3,1,1))])],s.CoreObject.call(this)},o={},l.defineClass({name:"GridLibrary",ctor:r,superName:"CoreObject",statics:{instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}}},props:{layoutSuggestionModel:{get:function(){return null==this.layoutSuggestionModel_&&(this.layoutSuggestionModel_=l.opt(g.Host.learning,function(e){return e.loadLayoutSuggestionModel()})),this.layoutSuggestionModel_},set:function(e){this.layoutSuggestionModel_=e}},canFlipStyle:function(e){return!["Single","Single-Center-Overlap","Half-2-2","Third-2-3-2","Third-2-3-2-Spaced","Third-3-3-3","Third-2-2-3","Half-2-3","Third-4-3-2","Half-1-3","Third-3-2-2","Split-2-3-4"].includes(e.name)},basicFullDesignGridStyle:function(){var e=this.getGridStyle("Single");return e.moveableShift=!1,e},getAllGrids:function(){for(var e=[],t=l.iter(this.gridStyles);!t.done;t.next()){var n=t.value;e.push(n),this.canFlipStyle(n)&&e.push(n.flipRegion())}return e},getLayoutsForRoot:function(e,t){void 0===t&&(t=null);var n,r=[],o=[];if(!(n=e.controller.getGridController()))return a.CoreAssert.fail("should always have a grid at this point"),[];for(var i=u.DesignSuggestion.init_a05b(n.forma),s=f.LayoutSuggester.init_bfe3(n.forma,i,l.clone(t)),c=l.clone(e.filterWithCallback(function(e){return null!=e.controller&&e.controller.floating})),h=l.clone(e.filterWithCallback(function(e){return null!=e.parent&&e.parent.isBackgroundImage()})),d=h.length,g=!0,S=l.iter(h);!S.done;S.next()){var m=S.value;if(l.opt(l.opt(l.as(m,C.ImageForma),function(e){return e.contentNode}),function(e){return null==e.focusRegion})){g=!1;break}}var w=[],p=1,T=g&&d>1?1:0,E=g?1:2,_=g?1:0;d>5&&(g?(p=0==c.length?2:1,T=0==c.length?2:1,E=0==c.length?0:1,_=0==c.length?0:1):(p=0==c.length?4:2,E=0==c.length?0:2));var v,b=l.clone(s.createSuggestions(!0,!1,!1,!1,p));(o=l.clone(s.createEqualSizeSuggestions(!1,10)),l.append(b,o),b.length>0&&l.append(w,b.slice(0,Math.min(p,b.length))),g&&(b=l.clone(s.createSuggestions(!0,!1,!1,!0,T))).length>0&&l.append(w,b.slice(0,Math.min(T,b.length))),0==!c.length)&&((v=l.clone(s.createSuggestions(!0,!1,!0,!1,E))).length>0&&l.append(w,v.slice(0,Math.min(E,v.length))),g&&(v=l.clone(s.createSuggestions(!0,!1,!0,!0,_))).length>0&&l.append(w,v.slice(0,Math.min(_,v.length))),l.append(o,s.createEqualSizeSuggestions(!0,10)));for(var D=l.iter(l.range(0,w.length,!1));!D.done;D.next())(x=w[M=D.value]).gridStyle.name="ContentAwareGrid-"+l.toString(M),x.gridStyle.category="Suggested",x.gridStyle.forma=n.forma,r.push(x.gridStyle);for(var y=l.clone(s.predictLayoutIds(3,l.clone(r))),R=l.iter(y);!R.done;R.next()){var P=R.value;if(L=this.getGridStyle(P)){var I=L.clone();I.category="Suggested",r.push(I)}}i.dispose();for(var F=e.filterWithCallback(function(e){return e.isBackgroundImage()}).length,G=[],k=l.iter(this.gridStyles);!k.done;k.next()){var L;(L=k.value).nonOverlappingCells().length>=F&&(r.push(L),G.push(L),this.canFlipStyle(L)&&(r.push(L.flipRegion()),G.push(L.flipRegion())))}for(var A=l.iter(l.range(0,o.length,!1));!A.done;A.next()){for(var M,x,B=(x=o[M=A.value]).gridStyle,K=!1,z=l.iter(G);!z.done;z.next())if(z.value.geometricEquals(B)){K=!0;break}K||r.push(B)}return r},getGridsByCellNumber:function(e,t){if(void 0===t&&(t=!0),1==e&&0==t)return[this.getGridStyle("Single")];for(var n=[],r=l.iter(this.gridStyles);!r.done;r.next()){var o=r.value,i=o.nonOverlappingCells().length;(t?i>=e:i==e)&&!o.anyOverlap&&(n.push(o),this.canFlipStyle(o)&&n.push(o.flipRegion()))}return 0==n.length&&a.CoreAssert.fail("No matching grids in the library. Need to implement a generic grid creator."),n},getGridStyle:function(e){for(var t,n=l.iter(this.gridStyles);!n.done;n.next()){var r=n.value;if(e==r.name){t=r;break}if(this.canFlipStyle(r)){var o=r.flipRegion();if(e==o.name){t=o;break}}}return t},getCategoryForStyle:function(e){var t;return null!=(t=e.category)?t:"Single"==e.name?"Simple":e.name.includes("Overlap")?"Banner":e.name.includes("ContentAwareGrid")?"Suggested":"Grid"}}}),r)},340:function(e,t,n){var r,o,i,l,a=t,s=n(0),u=n(1),c=n(11),h=n(50),d=n(90);a.EditorModel=(r=function(){this.updateDepth_=0,this.state_=new a.EditorModelState,this.startingState_=new a.EditorModelState,d.TheoPublishingObject.call(this)},s.defineClass({name:"EditorModel",ctor:r,superName:"TheoPublishingObject",statics:{_implements:function(e){return"TheoMessagePublisher"==e}},props:{getAttribute:function(e){return this.state_.attributes[e]},setAttribute:function(e){u.CoreAssert.isTrue(this.updateDepth_>0,"setAttribute outside of an update context"),this.state_.attributes[e.key]=e},clearAttribute:function(e){u.CoreAssert.isTrue(this.updateDepth_>0,"clearAttribute outside of an update context"),s.removeKey(this.state_.attributes,e)},getHandles:function(){return this.state_.handles},setHandles:function(e){u.CoreAssert.isTrue(this.updateDepth_>0,"setHandles outside of an update context"),this.state_.handles=s.clone(e)},getSwapState:function(){return this.state_.swapState},setSwapState:function(e){u.CoreAssert.isTrue(this.updateDepth_>0,"setSwapState outside of an update context"),this.state_.swapState=e},getSnaplines:function(){return this.state_.snaplines},setSnaplines:function(e){u.CoreAssert.isTrue(this.updateDepth_>0,"setSnaplines outside of an update context"),this.state_.snaplines=s.clone(e)},clearFeatureSets:function(){s.removeAll(this.state_.featureSets)},setFeatureSet:function(e){u.CoreAssert.isTrue(this.updateDepth_>0,"setFeatureSet outside of an update context"),this.state_.featureSets[e.key]=e},removeFeatureSet:function(e){u.CoreAssert.isTrue(this.updateDepth_>0,"removeFeatureSet outside of an update context"),s.removeKey(this.state_.featureSets,e)},getFeatureSet:function(e){return this.state_.featureSets[e]},beginUpdates:function(){this.updateDepth_+=1,1==this.updateDepth_&&(this.startingState_=this.state_.clone())},updatesComplete:function(){if(this.updateDepth_-=1,0==this.updateDepth_){var e=s.clone(this.state_.calculateChanges(this.startingState_));e.length>0&&this.publish(new a.EditorModelChangedMessage(this,s.clone(e)))}}}}),r),a.EditorModelChangedMessage=(o=function(e,t){this.changes=s.clone(t),h.TheoMessage.call(this,o.TYPE,e)},s.defineClass({name:"EditorModelChangedMessage",ctor:o,superName:"TheoMessage",statics:{TYPE:{get:function(){return"EditorModelChangedMessage"}}}}),o),a.EditorModelState=(i=function(){this.attributes={},this.featureSets={},this.handles=[],this.swapState=new a.SwapState(null,null),this.snaplines=[]},s.defineClass({name:"EditorModelState",ctor:i,props:{clone:function(){var e=new i;return e.attributes=s.clone(this.attributes),e.featureSets=s.clone(this.featureSets),e.handles=s.clone(this.handles),e.swapState=this.swapState,e.snaplines=s.clone(this.snaplines),e},calculateChanges:function(e){var t=[];return s.append(t,this.diffAttributes(s.clone(e.attributes))),s.append(t,this.diffFeatures(s.clone(e.featureSets))),s.append(t,this.diffHandles(s.clone(e.handles))),s.append(t,this.diffSwapState(e.swapState)),s.append(t,this.diffSnaplines(s.clone(e.snaplines))),t},diffAttributes:function(e){for(var t=[],n=s.iter(this.attributes);!n.done;n.next()){var r,o=n.key,i=n.value;(r=e[o])&&i.isEqualTo(r)||t.push("attribute:"+o)}for(var l=s.iter(e);!l.done;l.next())o=l.key,null==this.attributes[o]&&t.push("attribute:"+o);return t},diffFeatures:function(e){for(var t=[],n=s.iter(this.featureSets);!n.done;n.next()){var r,o=n.key,i=n.value;(r=e[o])&&i.isEqualTo(r)||t.push("feature-set:"+o)}for(var l=s.iter(e);!l.done;l.next())o=l.key,null==this.featureSets[o]&&t.push("feature-set:"+o);return t},diffHandles:function(e){return["handles"]},diffSwapState:function(e){return s.eq(c._equality_Forma_Forma,this.swapState.swapThumbnailForma,e.swapThumbnailForma)&&this.swapState.swapThumbnailLocation==e.swapThumbnailLocation?[]:["swapState"]},diffSnaplines:function(e){if(e.length!=this.snaplines.length)return["snaplines"];for(var t=s.iter(s.range(0,this.snaplines.length,!1));!t.done;t.next()){var n=t.value;if(!e.includes(this.snaplines[n]))return["snaplines"]}return[]}}}),i),a.SwapState=(l=function(e,t){this.swapThumbnailForma=e,this.swapThumbnailLocation=t},s.defineClass({name:"SwapState",ctor:l}),l)},429:function(e,t,n){var r,o,i=t,l=n(0),a=n(50),s=n(90);i.ControllerSettingsState=(r=function(){s.TheoPublishingObject.call(this)},l.defineClass({name:"ControllerSettingsState",ctor:r,superName:"TheoPublishingObject",statics:{_implements:function(e){return"TheoMessagePublisher"==e}},props:{settings:{get:function(){return this.settings_},set:function(e){this.settings_=e,this.publish(new i.ControllerSettingsStateChangeMessage(this,this.settings))}}}}),r),i.ControllerSettingsStateChangeMessage=(o=function(e,t){this.settings=t,a.TheoMessage.call(this,o.TYPE,e)},l.defineClass({name:"ControllerSettingsStateChangeMessage",ctor:o,superName:"TheoMessage",statics:{TYPE:{get:function(){return"ControllerSettingsStateChangeMessage"}}}}),o)},430:function(e,t,n){var r,o,i,l,a,s,u=t,c=n(0),h=n(114);u.IEditorAttribute=c.defineProtocol("IEditorAttribute",{key:"String",isEqualTo:"(IEditorAttribute) -> Boolean"}),u.EditorAttributeBase=(r=function(e){this._key=e},c.defineClass({name:"EditorAttributeBase",ctor:r,superName:"CoreObject",props:{key:{get:function(){return this._key}}}}),r),u.ColorAttribute=(o=function(e){this.colors=c.clone(e),u.EditorAttributeBase.call(this,o.KEY)},c.defineClass({name:"ColorAttribute",ctor:o,superName:"EditorAttributeBase",statics:{KEY:"color",_implements:function(e){return"IEditorAttribute"==e}},props:{isEqualTo:function(e){var t;if(t=c.as(e,o)){if(this.colors.length!=t.colors.length)return!1;for(var n=c.iter(c.range(0,this.colors.length,!1));!n.done;n.next()){var r=n.value;if(!c.eq(h._equality_TheoColor_TheoColor,this.colors[r],t.colors[r]))return!1}return!0}return!1}}}),o),u.OpacityAttribute=(i=function(e){this.opacities=c.clone(e),u.EditorAttributeBase.call(this,i.KEY)},c.defineClass({name:"OpacityAttribute",ctor:i,superName:"EditorAttributeBase",statics:{KEY:"opacity",_implements:function(e){return"IEditorAttribute"==e}},props:{isEqualTo:function(e){var t;if(t=c.as(e,i)){if(this.opacities.length!=t.opacities.length)return!1;for(var n=c.iter(c.range(0,this.opacities.length,!1));!n.done;n.next()){var r=n.value;if(this.opacities[r]!=t.opacities[r])return!1}return!0}return!1}}}),i),u.MediaMetadataAttribute=(l=function(e){this.mmds=c.clone(e),u.EditorAttributeBase.call(this,l.KEY)},c.defineClass({name:"MediaMetadataAttribute",ctor:l,superName:"EditorAttributeBase",statics:{KEY:"mediaMetadata",_implements:function(e){return"IEditorAttribute"==e}},props:{isEqualTo:function(e){var t;if(t=c.as(e,l)){if(this.mmds.length!=t.mmds.length)return!1;for(var n=c.iter(c.range(0,this.mmds.length,!1));!n.done;n.next()){var r=n.value;if(!this.mmds[r].isEqualTo(t.mmds[r]))return!1}return!0}return!1}}}),l),u.ControllerSettingAttribute=(a=function(e){this.settings=c.clone(e),u.EditorAttributeBase.call(this,a.KEY)},c.defineClass({name:"ControllerSettingAttribute",ctor:a,superName:"EditorAttributeBase",statics:{KEY:"controllerSetting",_implements:function(e){return"IEditorAttribute"==e}},props:{isEqualTo:function(e){var t;if(t=c.as(e,a)){if(this.settings.length!=t.settings.length)return!1;for(var n=c.iter(c.range(0,this.settings.length,!1));!n.done;n.next()){var r=n.value;if(this.settings[r].type!=t.settings[r].type)return!1}return!0}return!1}}}),a),u.ImageAttribute=(s=function(e){this.styles=c.clone(e),u.EditorAttributeBase.call(this,s.KEY)},c.defineClass({name:"ImageAttribute",ctor:s,superName:"EditorAttributeBase",statics:{KEY:"imageAttr",_implements:function(e){return"IEditorAttribute"==e}},props:{isEqualTo:function(e){var t;if(t=c.as(e,s)){if(this.styles.length!=t.styles.length)return!1;for(var n=c.iter(c.range(0,this.styles.length,!1));!n.done;n.next()){var r=n.value;if(!this.styles[r].equals(t.styles[r]))return!1}return!0}return!1}}}),s)},441:function(e,t,n){var r,o=t,i=n(0),l=n(4);o.ControllerEvent=(r=function(e){this.type=e,l.CoreObject.call(this)},i.defineClass({name:"ControllerEvent",ctor:r,superName:"CoreObject"}),r)},461:function(e,t,n){var r,o,i,l,a,s,u=t,c=n(0);u.IFeatureSet=c.defineProtocol("IFeatureSet",{key:"String",isEqualTo:"(IFeatureSet) -> Boolean"}),u.FeatureSetBase=(r=function(e){this._key=e},c.defineClass({name:"FeatureSetBase",ctor:r,superName:"CoreObject",props:{key:{get:function(){return this._key}}}}),r),u.TextFrameAttributesFeature=(o=function(){u.FeatureSetBase.call(this,o.KEY)},c.defineClass({name:"TextFrameAttributesFeature",ctor:o,superName:"FeatureSetBase",statics:{KEY:"TextFrameAttributesFeature",_implements:function(e){return"IFeatureSet"==e}},props:{isEqualTo:function(e){return e instanceof o}}}),o),u.AlignSpacingAttributesFeature=(i=function(e,t,n,r){this.canAlign=e,this.canDistribute=t,this.canDoRow=n,this.canDoColumn=r,u.FeatureSetBase.call(this,i.KEY)},c.defineClass({name:"AlignSpacingAttributesFeature",ctor:i,superName:"FeatureSetBase",statics:{KEY:"AlignSpacingAttributesFeature",_implements:function(e){return"IFeatureSet"==e}},props:{isEqualTo:function(e){var t;return!!(t=c.as(e,i))&&t.canAlign==this.canAlign&&t.canDistribute==this.canDistribute&&t.canDoRow==this.canDoRow&&t.canDoColumn==this.canDoColumn}}}),i),u.FormaEditFeature=(l=function(e,t,n,r,o){this.canMultiselect=e,this.canDuplicate=t,this.canDelete=n,this.canEditSettings=r,this.supportsMultiStyle=o,u.FeatureSetBase.call(this,l.KEY)},c.defineClass({name:"FormaEditFeature",ctor:l,superName:"FeatureSetBase",statics:{KEY:"FormaEditFeature",_implements:function(e){return"IFeatureSet"==e}},props:{isEqualTo:function(e){var t;return!!(t=c.as(e,l))&&t.canMultiselect==this.canMultiselect&&t.canDuplicate==this.canDuplicate&&t.canDelete==this.canDelete&&t.canEditSettings==this.canEditSettings&&t.supportsMultiStyle==this.supportsMultiStyle}}}),l),u.OpacityAttributesFeature=(a=function(){u.FeatureSetBase.call(this,a.KEY)},c.defineClass({name:"OpacityAttributesFeature",ctor:a,superName:"FeatureSetBase",statics:{KEY:"OpacityAttributesFeature",_implements:function(e){return"IFeatureSet"==e}},props:{isEqualTo:function(e){return e instanceof a}}}),a),u.ImageFeature=(s=function(e,t,n){this.canApplyFilter=e,this.canReplace=t,this.hasLicense=n,u.FeatureSetBase.call(this,s.KEY)},c.defineClass({name:"ImageFeature",ctor:s,superName:"FeatureSetBase",statics:{KEY:"ImageFeature",_implements:function(e){return"IFeatureSet"==e}},props:{isEqualTo:function(e){var t;return!!(t=c.as(e,s))&&t.canApplyFilter==this.canApplyFilter&&t.canReplace==this.canReplace&&t.hasLicense==this.hasLicense}}}),s)},483:function(e,t,n){var r,o,i,l,a=t,s=n(0),u=n(4),c=n(255),h=n(28);a.DesignSize=(r=function(e,t,n,r,o,i,l){this.label=e,this.subLabel=t,this.id=n,this.iconId=r,this.category=o,this.aspectRatio=i,this.exportData=l},s.defineClass({name:"DesignSize",ctor:r,superName:"CoreObject"}),r),a.DesignSizeCategory=(o=function(e,t){this.id=e,this.label=t},s.defineClass({name:"DesignSizeCategory",ctor:o,superName:"CoreObject"}),o),a.DesignSizeCategories=(i=function(){u.CoreObject.call(this)},l={},s.defineClass({name:"DesignSizeCategories",ctor:i,superName:"CoreObject",statics:{SocialPost:{get:function(){return void 0===l.SocialPost&&(l.SocialPost=new a.DesignSizeCategory("socialPost","SOCIAL POST")),l.SocialPost}},Print:{get:function(){return void 0===l.Print&&(l.Print=new a.DesignSizeCategory("print","PRINT")),l.Print}},SocialProfile:{get:function(){return void 0===l.SocialProfile&&(l.SocialProfile=new a.DesignSizeCategory("socialProfile","SOCIAL PROFILE")),l.SocialProfile}},Standard:{get:function(){return void 0===l.Standard&&(l.Standard=new a.DesignSizeCategory("standard","STANDARD")),l.Standard}},Custom:{get:function(){return void 0===l.Custom&&(l.Custom=new a.DesignSizeCategory("Custom","Custom")),l.Custom}},Default:{get:function(){return void 0===l.Default&&(l.Default=new a.DesignSizeCategory("Default","Default")),l.Default}},getCategories:function(){return[i.SocialPost,i.Print,i.SocialProfile,i.Standard]}}}),i),a.DesignSizeLibrary=function(){var e=function(){u.CoreObject.call(this)},t={};return s.defineClass({name:"DesignSizeLibrary",ctor:e,superName:"CoreObject",statics:{MAX_EDGE:2560,designSizes:{get:function(){return void 0===t.designSizes&&(t.designSizes=[new a.DesignSize("k_Instagram_label","k_Instagram_subLabel","Instagram","instagram_icon",a.DesignSizeCategories.SocialPost,1,new c.FormaPageExportData(new h.TheoSize(1080,1080),c.PageExportFormat.PIXELS)),new a.DesignSize("k_InstagramStory_label","k_InstagramStory_subLabel","InstagramStory","instagram_icon",a.DesignSizeCategories.SocialPost,.5625,new c.FormaPageExportData(new h.TheoSize(1080,1920),c.PageExportFormat.PIXELS)),new a.DesignSize("k_InstagramPortrait_label","k_InstagramPortrait_subLabel","InstagramPortrait","instagram_icon",a.DesignSizeCategories.SocialPost,.8,new c.FormaPageExportData(new h.TheoSize(1080,1350),c.PageExportFormat.PIXELS)),new a.DesignSize("k_InstagramLandscape_label","k_InstagramLandscape_subLabel","InstagramLandscape","instagram_icon",a.DesignSizeCategories.SocialPost,1.91,new c.FormaPageExportData(new h.TheoSize(1080,566),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Facebook_label","k_Facebook_subLabel","Facebook","facebook_icon",a.DesignSizeCategories.SocialPost,1.91,new c.FormaPageExportData(new h.TheoSize(1200,628),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Pinterest_label","k_Pinterest_subLabel","Pinterest","pinterest_icon",a.DesignSizeCategories.SocialPost,.666969147,new c.FormaPageExportData(new h.TheoSize(735,1102),c.PageExportFormat.PIXELS)),new a.DesignSize("k_YouTubeThumbnail_label","k_YouTubeThumbnail_subLabel","YouTubeThumbnail","youtube_icon",a.DesignSizeCategories.SocialPost,1.77777777778,new c.FormaPageExportData(new h.TheoSize(1280,720),c.PageExportFormat.PIXELS)),new a.DesignSize("k_LinkedInBlogPost_label","k_LinkedInBlogPost_subLabel","LinkedInBlogPost","linkedin_icon",a.DesignSizeCategories.SocialPost,1.91082803,new c.FormaPageExportData(new h.TheoSize(1200,628),c.PageExportFormat.PIXELS)),new a.DesignSize("k_SnapchatStory_label","k_SnapchatStory_subLabel","SnapchatStory","snapchat_icon",a.DesignSizeCategories.SocialPost,.5625,new c.FormaPageExportData(new h.TheoSize(1080,1920),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Twitter_label","k_Twitter_subLabel","Twitter","twitter_icon",a.DesignSizeCategories.SocialPost,1.79104477612,new c.FormaPageExportData(new h.TheoSize(1200,670),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Letter_label","k_Letter_subLabel","Letter","",a.DesignSizeCategories.Print,.772727,new c.FormaPageExportData(new h.TheoSize(8.5,11),c.PageExportFormat.INCHES,c.FormaPageExportData.DEFAULT_PPI)),new a.DesignSize("k_Poster_label","k_Poster_subLabel","Poster","",a.DesignSizeCategories.Print,.647,new c.FormaPageExportData(new h.TheoSize(11,17),c.PageExportFormat.INCHES,c.FormaPageExportData.DEFAULT_PPI)),new a.DesignSize("k_Card_label","k_Card_subLabel","Card","",a.DesignSizeCategories.Print,.71428571,new c.FormaPageExportData(new h.TheoSize(5,7),c.PageExportFormat.INCHES,c.FormaPageExportData.DEFAULT_PPI)),new a.DesignSize("k_A5_label","k_A5_subLabel","A5","",a.DesignSizeCategories.Print,.70483871,new c.FormaPageExportData(new h.TheoSize(148,210),c.PageExportFormat.MILLIMETERS,c.FormaPageExportData.DEFAULT_PPI)),new a.DesignSize("k_A4_label","k_A4_subLabel","A4","",a.DesignSizeCategories.Print,.70695553,new c.FormaPageExportData(new h.TheoSize(210,297),c.PageExportFormat.MILLIMETERS,c.FormaPageExportData.DEFAULT_PPI)),new a.DesignSize("k_A3_label","k_A3_subLabel","A3","",a.DesignSizeCategories.Print,.7071155,new c.FormaPageExportData(new h.TheoSize(297,420),c.PageExportFormat.MILLIMETERS,c.FormaPageExportData.DEFAULT_PPI)),new a.DesignSize("k_FacebookProfileCover_label","k_FacebookProfileCover_subLabel","FacebookProfileCover","facebook_icon",a.DesignSizeCategories.SocialProfile,2.62820513,new c.FormaPageExportData(new h.TheoSize(1640,624),c.PageExportFormat.PIXELS)),new a.DesignSize("k_PageCover_label","k_PageCover_subLabel","FacebookPageCover","facebook_icon",a.DesignSizeCategories.SocialProfile,1.77777777778,new c.FormaPageExportData(new h.TheoSize(1200,675),c.PageExportFormat.PIXELS)),new a.DesignSize("k_EventCover_label","k_EventCover_subLabel","FacebookEventCover","facebook_icon",a.DesignSizeCategories.SocialProfile,1.91,new c.FormaPageExportData(new h.TheoSize(1920,1005),c.PageExportFormat.PIXELS)),new a.DesignSize("k_YouTubeChannelArt_label","k_YouTubeChannelArt_subLabel","YouTubeChannelArt","youtube_icon",a.DesignSizeCategories.SocialProfile,1.77777777778,new c.FormaPageExportData(new h.TheoSize(2560,1440),c.PageExportFormat.PIXELS)),new a.DesignSize("k_TwitchBanner_label","k_TwitchBanner_subLabel","TwitchBanner","twitch_icon",a.DesignSizeCategories.SocialProfile,4,new c.FormaPageExportData(new h.TheoSize(1920,480),c.PageExportFormat.PIXELS)),new a.DesignSize("k_TwitterHeader_label","k_TwitterHeader_subLabel","TwitterHeader","twitter_icon",a.DesignSizeCategories.SocialProfile,3,new c.FormaPageExportData(new h.TheoSize(1500,500),c.PageExportFormat.PIXELS)),new a.DesignSize("k_EtsyCover_label","k_EtsyCover_subLabel","EtsyCover","etsy_icon",a.DesignSizeCategories.SocialProfile,4,new c.FormaPageExportData(new h.TheoSize(3360,840),c.PageExportFormat.PIXELS)),new a.DesignSize("k_LinkedInProfileCover_label","k_LinkedInProfileCover_subLabel","LinkedInProfileCover","linkedin_icon",a.DesignSizeCategories.SocialProfile,3.878787878787879,new c.FormaPageExportData(new h.TheoSize(1536,396),c.PageExportFormat.PIXELS)),new a.DesignSize("k_EventbriteEventImage_label","k_EventbriteEventImage_subLabel","EventbriteEventImage","eventbrite_icon",a.DesignSizeCategories.SocialProfile,2,new c.FormaPageExportData(new h.TheoSize(2160,1080),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Phone_label","k_Phone_subLabel","iPhone","phone_icon",a.DesignSizeCategories.Standard,.5625,new c.FormaPageExportData(new h.TheoSize(1080,1920),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Square_label","k_Square_subLabel","Square","",a.DesignSizeCategories.Standard,1,new c.FormaPageExportData(new h.TheoSize(2560,2560),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Landscape_label","k_Landscape_subLabel","3:2","",a.DesignSizeCategories.Standard,1.5,new c.FormaPageExportData(new h.TheoSize(2550,1700),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Slide_label","k_Slide_subLabel","4:3","",a.DesignSizeCategories.Standard,1.33333333333,new c.FormaPageExportData(new h.TheoSize(2560,1920),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Widescreen_label","k_Widescreen_subLabel","16:9","",a.DesignSizeCategories.Standard,1.77777777778,new c.FormaPageExportData(new h.TheoSize(2560,1440),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Portrait_label","k_Portrait_subLabel","2:3","",a.DesignSizeCategories.Standard,.66666666666,new c.FormaPageExportData(new h.TheoSize(1700,2550),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Banner_label","k_Banner_subLabel","3:1","",a.DesignSizeCategories.Standard,3,new c.FormaPageExportData(new h.TheoSize(2559,853),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Wide_label","k_Wide_subLabel","2:1","",a.DesignSizeCategories.Standard,2,new c.FormaPageExportData(new h.TheoSize(2560,1280),c.PageExportFormat.PIXELS)),new a.DesignSize("k_Tall_label","k_Tall_subLabel","1:2","",a.DesignSizeCategories.Standard,.5,new c.FormaPageExportData(new h.TheoSize(1280,2560),c.PageExportFormat.PIXELS)),new a.DesignSize("k_SparkVideoSlide_label","k_SparkVideoSlide_subLabel","SparkVideoSlide","sparkvideo_icon",a.DesignSizeCategories.Standard,1.77777777778,new c.FormaPageExportData(new h.TheoSize(1280,720),c.PageExportFormat.PIXELS)),new a.DesignSize("k_SparkVideoSlideSquare_label","k_SparkVideoSlideSquare_subLabel","SparkVideoSlideSquare","sparkvideo_icon",a.DesignSizeCategories.Standard,1,new c.FormaPageExportData(new h.TheoSize(720,720),c.PageExportFormat.PIXELS)),new a.DesignSize("k_KindleCover_label","k_KindleCover_subLabel","KindleCover","kindle_icon",a.DesignSizeCategories.Standard,.625,new c.FormaPageExportData(new h.TheoSize(1600,2560),c.PageExportFormat.PIXELS)),new a.DesignSize("k_BlogPost_label","k_BlogPost_subLabel","BlogPost","blog_icon",a.DesignSizeCategories.Standard,1.78,new c.FormaPageExportData(new h.TheoSize(712,400),c.PageExportFormat.PIXELS))]),t.designSizes}},getListOfResizeShapes:function(){return e.designSizes},getById:function(t){for(var n=s.iter(e.designSizes);!n.done;n.next()){var r=n.value;if(r.id==t)return r}return null},getCustomSize:function(e,t,n,r){return new a.DesignSize("k_Custom_label","k_Custom_subLabel","Custom","custom_icon",a.DesignSizeCategories.Custom,e/t,new c.FormaPageExportData(new h.TheoSize(e,t),n,n==c.PageExportFormat.PIXELS?null:r))},getOriginalSize:function(e,t){return new a.DesignSize("k_OriginalImage_label","","Original","",a.DesignSizeCategories.Default,e/t,new c.FormaPageExportData(new h.TheoSize(e,t),c.PageExportFormat.PIXELS))},getByCategory:function(t){return e.designSizes.filter(function(e){return e.category.id==t},this)}}}),e}()},79:function(e,t,n){var r,o,i=t,l=n(0),a=n(134),s=n(1),u=n(19),c=n(11),h=n(25),d=n(235),g=n(21),C=n(17),f=n(37),S=n(119),m=n(22),w=n(314),p=n(164),T=n(114);i.ColorLibraryController=(r=function(e,t){this._themeKeys=null,this.DERIVED_LIGHT_BRIGHTNESS=.98,this.DERIVED_LIGHT_SATURATION=.03,this.DERIVED_DARK_BRIGHTNESS=.05,this.library=e,this.document=t,this.library.setColors({black:T.TheoColor.init_5344(m.SolidColor.BLACK,null,null),white:T.TheoColor.init_5344(m.SolidColor.WHITE,null,null)})},o={},l.defineClass({name:"ColorLibraryController",ctor:r,superName:"CoreObject",statics:{kDefaultNumThemeColors:5,BLACK_KEY:"black",WHITE_KEY:"white",USER_KEY_PREFIX:"userColor",BW_KEYS:{get:function(){return void 0===o.BW_KEYS&&(o.BW_KEYS=[r.BLACK_KEY,r.WHITE_KEY]),o.BW_KEYS}},THEME_DERIVED_BW_KEYS:["themeDerivedLight","themeDerivedDark"],THEME_PROFILING_DERIVED_COLORS:["theme0Light","theme0Dark","theme1Light","theme1Dark","theme2Light","theme2Dark","theme3Light","theme3Dark","theme4Light","theme4Dark"],DERIVED_BASE_KEYS:["filterBase1","filterBase2","filterBase3"],FILTER_MULTIPLY_KEYS:["filterMultiply1","filterMultiply2","filterMultiply3"],FILTER_OVERLAY_KEYS:["filterOverlay1","filterOverlay2","filterOverlay3"],FILTER_BLEND_KEYS:["filterBlend1","filterBlend2","filterBlend3"],FILTER_SCREEN_KEYS:["filterScreen1","filterScreen2","filterScreen3"],FILTER_DUOTONE_LOW_KEYS:["filterDuotoneLow1","filterDuotoneLow2","filterDuotoneLow3"],FILTER_DUOTONE_HIGH_KEYS:["filterDuotoneHigh1","filterDuotoneHigh2","filterDuotoneHigh3"],IMAGE_KEYS:["imageColor0","imageColor1","imageColor2","imageColor3","imageColor4","imageColor5","imageColor6","imageColor7","imageColor8","imageColor9"],IMAGE_DERIVED_KEYS:["imageDerivedDominant","imageDerivedInteresting"],getLightnessContrastKey:function(e){return e+"LightnessContrast"},getBackgroundContrastKey:function(e){return e+"BackgroundContrast"},DERIVED_KEY_MAP:{filterOverlay1:"filterBase1",filterOverlay2:"filterBase2",filterOverlay3:"filterBase3",filterMultiply1:"filterBase1",filterMultiply2:"filterBase2",filterMultiply3:"filterBase3",filterScreen1:"filterBase1",filterScreen2:"filterBase2",filterScreen3:"filterBase3",filterBlend1:"filterBase1",filterBlend2:"filterBase2",filterBlend3:"filterBase3",filterDuotoneLow1:"filterBase1",filterDuotoneLow2:"filterBase2",filterDuotoneLow3:"filterBase3",filterDuotoneHigh1:"filterBase1",filterDuotoneHigh2:"filterBase2",filterDuotoneHigh3:"filterBase3"},ALL_DERIVED_KEYS:{get:function(){return void 0===o.ALL_DERIVED_KEYS&&(o.ALL_DERIVED_KEYS=r.makeAllKeys()),o.ALL_DERIVED_KEYS}},makeAllKeys:function(){var e=l.clone(r.THEME_DERIVED_BW_KEYS);return l.append(e,r.THEME_PROFILING_DERIVED_COLORS),l.append(e,r.DERIVED_BASE_KEYS),l.append(e,r.FILTER_MULTIPLY_KEYS),l.append(e,r.FILTER_OVERLAY_KEYS),l.append(e,r.FILTER_BLEND_KEYS),l.append(e,r.FILTER_SCREEN_KEYS),l.append(e,r.FILTER_DUOTONE_LOW_KEYS),l.append(e,r.FILTER_DUOTONE_HIGH_KEYS),l.append(e,r.THEME_PROFILING_DERIVED_COLORS),e},getNextKeyInSet:function(e){var t,n=e.substr(e.length-1,1);if(n>="0"&&n<="9"&&null!=(t=l.toInt(n))){var o=e.substr(0,e.length-1),i=o+l.toString(t+1);if(r.ALL_DERIVED_KEYS.includes(i))return[i,!1];if(i=o+"1",r.ALL_DERIVED_KEYS.includes(i))return[i,!0]}return[e,!1]},keyFromImage:function(e){return!(!r.IMAGE_KEYS.includes(e)&&!r.IMAGE_DERIVED_KEYS.includes(e))}},props:{randomDbl:function(){return l.toDouble(f.CoreRandom.nextInt)/2147483647},getNumThemeColorKeys:function(){return this.getThemeColorKeys().length},getThemeColorKeys:function(){var e=this,t=[];return null==this._themeKeys&&(this._themeKeys=[],this.library.forEachColor(function(t,n){t.includes("themeColor")&&!t.includes("Contrast")&&e.library.color(t)&&e._themeKeys.push(t)}),0==this._themeKeys.length&&(this._themeKeys.push("themeColor0"),this._themeKeys.push("themeColor1"))),l.append(t,l.sort(this._themeKeys)),t},getNumProfilingColorsKeys:function(){return this.getProfilingColorKeys().length},getProfilingColorKeys:function(){for(var e=[],t=2*this.getNumThemeColorKeys(),n=l.iter(l.range(0,Math.min(t,r.THEME_PROFILING_DERIVED_COLORS.length),!1));!n.done;n.next()){var o=n.value,i=r.THEME_PROFILING_DERIVED_COLORS[o];this.library.color(i)&&e.push(i)}return e},setLightnessContrastColorAndReturnKey:function(e,t){var n=r.getLightnessContrastKey(e);if(null==this.library.color(n)){var o=t.rgbColor.contrastWithSelf();this.setTheoColorToLibrary(T.TheoColor.init_5344(o,null,null),n)}return n},isSparkColorInUse:function(e){return this.areSparkColorsInUse([e])},areSparkColorsInUse:function(e){if(0==e.length)return!1;for(var t=l.iter(l.toSequence(this.getThemeColorKeys()));!t.done;t.next()){var n=t.value.element,r=this.library.color(n);if(null!=r.sparkElementID&&r.sparkElementID.length>0&&e.includes(r.sparkElementID))return!0}return!1},areAnySparkColorsInUse:function(){for(var e=l.iter(l.toSequence(this.getThemeColorKeys()));!e.done;e.next()){var t=e.value.element,n=this.library.color(t);if(l.opt(n,function(e){return null!=e.sparkElementID&&n.sparkElementID.length>0}))return!0}return!1},getSparkColor:function(e){if(l.isEmpty(e))return null;for(var t=l.iter(l.toSequence(this.getThemeColorKeys()));!t.done;t.next()){var n=t.value.element,r=this.library.color(n);if(null!=r.sparkElementID&&r.sparkElementID==e)return r}return null},updateSparkColor:function(e){for(var t=l.iter(l.toSequence(this.getThemeColorKeys()));!t.done;t.next()){var n=t.value.element,o=this.library.color(n);if(null!=o.sparkElementID&&o.sparkElementID==e.sparkElementID){this.library.setColor(n,e);var i=r.getLightnessContrastKey(n);if(null!=this.library.color(i)){var a=e.rgbColor.contrastWithSelf();this.setTheoColorToLibrary(T.TheoColor.init_5344(a,null,null),i)}return void this.updateDerivedColors()}}s.CoreAssert.fail("asked to update spark color which isn't currently used.")},calculateShadeDelta:function(e){for(var t=l.iter(l.toSequence(this.getThemeColorKeys()));!t.done;t.next()){var n=t.value.element,r=this.library.color(n);if(r.isBrandkitColor()&&r.isBrandkitPrimaryColor())for(var o=l.iter(e);!o.done;o.next()){var i=o.value;if(i.isBrandkitPrimaryColor()){var a=r.getBrandkitShadeRole(),s=i.getBrandkitShadeRole();if(null!=a&&null!=s){var u=a.substr(T.SHADE_ROLE_PREFIX.length),c=s.substr(T.SHADE_ROLE_PREFIX.length),h=l.toInt(u),d=l.toInt(c);if(null!=h&&null!=d)return d-h}return 0}}}return 0},updateSparkColorsByRole:function(e){for(var t=[],n=e.concat(),r=this.calculateShadeDelta(l.clone(e)),o=l.iter(l.toSequence(this.getThemeColorKeys()));!o.done;o.next()){var i=o.value.element;if((a=this.library.color(i)).isBrandkitColor()){var a,u=(a=this.library.color(i)).getBrandkitShadeRole();if(null!=u&&0!=r){var c=u.substr(T.SHADE_ROLE_PREFIX.length),h=l.toInt(c);if(null!=h&&(s.CoreAssert.isTrue(h>=0&&h<=6,"Shade out of range"),0!=h&&6!=h)){var d=h+r;d<=0?d+=5:d>=6&&(d-=5),s.CoreAssert.isTrue(d>=0&&d<=6,"Desired shade out of range"),u=T.SHADE_ROLE_PREFIX+l.toString(d)}}for(var g=!1,C=l.iter(n);!C.done;C.next()){var f=C.value;if(null!=u){if(f.getBrandkitShadeRole()==u){this.library.setColor(i,f),t.push(f),l.remove(n,f),g=!0;break}}else if(a.isBrandkitPrimaryColor()&&f.isBrandkitPrimaryColor()||a.isBrandkitSecondaryColor()&&f.isBrandkitSecondaryColor()){this.library.setColor(i,f),t.push(f),l.remove(n,f),g=!0;break}}if(!g)for(var S=l.iter(t);!S.done;S.next())if((f=S.value).isBrandkitSecondaryColor()){this.library.setColor(i,f),g=!0;break}}}this.updateDerivedColors(),l.info("updateSparkColorsByRole given list of "+e.length+" new colors. Used "+t.length+" of them.")},addNewThemeColorKey:function(){for(var e=2,t=l.clone(this.getThemeColorKeys());t.includes("themeColor"+l.toString(e));)e+=1;var n="themeColor"+l.toString(e);return this._themeKeys.push(n),n},addNewThemeKeyWithColor:function(e){var t=this.addNewThemeColorKey();return this.library.setColor(t,e),t},ensureDerivedColorsAreSet:function(){if(0==this.library.hasEntries(l.clone(r.ALL_DERIVED_KEYS)))for(var e=l.clone(this.getColorThemeAsArrayOfTheoColors()),t=l.clone(this.generateDerivedColorsForTheme(l.clone(e))),n=l.iter(t);!n.done;n.next()){var o=n.key,i=n.value;null==this.library.color(o)&&l.opt(this.library,function(e){return e.setColor(o,i)})}},getTheoColorForSolidColor:function(e){for(var t=l.clone(this.getThemeColorKeys()),n=l.iter(t);!n.done;n.next()){var r=n.value,o=this.library.color(r);if(null!=o&&l.eq(m._equality_SolidColor_SolidColor,e,o.rgbColor))return o}return T.TheoColor.init_5344(e,null,null)},getKeyOfColorInTheme:function(e){for(var t,n=this.getThemeColorKeys().concat(r.THEME_DERIVED_BW_KEYS),o=l.iter(n);!o.done;o.next()){var i=o.value;if(l.eq(m._equality_SolidColor_SolidColor,e.rgbColor,l.opt(this.library.color(i),function(e){return e.rgbColor}))){t=i;break}}return t},getCurrentThemeHexString:function(){for(var e="",t=l.iter(this.getThemeColorKeys());!t.done;t.next()){var n,r=t.value;(n=this.library.color(r))&&(e=e+n.rgbColor.hex+",")}return e},getBaseThemeKeyForDerivedKey:function(e){var t,n,o;return null!=(n=r.DERIVED_KEY_MAP[e])&&(o=this.library.color(n))&&(t=this.getKeyOfColorInTheme(o)),t},ensureUniqueColors:function(e){for(var t=l.sort(e,function(e,t){return e.lightness<t.lightness}),n=[],r=l.iter(t);!r.done;r.next()){var o=r.value;(0==n.length||o.distanceTo(l.last(n).rgbColor)>2.3)&&n.push(T.TheoColor.init_5344(o,null,null))}if(n.length<e.length){for(var i=e.length-n.length,a=n[n.length-1].rgbColor.red,s=n[n.length-1].rgbColor.green,u=n[n.length-1].rgbColor.blue,c=n[n.length-1].rgbColor.alpha,h=l.iter(l.range(1,i,!0));!h.done;h.next()){var d=h.value,g=a+l.toDouble(d)*(1-a)/l.toDouble(i),C=s+l.toDouble(d)*(1-s)/l.toDouble(i),f=u+l.toDouble(d)*(1-u)/l.toDouble(i);n.push(T.TheoColor.init_5344(new m.SolidColor(g,C,f,c),null,null))}return n=l.reverse(n)}return n},generateDerivedColorsForTheme:function(e){if(e.length<this.getNumThemeColorKeys())return{};var t={},n=e[0].rgbColor.asHSB,o=new d.HSBColor(n.h,n.s,this.DERIVED_DARK_BRIGHTNESS,n.alpha),i=new d.HSBColor(n.h,this.DERIVED_LIGHT_SATURATION,this.DERIVED_LIGHT_BRIGHTNESS,n.alpha);t.themeDerivedDark=T.TheoColor.init_5344(o.asRGB,null,null),t.themeDerivedLight=T.TheoColor.init_5344(i.asRGB,null,null);for(var a=l.iter(l.range(0,e.length,!1));!a.done;a.next()){var s=(n=e[E=a.value].rgbColor.asHSB).b<.22?.03:n.b-.2,u=n.b>.78?.97:n.b+.2,c=n.s<.22?.03:n.s-.2,h=n.s>.78?.97:n.s+.2;o=new d.HSBColor(n.h,h,s,n.alpha),i=new d.HSBColor(n.h,c,u,n.alpha),t["theme"+l.toString(E)+"Dark"]=T.TheoColor.init_5344(o.asRGB,null,null),t["theme"+l.toString(E)+"Light"]=T.TheoColor.init_5344(i.asRGB,null,null)}for(var g=[],C=l.iter(l.range(0,2,!0));!C.done;C.next()){for(var f=C.value,S=0,m=0,w=l.iter(l.toSequence(e));!w.done;w.next()){var p=w.value,E=p.offset,_=p.element;if(!g.includes(E)){var v=_.rgbColor,b=0;v.asHSB.s>.1&&(b+=100+v.asHSB.s),v.asLAB.l>30&&(b+=100);for(var D=100,y=l.iter(g);!y.done;y.next()){var R=y.value;D=Math.min(D,v.asLAB.hueDistance(e[R].rgbColor.asLAB))}S<(b+=D)&&(S=b,m=E)}}g.push(m);var P=e[m];t[r.DERIVED_BASE_KEYS[f]]=P;var I=P.rgbColor.asHSB;t[r.FILTER_MULTIPLY_KEYS[f]]=T.TheoColor.init_5344(new d.HSBColor(I.h,(I.s+.5)/2,(I.b+1)/2,I.alpha).asRGB,null,null),t[r.FILTER_OVERLAY_KEYS[f]]=T.TheoColor.init_5344(new d.HSBColor(I.h,(I.s+1)/2,(I.b+1)/2,I.alpha).asRGB,null,null),t[r.FILTER_BLEND_KEYS[f]]=T.TheoColor.init_5344(new d.HSBColor(I.h,I.s,I.b,I.alpha).asRGB,null,null),t[r.FILTER_SCREEN_KEYS[f]]=T.TheoColor.init_5344(new d.HSBColor(I.h,I.s,I.b,I.alpha).asRGB,null,null),t[r.FILTER_DUOTONE_LOW_KEYS[f]]=T.TheoColor.init_5344(new d.HSBColor(I.h,Math.min(I.s,.8),Math.min(I.b,.2),I.alpha).asRGB,null,null),t[r.FILTER_DUOTONE_HIGH_KEYS[f]]=T.TheoColor.init_5344(new d.HSBColor(I.h,Math.min(I.s,.8),Math.max(I.b,.8),I.alpha).asRGB,null,null)}return t},updateDerivedColors:function(){var e=l.clone(this.getColorThemeAsArrayOfTheoColors()),t=l.clone(this.generateDerivedColorsForTheme(l.clone(e)));this.library.setColors(l.clone(t))},setTheoColorToLibrary:function(e,t){var n=this.library.color(t);this.library.setColor(t,e),null!=e.sparkElementID?p.TheoBrandkitUtils.brandDocumentForElement(this.document,e.sparkElementID,a.AUTHORING_CONTEXT_TYPE_COLOR):l.opt(n,function(e){return null!=e.sparkElementID})&&p.TheoBrandkitUtils.unBrandDocumentIfNoBrandedElements(this.document)},getSolidColorForKey:function(e){var t=this.library.color(e);return l.opt(t,function(e){return e.rgbColor})},getTheoColorForKey:function(e){return this.library.color(e)},recordUndoState:function(){return this.library.encodeJson()},restoreUndoState:function(e){null!=e&&(this.library.decodeAndSetJson(e),this._themeKeys=null)},getColorThemeAsArrayOfSolidColors:function(){for(var e=[],t=l.clone(this.getThemeColorKeys()),n=l.iter(t);!n.done;n.next()){var r,o=n.value;(r=this.library.color(o))&&e.push(r.rgbColor)}return l.sort(e,function(e,t){return e.lightness<t.lightness})},getColorThemeAsArrayOfTheoColors:function(){var e=[],t=l.clone(this.getThemeColorKeys());l.sortInPlace(t);for(var n=l.iter(t);!n.done;n.next()){var r,o=n.value;(r=this.library.color(o))&&e.push(r)}return l.sort(e,function(e,t){return e.rgbColor.lightness<t.rgbColor.lightness})},getThemeDerivedColorsAsArrayOfSolidColors:function(){for(var e=[],t=l.iter(l.toSequence(r.THEME_DERIVED_BW_KEYS));!t.done;t.next()){var n,o=t.value.element;(n=this.library.color(o))&&e.push(n.rgbColor)}return e},getThemeDerivedColorsAsArrayOfTheoColors:function(){for(var e=[],t=l.iter(l.toSequence(r.THEME_DERIVED_BW_KEYS));!t.done;t.next()){var n,o=t.value.element;(n=this.library.color(o))&&e.push(n)}return e},applyLegacyFilterColorsAndReturnKeys:function(e){var t,n,o;if(o=e.filter){var i,l;switch(o.name){case"Greyscale":case"GreyscaleDark":t="themeDerivedDark",n="themeDerivedDark";break;case"Monochrome":t=r.FILTER_MULTIPLY_KEYS[0];break;case"Duotone":t=r.FILTER_DUOTONE_LOW_KEYS[0],n=r.FILTER_DUOTONE_HIGH_KEYS[1];break;case"DesaturateMultiply":t=r.FILTER_MULTIPLY_KEYS[0];break;case"ReduceContrastOverlay":t=r.FILTER_OVERLAY_KEYS[0];break;default:t=r.FILTER_MULTIPLY_KEYS[0]}(i=e.colors.color(u.ColorRole.FieldPrimary))&&this.library.setColor(t,T.TheoColor.init_5344(i,null,null)),(l=e.colors.color(u.ColorRole.FieldSecondary))&&null!=n&&this.library.setColor(n,T.TheoColor.init_5344(l,null,null))}return{primaryKey:t,secondaryKey:n}},mergeSolidColorDictionaries:function(e,t){for(var n=l.clone(e),r=l.iter(t);!r.done;r.next()){var o=r.key,i=r.value;n[o]=i}return n},mergeTheoColorDictionaries:function(e,t){for(var n=l.clone(e),r=l.iter(t);!r.done;r.next()){var o=r.key,i=r.value;n[o]=i}return n},applyLegacyColorThemeFromDocument:function(e){var t,n={},r=[];if(t=l.opt(e,function(e){return e.colorTheme}))for(var o=l.iter(l.range(0,5,!1));!o.done;o.next()){var i,a=o.value;if(i=l.as(t.swatchByTag("theme",l.toString(a)),w.SimpleSwatch)){var s,u=this.getThemeColorKeys()[a];if(s=i.color){var c=T.TheoColor.init_5344(s,null,null);n[u]=c,r.push(c)}}}else for(var h=l.iter(l.range(0,this.getNumThemeColorKeys(),!1));!h.done;h.next()){a=h.value;var d=1/l.toDouble(a+1),g=(u=this.getThemeColorKeys()[a],new m.SolidColor(d,d,d,1));c=T.TheoColor.init_5344(g,null,null),n[u]=c,r.push(c)}var C=l.clone(this.generateDerivedColorsForTheme(l.clone(r)));this.library.setColors(l.clone(this.mergeTheoColorDictionaries(l.clone(n),l.clone(C))))},deleteThemeColorsFromDocument:function(e){for(var t=l.iter(e);!t.done;t.next()){var n=t.value;this.library.setColor(n,null)}this.document.firstPage.root.visitAll(c.FormaTraversal.PreOrder,function(t){var n=t.style.colors.colorID(u.ColorRole.FieldPrimary);null!=n&&e.includes(n)&&t.style.colors.setColorId(u.ColorRole.FieldPrimary,"themeColor0");var r=t.style.colors.colorID(u.ColorRole.FieldSecondary);null!=r&&e.includes(r)&&t.style.colors.setColorId(u.ColorRole.FieldSecondary,"themeColor1");var o=t.style.colors.colorID(u.ColorRole.Border);null!=o&&e.includes(o)&&t.style.colors.setColorId(u.ColorRole.Border,"themeDerivedDark")}),this._themeKeys=null},deleteExtraThemeColors:function(e){var t=[],n=l.clone(this.getThemeColorKeys()),o="themeColor".length;for(l.sortInPlace(n,function(e,t){var n=e.substr(o),r=t.substr(o);return l.toInt(n)<l.toInt(r)});n.length>e;){var i=n.pop();t.push(i),t.push(r.getLightnessContrastKey(i)),t.push(r.getBackgroundContrastKey(i))}this.deleteThemeColorsFromDocument(l.clone(t))},applyColorTheme:function(e,t,n){if(void 0===n&&(n=!1),e.length<2)s.CoreAssert.isTrue(!1,"Color themes must have at least 2 colors");else{if(n&&e.length==this.getNumThemeColorKeys()){function r(e,t){return e.rgbColor.print()<t.rgbColor.print()}var o=l.clone(this.getColorThemeAsArrayOfTheoColors());l.sortInPlace(o,r);for(var i=l.sort(e,r),u=!0,c=l.iter(l.range(0,i.length,!1));!c.done;c.next()){var h=c.value;if(!l.eq(T._equality_TheoColor_TheoColor,o[h],i[h])){u=!1;break}}if(u)return}var d,g={},C=[];this.getNumThemeColorKeys()>e.length&&this.deleteExtraThemeColors(e.length);for(var f=l.iter(l.toSequence(e));!f.done;f.next()){var m=f.value,w=m.offset,E=m.element;g[w<this.getNumThemeColorKeys()?this.getThemeColorKeys()[w]:this.addNewThemeColorKey()]=E,C.push(E),null==d&&null!=E.sparkElementID&&(d=E)}var _=l.clone(this.generateDerivedColorsForTheme(l.clone(C)));null!=d?p.TheoBrandkitUtils.brandDocumentForElement(this.document,d.sparkElementID,a.AUTHORING_CONTEXT_TYPE_COLOR):p.TheoBrandkitUtils.unBrandDocumentIfNoBrandedElements(this.document),this.library.setColors(l.clone(this.mergeTheoColorDictionaries(l.clone(g),l.clone(_)))),this.library.paletteID=t,(new S.ProfilingColorMap).updateRoleProfilingColorMap(this.document.firstPage)}},enteredPalettePicker:function(){(new S.ProfilingColorMap).setPaletteMappingForFormaWithSameRGBColor(this.document.firstPage)},getRandomBackgroundColor:function(){var e=l.clone(this.getThemeColorKeys());return p.TheoBrandkitUtils.isDocumentBranded(this.document,!1)||l.append(e,r.THEME_DERIVED_BW_KEYS),e[f.CoreRandom.nextIntUniform(e.length)]},shuffleColorAssignments:function(){this.document.firstPage.root.style.colors.setColorId(u.ColorRole.FieldPrimary,this.getRandomBackgroundColor()),(new S.ProfilingColorMap).updateRoleProfilingColorMap(this.document.firstPage),(new S.ProfilingColorMap).updateCurrentColorIndices(),this.document.firstPage.root.visitAll(c.FormaTraversal.PreOrder,function(e){null==e.controller||h.GridController.isBackgroundColoredCell(e)||e.controller.shuffleColorAssignment()})},createInitialThemeFromImage:function(){var e,t,n=null,o=l.clone(this.document.firstPage.root.filterWithCallback(function(e){return e instanceof g.ImageForma}));if(o.length>0&&(e=l.as(o[0],g.ImageForma))&&(n=l.opt(e.contentNode,function(e){return e.image})),t=n){var i=l.clone(t.getImageColors(r.kDefaultNumThemeColors)),a=l.clone(this.ensureUniqueColors(l.clone(i)));this.applyColorTheme(l.clone(a),"image"),this.shuffleColorAssignments()}else s.CoreAssert.fail("createInitialThemeFromImage has no image to create a theme from")},extractImageColors:function(){var e,t,n=[],o=[],i={},a=l.clone(this.document.firstPage.root.filterWithCallback(function(e){return e instanceof g.ImageForma&&!e.isLogo()&&e.parent.isBackgroundImage()}));a.length>0&&(e=l.as(a[a.length-1],g.ImageForma))&&(t=l.opt(e.contentNode,function(e){return e.image}))&&(n=l.clone(t.getImageColors(r.kDefaultNumThemeColors)),o=l.clone(this.ensureUniqueColors(l.clone(n))));for(var s=l.iter(l.toSequence(o));!s.done;s.next()){var u=s.value,c=u.offset,h=u.element;i[r.IMAGE_KEYS[c]]=h}this.library.setColors(l.clone(i))},getSuggestedColorThemesAsArraysOfTheoColors:function(){var e=[],t=[];null==this.library.color(r.IMAGE_KEYS[0])&&this.extractImageColors();for(var n=l.iter(l.toSequence(r.IMAGE_KEYS));!n.done;n.next()){var o,i=n.value.element;(o=this.library.color(i))&&t.push(o)}if(t.length>0){var a=l.clone(this.removeSimilarColors(l.clone(t)));a.length>2&&e.push(l.clone(a))}var s=l.clone(this.getTheoColorsUsedInDocument()),u=r.kDefaultNumThemeColors-s.length+1;if(s.length>1&&u>0){for(var c=0,h=[],d=[],g=l.iter(s);!g.done;g.next()){var C=g.value,f=C.rgbColor.lightness;f>4&&f<96&&(h.push(C),d.push(C),c<u&&(c+=1,h.push(T.TheoColor.init_5344(C.rgbColor.contrastWithSelf())),f>50?d.push(T.TheoColor.init_5344(C.rgbColor.darkenForTint())):d.push(T.TheoColor.init_5344(C.rgbColor.lightenForTint()))))}var S=l.clone(this.removeSimilarColors(l.clone(d)));S.length>2&&e.push(l.clone(S));var m=l.clone(this.removeSimilarColors(l.clone(h)));m.length>2&&e.push(l.clone(m))}return e},removeSimilarColors:function(e){for(var t=l.sort(e,function(e,t){return e.rgbColor.lightness<t.rgbColor.lightness}),n=[],r=l.iter(t);!r.done;r.next()){var o=r.value;(0==n.length||o.rgbColor.distanceTo(l.last(n).rgbColor)>2.3)&&n.push(o)}return n},getSuggestedColorsAsArraysOfTheoColors:function(){for(var e=l.clone(this.getSuggestedColorThemesAsArraysOfTheoColors()),t=[],n=l.iter(e);!n.done;n.next())for(var r=n.value,o=l.iter(r);!o.done;o.next()){var i=o.value;t.push(i)}return t},addUnlinkedColor:function(e){for(var t=0,n="unlinked"+l.toString(t),r=this.library.color(n);null!=r;)t+=1,n="unlinked"+l.toString(t),r=this.library.color(n);return this.library.setColor(n,T.TheoColor.init_5344(e,null,null)),n},getTheoColorsUsedInDocument:function(){var e=[];this.document.firstPage.root.visitAll(c.FormaTraversal.PreOrder,function(t){var n;null!=(n=t.style.colors.colorID(u.ColorRole.FieldPrimary))&&(e.includes(n)||e.push(n)),null!=(n=t.style.colors.colorID(u.ColorRole.FieldSecondary))&&(e.includes(n)||e.push(n))});for(var t=[],n=l.iter(e);!n.done;n.next()){var r=n.value,o=this.library.color(r);null!=o&&t.push(o)}return t},unusedColorKeys:function(e,t){var n=this,r=l.clone(this.getThemeColorKeys());if(t){for(var o=l.iter(this.getThemeColorKeys());!o.done;o.next()){var i=o.value,a=this.library.color(i);null!=a&&a.isBrandkitColor()&&l.remove(r,i)}if(0==r.length)return r}return this.document.firstPage.root.visitAll(c.FormaTraversal.PreOrder,function(t){var o;if(null!=e&&t.formaID==e.formaID||(null!=(a=t.style.colors.colorID(u.ColorRole.FieldPrimary))&&(l.remove(r,a),null!=(s=n.getBaseThemeKeyForDerivedKey(a))&&null!=(c=l.indexOf(r,s))&&r.splice(c,1)),null!=(a=t.style.colors.colorID(u.ColorRole.FieldSecondary))&&(l.remove(r,a),null!=(s=n.getBaseThemeKeyForDerivedKey(a))&&null!=(c=l.indexOf(r,s))&&r.splice(c,1))),o=l.as(t.style,C.LockupStyle))for(var i=l.iter(o.characterStyles);!i.done;i.next()){var a,s,c,h=i.value;null!=(a=h.colors.colorID(u.ColorRole.FieldPrimary))&&(l.remove(r,a),null!=(s=n.getBaseThemeKeyForDerivedKey(a))&&null!=(c=l.indexOf(r,s))&&r.splice(c,1)),null!=(a=h.colors.colorID(u.ColorRole.FieldSecondary))&&(l.remove(r,a),null!=(s=n.getBaseThemeKeyForDerivedKey(a))&&null!=(c=l.indexOf(r,s))&&r.splice(c,1))}}),r},addColorsToTheme:function(e,t){for(var n=l.clone(this.unusedColorKeys(t,!0)),o=[],i=l.iter(l.range(0,e.length,!1));!i.done;i.next()){var a,u,c,h=e[i.value];null!=(u=this.getKeyOfColorInTheme(h))?(a=u,n.includes(u)&&l.remove(n,u)):(a=n.length>0?n[0]:this.addNewThemeColorKey(),this.setTheoColorToLibrary(h,a),null!=(c=l.indexOf(n,a))&&n.splice(c,1),this.setTheoColorToLibrary(T.TheoColor.init_5344(h.rgbColor.contrastWithSelf(),null,null),r.getLightnessContrastKey(a))),o.push(a)}return s.CoreAssert.isTrue(o.length==e.length),o}}}),r)}}]);
//# sourceMappingURL=logomaker-entry_eec29f26-b294be8f.js.map