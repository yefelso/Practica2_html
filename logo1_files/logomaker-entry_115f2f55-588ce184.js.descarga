(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{115:function(e,t,n){var i,o,r,a,s,c=t,l=n(0),u=n(87),h=n(1),_=n(419),d=n(421),f=n(424),m=n(425),T=n(152),p=n(237),g=n(56),R=n(8),E=n(192),P=n(311),C=n(501),D=n(502),O=n(151),I=n(121),S=n(50);c.TheoDocumentVersion=l.defineEnum("TheoDocumentVersion",{Invalid:0,BeginningOfStoringVersion:1,BackingShapePaddingEnabled:2,FormaController:1e3,ColorBackgroundAndPreviewEncoding:2e3,Knockouts:3e3,GridLayouts:4e3,CharacterStyles:5e3,GridsWithAlphaImages:6e3,OmitShapeLibraryPathData:7e3,Icons:8e3,TextEffects:9e3,LetterSpacing:1e4,AdobeFonts:11e3,ImageAdjustments:12e3,PremiumTemplates:13e3,Giphys:14e3,NewTextAnimations:15e3,FontSourcesMetadata:15100,NewTextLayouts:16e3,JSONDocumentEncoding:17e3}),c.TheoDocument=(i=function(e){this.versionDecoded_=c.VersionInfo.UNKNOWN,this.authoringContextID_="",this.authoringContextThemeID_="",this.constrainedImages_={stockImages:{unlicensed:[],standard:[],extended:[]}},this.db_=new f.PostDB,this.controller_=e,this.uuid_=g.GUIDUtils.makeGUID(),this.shared_=!1,this.isExported_=!1,this.modifiedSinceShare_=!1,this.modifiedSinceOpen_=!1,this.documentName_=i.DEFAULT_NAME,this.missingFontsDuringOpen_=[],O.TheoDOMPublishingElement.call(this),h.CoreAssert.creatingDocumentSingleton(this),this.firstPage_=new p.FormaPage(this),this.content_=new _.ContentDocument(this),this.colorTheme_=new d.ColorThemeDocument(this),this.history_=new m.DocumentHistory(this),this.communityPlatformAlias_=null,this.documentData_=new D.TheoDocumentData,null!=e&&e.attach(this),this.db_.addListener(this)},o={},l.defineClass({name:"TheoDocument",ctor:i,superName:"TheoDOMPublishingElement",statics:{CURRENT_VERSION:{get:function(){return void 0===o.CURRENT_VERSION&&(o.CURRENT_VERSION=c.TheoDocumentVersion.JSONDocumentEncoding),o.CURRENT_VERSION}},MIME_TYPE:"application/vnd.adobe.theo.document+dcx",PROPERTY_VERSION:"format-version",PROPERTY_WATERMARK_ENABLED:"watermark-enabled",PROPERTY_SHARED:"shared",PROPERTY_MODIFIED_SINCE_SHARE:"modified-since-share",PROPERTY_FONT_SOURCES:"font-sources",PROPERTY_CP_CONTENT_MODIFIED:"cp#contentModified",PROPERTY_CP_PROJECT_ID:"cp#projectId",PROPERTY_CP_ALIAS:"cp#shortId",PROPERTY_CP_ASSET_ID:"cp#assetId",PROPERTY_CP_PUBLISHED_ETAG:"cp#publishedEtag",PROPERTY_CP_IS_EXPORTED:"cp#isExported",PROPERTY_REMIX_ANCESTORS_CP_ASSET_IDS:"remix-ancestors",PROPERTY_STOCK_IMAGES:"stockImages",PROPERTY_UNLICENSED:"unlicensed",PROPERTY_STANDARD:"standard",PROPERTY_EXTENDED:"extended",ALL_CP_PROPERTIES:{get:function(){return void 0===o.ALL_CP_PROPERTIES&&(o.ALL_CP_PROPERTIES=[i.PROPERTY_CP_PROJECT_ID,i.PROPERTY_CP_ALIAS,i.PROPERTY_CP_ASSET_ID,i.PROPERTY_CP_PUBLISHED_ETAG,i.PROPERTY_CP_IS_EXPORTED]),o.ALL_CP_PROPERTIES}},PROPERTY_DOCUMENT_DATA:"doc#data",PROPERTY_AUTHORING_CONTEXT_ID:"authctx#ctxid",PROPERTY_AUTHORING_CONTEXT_THEME_ID:"authctx#themeid",PROPERTY_USES_BRANDED_ELEMENTS:"authctx#uses-branded-elements",DEFAULT_NAME:"My Post",PROPERTY_CONSTRAINED_IMAGES:"constrainedImages",ERR_NEWER_FORMAT_VERSION:"newer-format-version",ERR_COULD_NOT_READ_JSON:"json-read-failed",COMPONENT_PATH_CONTENT:"content.json",COMPONENT_NAME_DOM:"dom",COMPONENT_RELATIONSHIP_DOM:"dom",COMPONENT_MIME_TYPE_DOCUMENT_JSON:"application/json",COMPONENT_RELATIONSHIP_METADATA:"metadata",COMPONENT_RELATIONSHIP_RENDITION:"rendition",_implements:function(e){return"IMissingFontHelper"==e||"TheoMessagePublisher"==e||"IDatabaseListener"==e}},props:{description:{get:function(){return"Doc Name: "+this.documentName_+", uuid: "+this.uuid_+", versionDecoded: "+this.versionDecoded_.description}},documentName:{get:function(){return this.documentName_},set:function(e){this.documentName_=e}},authoringContextID:{get:function(){return this.authoringContextID_},set:function(e){this.authoringContextID_=e}},authoringContextThemeID:{get:function(){return this.authoringContextThemeID_},set:function(e){this.authoringContextThemeID_=e}},remixAncestorsCpAssetIDs:{get:function(){return this.remixAncestorsCpAssetIDs_}},uuid:{get:function(){return this.uuid_},set:function(e){this.uuid_=e}},versionDecoded:{get:function(){return this.versionDecoded_}},communityPlatformAssetID:{get:function(){return this.communityPlatformAssetID_},set:function(e){this.communityPlatformAssetID_=e}},communityPlatformAlias:{get:function(){return this.communityPlatformAlias_},set:function(e){this.communityPlatformAlias_=e}},publishedEtag:{get:function(){return this.publishedEtag_},set:function(e){this.publishedEtag_=e}},publishedResourcePath:{get:function(){return this.publishedResourcePath_},set:function(e){this.publishedResourcePath_=e}},documentData:{get:function(){return this.documentData_}},shared:{get:function(){return this.shared_},set:function(e){this.shared_=e,this.modifiedSinceShare_=!1}},isExported:{get:function(){return this.isExported_},set:function(e){this.isExported_=e}},recordModification:function(){this.modifiedSinceShare_=!0,this.modifiedSinceOpen_=!0},modifiedSinceShare:{get:function(){return this.modifiedSinceShare_}},modifiedSinceOpen:{get:function(){return this.modifiedSinceOpen_}},firstPage:{get:function(){return h.CoreAssert.isTrue(null!=this.firstPage_,"Attempting to access forma before TheoDocument constructor is complete"),this.firstPage_}},content:{get:function(){return h.CoreAssert.isTrue(null!=this.content_,"Attempting to access content before TheoDocument constructor is complete"),this.content_}},colorTheme:{get:function(){return h.CoreAssert.isTrue(null!=this.colorTheme_,"Attempting to access colorTheme before TheoDocument constructor is complete"),this.colorTheme_}},history:{get:function(){return h.CoreAssert.isTrue(null!=this.history_,"Attempting to access document history before TheoDocument constructor is complete"),this.history_}},watermarkEnabled:{get:function(){return null==this.watermarkEnabled_||this.watermarkEnabled_},set:function(e){this.watermarkEnabled_=e}},constrainedImages:{get:function(){return this.constrainedImages_},set:function(e){this.constrainedImages_=l.clone(e)}},controller:{get:function(){return this.controller_}},recordMissingFont:function(e){this.missingFontsDuringOpen_.includes(e)||this.missingFontsDuringOpen_.push(e)},hadMissingFontsWhenOpened:{get:function(){return this.missingFontsDuringOpen_.length>0}},missingFontList:{get:function(){return this.missingFontsDuringOpen_}},beginTransaction:function(e){return this.db_.beginTransaction(e)},encodeDocument:function(e){this.history.postEntry("save");var t=T.DocumentPersistenceFactory.encoderFor(e.current);this.encode(t),l.opt(l.as(t,u.BaseNodeEncoder),function(e){return e.finish()})},decodeDocument:function(e){var t=T.DocumentPersistenceFactory.decoderFor(e.current),n=this.decode(t);return this.history.postEntry("open,was-vers="+l.toString(this.versionDecoded.rawValue)),n},decodeTemplate:function(e,t){var n;if(n=l.as(l.opt(R.Host.persistUtils,function(e){return e.readJsonContentFromFile(t)}),["Dictionary","String","Any"])){var o=e.current,r=new P.JSONNodeDecoder(o,n),a=this.decode(r);return this.authoringContextID=o.getValue(u.PROPERTY_KEY_ID),a}return i.ERR_COULD_NOT_READ_JSON},decode:function(e){var t,n,o,r=this;h.CoreAssert.isTrue(null!=e.id),this.uuid_=(t=e.id)||null!=t?t:"",this.documentName_=(n=e.name)||null!=n?n:i.DEFAULT_NAME,this.missingFontsDuringOpen_=[];var a=c.VersionInfo.fromProperty(e.property(i.PROPERTY_VERSION)),s=new c.VersionInfo(i.CURRENT_VERSION);if(a.major>s.major)return i.ERR_NEWER_FORMAT_VERSION;this.versionDecoded_=a,this.publish(new c.TheoDocumentWillDecodeMessage(this)),this.communityPlatformAssetID_=e.optionalStringProperty(i.PROPERTY_CP_ASSET_ID),this.communityPlatformAlias_=e.optionalStringProperty(i.PROPERTY_CP_ALIAS),this.publishedEtag_=e.optionalStringProperty(i.PROPERTY_CP_PUBLISHED_ETAG),this.publishedResourcePath_=e.optionalStringProperty(i.PROPERTY_CP_PROJECT_ID),this.isExported_=e.booleanProperty(i.PROPERTY_CP_IS_EXPORTED,!1),this.remixAncestorsCpAssetIDs_=l.clone(l.as(e.property(i.PROPERTY_REMIX_ANCESTORS_CP_ASSET_IDS),["Array","String"])),this.authoringContextID_=e.stringProperty(i.PROPERTY_AUTHORING_CONTEXT_ID,""),this.authoringContextThemeID_=e.stringProperty(i.PROPERTY_AUTHORING_CONTEXT_THEME_ID,""),this.documentData_=D.TheoDocumentData.decode(e.property(i.PROPERTY_DOCUMENT_DATA)),e.forEachChild(function(e,t){var n=(o=e.path)||null!=o?o:"";n==p.FormaPage.PATH?(r.firstPage_=new p.FormaPage(r),r.firstPage.decode(e)):n==_.ContentDocument.PATH?(r.content_=new _.ContentDocument(r),r.content.decode(e)):n==d.ColorThemeDocument.PATH?(r.colorTheme_=new d.ColorThemeDocument(r),r.colorTheme.decode(e)):n==m.DocumentHistory.PATH&&(r.history_=new m.DocumentHistory(r),r.history_.decode(e))}),this.firstPage.postDecode(),this.content.postDecode(),this.colorTheme.postDecode(),this.history.postDecode(),this.watermarkEnabled_=e.optionalBooleanProperty(i.PROPERTY_WATERMARK_ENABLED),this.shared_=e.booleanProperty(i.PROPERTY_SHARED,!1),this.modifiedSinceShare_=e.booleanProperty(i.PROPERTY_MODIFIED_SINCE_SHARE,!1);var u=l.clone(l.as(e.property(i.PROPERTY_CONSTRAINED_IMAGES),["Dictionary","String",["Dictionary","String",["Array","String"]]]));return null==u&&(u={stockImages:{unlicensed:[],standard:[],extended:[]}}),this.constrainedImages_=l.clone(u),this.publish(new c.TheoDocumentDidDecodeMessage(this)),h.CoreAssert.info("Decoded "+this.description+" (currentVersion: "+s.description+")"),null},encode:function(e){var t=e;t.setManifestFormatVersion(5),t.setCompositeID(this.uuid_);var n=l.clone(I.TheoDocumentUtils.getFontSourceUsage(this));e.setName(this.documentName_),e.setType(i.MIME_TYPE),e.setNumberProperty(i.PROPERTY_VERSION,l.toDouble(i.CURRENT_VERSION)),t.setManifestProperty(i.PROPERTY_VERSION,l.as(i.CURRENT_VERSION,"AnyObject")),t.setDocumentSize(this.firstPage.pageSize,E.DocumentUnitsEnum.PIXEL),t.setManifestProperty(i.PROPERTY_CP_ASSET_ID,l.as(this.communityPlatformAssetID_,"AnyObject")),t.setManifestProperty(i.PROPERTY_CP_ALIAS,l.as(this.communityPlatformAlias_,"AnyObject")),t.setManifestProperty(i.PROPERTY_CP_PUBLISHED_ETAG,l.as(this.publishedEtag_,"AnyObject")),t.setManifestProperty(i.PROPERTY_CP_PROJECT_ID,l.as(this.publishedResourcePath_,"AnyObject")),t.setManifestProperty(i.PROPERTY_CP_IS_EXPORTED,l.as(this.isExported_,"AnyObject")),e.setProperty(i.PROPERTY_REMIX_ANCESTORS_CP_ASSET_IDS,l.as(this.remixAncestorsCpAssetIDs_,"AnyObject")),e.setProperty(i.PROPERTY_FONT_SOURCES,l.as(n,"AnyObject")),null!=this.documentData_&&e.setProperty(i.PROPERTY_DOCUMENT_DATA,this.documentData_.encode()),this.firstPage.encode(e.appendChild(this.firstPage.uuid)),this.content.encode(e.appendChild(this.content.uuid)),this.colorTheme.encode(e.appendChild(this.colorTheme.uuid)),this.history.encode(e.appendChild(this.history.uuid)),e.setOptionalBooleanProperty(i.PROPERTY_WATERMARK_ENABLED,this.watermarkEnabled_),e.setBooleanProperty(i.PROPERTY_SHARED,this.shared_),e.setBooleanProperty(i.PROPERTY_MODIFIED_SINCE_SHARE,this.modifiedSinceShare_),t.setManifestProperty(i.PROPERTY_AUTHORING_CONTEXT_ID,l.as(this.authoringContextID_,"AnyObject")),t.setManifestProperty(i.PROPERTY_AUTHORING_CONTEXT_THEME_ID,l.as(this.authoringContextThemeID_,"AnyObject")),t.setManifestProperty(i.PROPERTY_USES_BRANDED_ELEMENTS,l.as(this.authoringContextID_.length>0,"AnyObject")),e.setProperty(i.PROPERTY_CONSTRAINED_IMAGES,l.as(this.constrainedImages_,"AnyObject"));var o=new c.VersionInfo(i.CURRENT_VERSION);h.CoreAssert.info("Encoded "+this.description+" as currentVersion: "+o.description)},getSynthesizedTitle:function(){return I.TheoDocumentUtils.synthesizeTitle(this)},getSynthesizedDescription:function(){return I.TheoDocumentUtils.synthesizeDescription(this)},onBeginTransaction:function(e,t){this.publish(new C.TransactionBegunMessage(t,this))},onEndTransaction:function(e,t){this.publish(new C.TransactionEndedMessage(t,this))},setRemixParentCpId:function(e){null==this.remixAncestorsCpAssetIDs_&&(this.remixAncestorsCpAssetIDs_=[]),l.opt(this.remixAncestorsCpAssetIDs_,function(t){return t.push(e)})},getRemixAncestorsCpMachineTags:function(){var e=[];if(null!=this.remixAncestorsCpAssetIDs_&&this.remixAncestorsCpAssetIDs_.length>0){e.push("_REMIX_"),e.push("_REMIX_PROGENITOR_"+this.remixAncestorsCpAssetIDs_[0]);for(var t=this.remixAncestorsCpAssetIDs_.length-1,n=l.iter(this.remixAncestorsCpAssetIDs_);!n.done;n.next()){var i=n.value;e.push("_REMIX_FROM_"+i),e.push("_REMIX_FROM_"+i+"_"+t),t-=1}}return e}}}),i),c.VersionInfo=function(){var e=function(e){var t;this.vers=(t=c.TheoDocumentVersion.toCaseValue(e))||null!=t?t:c.TheoDocumentVersion.Invalid,this.minor=e%1e3,this.major=e-this.minor},t={};return l.defineClass({name:"VersionInfo",ctor:e,superName:"CoreObject",statics:{UNKNOWN:{get:function(){return void 0===t.UNKNOWN&&(t.UNKNOWN=new e(0)),t.UNKNOWN}},fromProperty:function(t){var n;return null!=(n=l.as(t,"Int"))?new e(n):e.UNKNOWN}},props:{description:{get:function(){return"Version Major: "+l.toString(this.major)+", minor: "+l.toString(this.minor)}},rawValue:{get:function(){return this.major+this.minor}}}}),e}(),c.TheoDocumentMessage=(r=function(e,t){S.TheoMessage.call(this,e,t)},l.defineClass({name:"TheoDocumentMessage",ctor:r,superName:"TheoMessage",props:{document:{get:function(){return l.as(this.publisher,c.TheoDocument)}}}}),r),c.TheoDocumentWillDecodeMessage=(a=function(e){c.TheoDocumentMessage.call(this,a.TYPE,e)},l.defineClass({name:"TheoDocumentWillDecodeMessage",ctor:a,superName:"TheoDocumentMessage",statics:{TYPE:"TheoDocumentWillDecodeMessage"}}),a),c.TheoDocumentDidDecodeMessage=(s=function(e){c.TheoDocumentMessage.call(this,s.TYPE,e)},l.defineClass({name:"TheoDocumentDidDecodeMessage",ctor:s,superName:"TheoDocumentMessage",statics:{TYPE:"TheoDocumentDidDecodeMessage"}}),s)},132:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(236),c=n(192),l=n(133);o.DATA_URL_PREFIX="data:",o.PROPERTY_DATA_URL="data-url",o.PROPERTY_MIMETYPE="mimetype",o.PROPERTY_MEDIA_METADATA="media-metadata",o.PROPERTY_SPARK_ELEMENTID="element-id",o.PROPERTY_SPARK_ROLES="roles",o.URLBasedContentNode=(i=function(e,t){s.ContentNode.call(this,e,t)},r.defineClass({name:"URLBasedContentNode",ctor:i,superName:"ContentNode",statics:{_implements:function(e){return"TheoMessagePublisher"==e}},props:{url:{get:function(){return this.url_},set:function(e){this.url_=e}},componentID:{get:function(){return this.componentID_},set:function(e){this.componentID_=e}},mimeType:{get:function(){return this.mimeType_},set:function(e){this.mimeType_=e}},getSparkLogoRole:function(){if(null==this.sparkRoles_)return null;for(var e=r.iter(this.sparkRoles_);!e.done;e.next()){var t=e.value;switch(t){case"primary-logo":case"secondary-logo":return t;default:continue}}return null},sparkRoles:{get:function(){return this.sparkRoles_},set:function(e){this.sparkRoles_=r.clone(e)}},sparkElementID:{get:function(){return this.sparkElementID_},set:function(e){this.sparkElementID_=e}},mediaMetadata:{get:function(){return this.mediaMetadata_},set:function(e){this.mediaMetadata_=e}},decode:function(e){var t,n=this;s.ContentNode.prototype.decode.call(this,e),this.url_=null,this.componentID_=null,this.mimeType_=e.stringProperty(o.PROPERTY_MIMETYPE,""),this.mediaMetadata_=l.MediaMetadata.decodeJson(e.property(o.PROPERTY_MEDIA_METADATA)),this.sparkElementID_=e.optionalStringProperty(o.PROPERTY_SPARK_ELEMENTID),this.sparkRoles_=r.clone(r.as(e.property(o.PROPERTY_SPARK_ROLES),["Array","String"])),null!=(t=e.optionalStringProperty(o.PROPERTY_DATA_URL))?this.url_=t:e.forEachComponent(function(e,t){a.CoreAssert.isTrue(null==n.url_),n.url_=e.url,n.componentID_=e.id})},encode:function(e){var t,n;s.ContentNode.prototype.encode.call(this,e),e.setOptionalStringProperty(o.PROPERTY_MIMETYPE,this.mimeType_),e.setOptionalStringProperty(o.PROPERTY_SPARK_ELEMENTID,this.sparkElementID_),null!=this.sparkRoles_&&e.setProperty(o.PROPERTY_SPARK_ROLES,r.as(this.sparkRoles_,"AnyObject")),null!=this.mediaMetadata_&&(e.setProperty(o.PROPERTY_MEDIA_METADATA,this.mediaMetadata_.encodeJson()),(n=r.as(e,c.IExportDataObjectDocument))&&n.setManifestProperty(o.PROPERTY_MEDIA_METADATA,this.mediaMetadata_.encodeJson())),null!=this.url_&&null!=this.mimeType_&&(this.url_.startsWith(o.DATA_URL_PREFIX)?e.setProperty(o.PROPERTY_DATA_URL,r.as(this.url_,"AnyObject")):e.appendComponent(this.document.parent.uuid,(t=this.componentID_)||null!=t?t:this.id,this.url_,this.mimeType_))}}}),i)},133:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(4);o.PROPERTY_SEARCH="search",o.PROPERTY_LICENSE_TYPE="type",o.PROPERTY_SOURCE_NAME="source_name",o.PROPERTY_SOURCE_URL="source_url",o.PROPERTY_OWNER="owner",o.PROPERTY_ASSETID="asset_id",o.PROPERTY_CREATOR_USERID="creator_user_id",o.PROPERTY_CREATOR_DISPLAYNAME="creator_display_name",o.PROPERTY_DESIGN_INTENT="design_intent",o.PROPERTY_SOURCE="source",o.PROPERTY_TITLE="photo_name",o.PROPERTY_TAGS="tags",o.MediaMetadata=(i=function(){s.CoreObject.call(this)},r.defineClass({name:"MediaMetadata",ctor:i,superName:"CoreObject",statics:{kMediaStockSourceName:"Adobe Stock",kMediaNounProjectSourceName:"The Noun Project",kMediaUnsplashSourceName:"Unsplash",kMediaPixabaySourceName:"pixabay",kMediaGiphySourceName:"GIPHY",kMediaStockLicenseTypeNone:"royalty_free",kMediaStockLicenseTypeStandard:"royalty_free_standard",kMediaStockLicenseTypeExtended:"royalty_free_extended",DESIGNINTENT_LOGO:"logo",DESIGNINTENT_PATTERN:"pattern",DESIGNINTENT_ICON:"icon",DESIGNINTENT_STICKER:"sticker",fromProperties:function(e){var t=r.as(e[o.PROPERTY_SOURCE],"String");if("market"==t)return i.fromMarketProperties(e);if("dooplo"==t)return i.fromDooploProperties(e);if("adobestock"==t)return i.fromStockProperties(e);if("giphy"==t)return i.fromGiphyProperties(e);var n=new i;return n.sourceName=t,n},fromDooploProperties:function(e){var t,n,a=new i;return a.searchSource=r.as(e[o.PROPERTY_SOURCE],"String"),a.searchTerm=r.as(e[o.PROPERTY_SEARCH],"String"),(t=r.as(e.rootProperties,["Dictionary","String","Any"]))&&(n=r.as(t.license,["Dictionary","String","Any"]))&&(a.title=r.as(n[o.PROPERTY_TITLE],"String"),a.tags=r.as(n[o.PROPERTY_TAGS],"String"),a.licenseType=r.as(n[o.PROPERTY_LICENSE_TYPE],"String"),a.sourceName=r.as(n[o.PROPERTY_SOURCE_NAME],"String"),a.sourceURL=r.as(n[o.PROPERTY_SOURCE_URL],"String"),a.ownerName=r.as(n[o.PROPERTY_OWNER],"String"),a.assetID=r.as(n[o.PROPERTY_ASSETID],"String")),a},fromStockProperties:function(e){var t,n,a=new i;return a.searchSource=r.as(e[o.PROPERTY_SOURCE],"String"),a.searchTerm=r.as(e[o.PROPERTY_SEARCH],"String"),(t=r.as(e.rootProperties,["Dictionary","String","Any"]))&&(n=r.as(t.license,["Dictionary","String","Any"]))&&(a.title=r.as(n[o.PROPERTY_TITLE],"String"),a.tags=r.as(n[o.PROPERTY_TAGS],"String"),a.licenseType=r.as(n[o.PROPERTY_LICENSE_TYPE],"String"),a.sourceName=r.as(n[o.PROPERTY_SOURCE_NAME],"String"),a.sourceURL=r.as(n[o.PROPERTY_SOURCE_URL],"String"),a.ownerName=r.as(n[o.PROPERTY_OWNER],"String"),a.assetID=r.as(n[o.PROPERTY_ASSETID],"String")),a},fromGiphyProperties:function(e){var t=new i;return t.searchSource=r.as(e[o.PROPERTY_SOURCE],"String"),t.searchTerm=r.as(e[o.PROPERTY_SEARCH],"String"),t.title=r.as(e[o.PROPERTY_TITLE],"String"),t.tags=r.as(e[o.PROPERTY_TAGS],"String"),null!=e[o.PROPERTY_LICENSE_TYPE]?t.licenseType=r.as(e[o.PROPERTY_LICENSE_TYPE],"String"):t.licenseType="GIPHY Terms and Service",t.sourceName=r.as(e[o.PROPERTY_SOURCE_NAME],"String"),t.sourceURL=r.as(e[o.PROPERTY_SOURCE_URL],"String"),t.ownerName=r.as(e[o.PROPERTY_OWNER],"String"),t.assetID=r.as(e[o.PROPERTY_ASSETID],"String"),t.designIntent=i.DESIGNINTENT_STICKER,t},fromMarketProperties:function(e){var t,n=new i;return n.searchSource=r.as(e[o.PROPERTY_SOURCE],"String"),n.title=r.as(e.name,"String"),n.assetID=r.as(e.assetID,"String"),n.creatorUserID=r.as(e.creator_userID,"String"),n.creatorDisplayName=r.as(e.creator_displayName,"String"),n.designIntent=r.as(e.design_intent,"String"),(t=r.as(e.tags,["Array","Any"]))&&(n.tags=t.join(",")),n},decodeJson:function(e){var t;if(null==e)return null;if(t=r.as(e,["Dictionary","String","Any"])){var n=new i;return n.searchSource_=r.as(t[o.PROPERTY_SOURCE],"String"),n.searchTerm_=r.as(t[o.PROPERTY_SEARCH],"String"),n.title_=r.as(t[o.PROPERTY_TITLE],"String"),n.tags_=r.as(t[o.PROPERTY_TAGS],"String"),n.licenseType_=r.as(t[o.PROPERTY_LICENSE_TYPE],"String"),n.sourceName_=r.as(t[o.PROPERTY_SOURCE_NAME],"String"),n.sourceUrl_=r.as(t[o.PROPERTY_SOURCE_URL],"String"),n.ownerName_=r.as(t[o.PROPERTY_OWNER],"String"),n.assetID_=r.as(t[o.PROPERTY_ASSETID],"String"),n.creatorUserID_=r.as(t[o.PROPERTY_CREATOR_USERID],"String"),n.creatorDisplayName_=r.as(t[o.PROPERTY_CREATOR_DISPLAYNAME],"String"),n.designIntent_=r.as(t[o.PROPERTY_DESIGN_INTENT],"String"),n}return a.CoreAssert.fail("Not a dictionary"),null}},props:{getDebugDesc:function(){var e,t,n,i,o,r,a,s="sourceName_: "+((e=this.sourceName_)||null!=e?e:"")+" searchSource_: "+((t=this.searchSource_)||null!=t?t:"")+" searchTerm_: "+((n=this.searchTerm_)||null!=n?n:"");return s+=" designIntent_: "+((i=this.designIntent_)||null!=i?i:"")+" licenseType_: "+((o=this.licenseType_)||null!=o?o:"")+" assetID_: "+((r=this.assetID_)||null!=r?r:"")+" sourceUrl_: "+((a=this.sourceUrl_)||null!=a?a:"")},match:function(e){this.searchSource=e.searchSource,this.searchTerm=e.searchTerm,this.title=e.title,this.tags=e.tags,this.licenseType=e.licenseType,this.sourceURL=e.sourceURL,this.sourceName=e.sourceName,this.ownerName=e.ownerName,this.assetID=e.assetID,this.creatorUserID=e.creatorUserID,this.creatorDisplayName=e.creatorUserID,this.designIntent=e.designIntent},isEqualTo:function(e){var t;return!(!(t=r.as(e,i))||this.searchSource!=t.searchSource||this.searchTerm!=t.searchTerm||this.title!=t.title||this.tags!=t.tags||this.licenseType!=t.licenseType||this.sourceURL!=t.sourceURL||this.sourceName!=t.sourceName||this.ownerName!=t.ownerName||this.assetID!=t.assetID||this.creatorUserID!=t.creatorUserID||this.creatorDisplayName!=t.creatorUserID||this.designIntent!=t.designIntent)},searchSource:{get:function(){return this.searchSource_},set:function(e){this.searchSource_=e}},searchTerm:{get:function(){return this.searchTerm_},set:function(e){this.searchTerm_=e}},title:{get:function(){return this.title_},set:function(e){this.title_=e}},tags:{get:function(){return this.tags_},set:function(e){this.tags_=e}},licenseType:{get:function(){return this.licenseType_},set:function(e){this.licenseType_=e}},sourceName:{get:function(){return this.sourceName_},set:function(e){this.sourceName_=e}},sourceURL:{get:function(){return this.sourceUrl_},set:function(e){this.sourceUrl_=e}},ownerName:{get:function(){return this.ownerName_},set:function(e){this.ownerName_=e}},assetID:{get:function(){return this.assetID_},set:function(e){this.assetID_=e}},creatorUserID:{get:function(){return this.creatorUserID_},set:function(e){this.creatorUserID_=e}},creatorDisplayName:{get:function(){return this.creatorDisplayName_},set:function(e){this.creatorDisplayName_=e}},designIntent:{get:function(){return this.designIntent_},set:function(e){this.designIntent_=e}},encodeJson:function(){var e={};return null!=this.searchSource_&&(e[o.PROPERTY_SOURCE]=this.searchSource_),null!=this.searchTerm_&&(e[o.PROPERTY_SEARCH]=this.searchTerm_),null!=this.title_&&(e[o.PROPERTY_TITLE]=this.title_),null!=this.tags&&(e[o.PROPERTY_TAGS]=this.tags_),null!=this.licenseType_&&(e[o.PROPERTY_LICENSE_TYPE]=this.licenseType_),null!=this.sourceName_&&(e[o.PROPERTY_SOURCE_NAME]=this.sourceName_),null!=this.sourceUrl_&&(e[o.PROPERTY_SOURCE_URL]=this.sourceUrl_),null!=this.ownerName_&&(e[o.PROPERTY_OWNER]=this.ownerName_),null!=this.assetID_&&(e[o.PROPERTY_ASSETID]=this.assetID_),null!=this.creatorUserID_&&(e[o.PROPERTY_CREATOR_USERID]=this.creatorUserID_),null!=this.creatorDisplayName_&&(e[o.PROPERTY_CREATOR_DISPLAYNAME]=this.creatorDisplayName_),null!=this.designIntent_&&(e[o.PROPERTY_DESIGN_INTENT]=this.designIntent_),e},sourceHasLicense:function(){return this.sourceName==i.kMediaStockSourceName||this.sourceName==i.kMediaPixabaySourceName||this.sourceName==i.kMediaUnsplashSourceName||this.sourceName==i.kMediaNounProjectSourceName||this.sourceName==i.kMediaGiphySourceName}}}),i)},150:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(8),c=n(412),l=n(10),u=n(132);o.PROPERTY_PIXEL_WIDTH="pixel-width",o.PROPERTY_PIXEL_HEIGHT="pixel-height",o.PROPERTY_IMAGE_COLOR_DATA="image-color-data",o.PROPERTY_IMAGE_HAS_ALPHA="image-has_alpha",o.PROPERTY_SALIENCY_WIDTH="saliency-width",o.PROPERTY_SALIENCY_HEIGHT="saliency-height",o.PROPERTY_SALIENCY_DATA="saliency-data",o.PROPERTY_EDGE_DATA="edge-data",o.PROPERTY_FOCUS_REGION="focus-region",o.ImageContentNode=(i=function(e,t){this.pixelWidth_=0,this.pixelHeight_=0,this.image_=null,this.hasAlpha_=null,this.imageColorData_=null,this.focusRegion_=null,this.saliencyWidth_=0,this.saliencyHeight_=0,this.saliencyData_=null,this.edgeData_=null,this.saliencyIntegral_=null,this.edgeIntegral_=null,this.MAX_SALIENCY_DIM=25,u.URLBasedContentNode.call(this,e,t)},r.defineClass({name:"ImageContentNode",ctor:i,superName:"URLBasedContentNode",statics:{KIND:{get:function(){return"image"}},decodeDoubleArray:function(e){var t;if(t=r.as(e,["Array","AnyObject"])){for(var n=[],i=r.iter(t);!i.done;i.next()){var o,a=i.value;null!=(o=r.as(a,"Double"))?n.push(o):n.push(0)}return n}return null},decodeImageColorData:function(e){if(null==e)return null;var t;if(t=r.as(e,["Array","AnyObject"])){for(var n=[],i=r.iter(t);!i.done;i.next()){var o=i.value;n.push(c.ImageColorData.decodeJson(o))}return n}return null},_implements:function(e){return"TheoMessagePublisher"==e}},props:{pixelWidth:{get:function(){return this.pixelWidth_},set:function(e){this.pixelWidth_=e}},pixelHeight:{get:function(){return this.pixelHeight_},set:function(e){this.pixelHeight_=e}},imageColorData:{get:function(){if(null!=this.imageColorData_)return this.imageColorData_.concat();if(null!=this.image_){for(var e=r.clone(this.image_.getImageColorData(10)),t=[],n=r.iter(e);!n.done;n.next()){var i=n.value;t.push(i)}return this.imageColorData_=t,e}return null}},saliencyWidth:{get:function(){return 0==this.saliencyWidth_&&this.computeSaliencyData(),this.saliencyWidth_}},saliencyHeight:{get:function(){return 0==this.saliencyHeight_&&this.computeSaliencyData(),this.saliencyHeight_}},saliencyData:{get:function(){return null!=this.saliencyData_&&0!=this.saliencyData_.length||this.computeSaliencyData(),this.saliencyData_}},edgeData:{get:function(){return null!=this.edgeData_&&0!=this.edgeData_.length||this.computeEdgeData(),this.edgeData_}},getSaliencyDataDimensions:function(){if(0==this.pixelWidth_||0==this.pixelHeight_)return null;var e=r.toDouble(this.MAX_SALIENCY_DIM),t=r.toDouble(this.pixelWidth_)/r.toDouble(this.pixelHeight);return t>1?{width:r.toInt(e),height:r.toInt(e/t)}:{width:r.toInt(e*t),height:r.toInt(e)}},computeSaliencyData:function(){var e,t,n=this;(e=this.image)&&null!=(t=this.getSaliencyDataDimensions())&&e.whenAsyncFeaturesLoaded(function(){n.saliencyWidth_=t.width,n.saliencyHeight_=t.height,n.saliencyData_=r.clone(e.getSaliencyData(n.saliencyWidth_,n.saliencyHeight_)),n.computeSaliencyIntegral()})},computeSaliencyIntegral:function(){null!=this.saliencyData_&&this.saliencyData_.length>0&&(this.saliencyIntegral_=r.clone(this.createIntegralImage(r.clone(this.saliencyData_),this.saliencyWidth_,this.saliencyHeight_)))},createIntegralImage:function(e,t,n){for(var i=r.repeat(0,t*n),o=r.repeat([],n),a=r.repeat([],n),s=r.iter(r.range(0,t,!1));!s.done;s.next())for(var c=s.value,l=r.iter(r.range(0,n,!1));!l.done;l.next()){var u=l.value,h=c>0&&u>0?i[(u-1)*t+(c-1)]:0,_=u>0?i[(u-1)*t+c]:0,d=c>0?i[u*t+(c-1)]:0,f=e[u*t+c];i[u*t+c]=f+_+d-h,o[u].push(f),a[u].push(f+_+d-h)}return i},computeEdgeData:function(){var e,t;(e=this.image)&&null!=(t=this.getSaliencyDataDimensions())&&(this.saliencyWidth_=t.width,this.saliencyHeight_=t.height,this.edgeData_=r.clone(e.getEdgeData(this.saliencyWidth_,this.saliencyHeight_)),this.computeEdgeIntegral())},computeEdgeIntegral:function(){null!=this.edgeData_&&this.edgeData_.length>0&&(this.edgeIntegral_=r.clone(this.createIntegralImage(r.clone(this.edgeData_),this.saliencyWidth_,this.saliencyHeight_)))},getAverageEdge:function(e){return null!=this.edgeIntegral_&&this.edgeIntegral_.length>0?this.getAverageSaliencyOrEdge(e,r.clone(this.edgeIntegral_),this.saliencyWidth_,this.saliencyHeight_):(this.createImageFeatures(),null!=this.saliencyIntegral_&&this.saliencyIntegral_.length>0?this.getAverageSaliencyOrEdge(e,r.clone(this.saliencyIntegral_),this.saliencyWidth_,this.saliencyHeight_):0)},getAverageSaliency:function(e){return null!=this.saliencyIntegral_&&this.saliencyIntegral_.length>0?this.getAverageSaliencyOrEdge(e,r.clone(this.saliencyIntegral_),this.saliencyWidth_,this.saliencyHeight_):(this.createImageFeatures(),null!=this.edgeIntegral_&&this.saliencyIntegral_.length>0?this.getAverageSaliencyOrEdge(e,r.clone(this.edgeIntegral_),this.saliencyWidth_,this.saliencyHeight_):0)},getAverageSaliencyOrEdge:function(e,t,n,i){if(0==this.saliencyWidth_||0==this.saliencyHeight_)return 0;var o=r.toDouble(n)/r.toDouble(this.pixelWidth_),a=r.toDouble(i)/r.toDouble(this.pixelHeight_),s=e.multiplyXY(o,a),c=r.toInt(Math.max(r.toInt(s.minY),0)),l=r.toInt(Math.min(r.toInt(s.maxY),i-1)),u=r.toInt(Math.max(r.toInt(s.minX),0)),h=r.toInt(Math.min(r.toInt(s.maxX),n-1));if(c>=l||u>=h)return 0;var _=t[c*n+u],d=t[c*n+h],f=t[l*n+u],m=t[l*n+h]+_-d-f,T=(h-u)*(l-c);return r.toDouble(m)/r.toDouble(T)},focusRegion:{get:function(){var e,t;return null==this.focusRegion_||0!=this.focusRegion_.width&&0!=this.focusRegion_.height||(this.focusRegion_=l.TheoRect.ONE_BY_ONE),(e=this.image)&&e.loaded()&&null!=(t=e.getFocus())&&0!=t.width&&0!=t.height&&(this.focusRegion_=t),(t=this.focusRegion_)?l.TheoRect.fromXXYY(t.minX*r.toDouble(this.pixelWidth),t.maxX*r.toDouble(this.pixelWidth),t.minY*r.toDouble(this.pixelHeight),t.maxY*r.toDouble(this.pixelHeight)):null},set:function(e){var t;(t=e)&&a.CoreAssert.isTrue(t.maxX<=1&&t.maxY<=1,"focusRegion must be 0-1"),this.focusRegion_=e}},createImageFeatures:function(){var e=this;r.opt(this.image,function(t){return t.whenLoaded(function(){e.focusRegion,r.clone(e.saliencyData),r.clone(e.edgeData),r.clone(e.imageColorData)})})},url:{get:function(){return u.URLBasedContentNode._getters.url.call(this)},set:function(e){u.URLBasedContentNode._setters.url.call(this,e)}},hasAlpha:{get:function(){if(null==this.hasAlpha_){var e=this.image;null!=e&&(this.hasAlpha_=e.hasAlpha())}return null!=this.hasAlpha_&&this.hasAlpha_},set:function(e){this.hasAlpha_=e}},hasAlphaSafe:{get:function(){return this.hasAlpha_}},image:{get:function(){var e=this;return null==this.image_&&null!=this.url&&(this.image_=s.Host.imageAnalysis.createHostImage(this.url,this.hasAlpha_)),null!=this.image_&&null==this.focusRegion_&&r.opt(this.image_,function(t){return t.whenAsyncFeaturesLoaded(function(){e.focusRegion=r.opt(e.image_,function(e){return e.getFocus()})})}),this.image_},set:function(e){this.image_=e}},hostImageLoaded:{get:function(){return null!=this.image_&&this.image_.loaded()}},releaseResources:function(){this.image_=null},decode:function(e){u.URLBasedContentNode.prototype.decode.call(this,e),this.pixelWidth_=r.toInt(e.numberProperty(o.PROPERTY_PIXEL_WIDTH,0)),this.pixelHeight_=r.toInt(e.numberProperty(o.PROPERTY_PIXEL_HEIGHT,0)),this.image_=null,this.imageColorData_=i.decodeImageColorData(e.property(o.PROPERTY_IMAGE_COLOR_DATA)),this.hasAlpha_=e.optionalBooleanProperty(o.PROPERTY_IMAGE_HAS_ALPHA),this.focusRegion_=l.TheoRect.decodeJson(e.property(o.PROPERTY_FOCUS_REGION)),this.saliencyWidth_=r.toInt(e.numberProperty(o.PROPERTY_SALIENCY_WIDTH,0)),this.saliencyHeight_=r.toInt(e.numberProperty(o.PROPERTY_SALIENCY_HEIGHT,0)),this.saliencyData_=r.clone(i.decodeDoubleArray(e.property(o.PROPERTY_SALIENCY_DATA))),this.edgeData_=r.clone(i.decodeDoubleArray(e.property(o.PROPERTY_EDGE_DATA))),Math.max(this.saliencyWidth_,this.saliencyHeight_)!=this.MAX_SALIENCY_DIM&&(this.saliencyData_=null,this.edgeData_=null),null!=this.saliencyData_&&this.computeSaliencyIntegral(),null!=this.edgeData_&&this.computeEdgeIntegral()},encode:function(e){u.URLBasedContentNode.prototype.encode.call(this,e),e.setNumberProperty(o.PROPERTY_PIXEL_WIDTH,r.toDouble(this.pixelWidth_)),e.setNumberProperty(o.PROPERTY_PIXEL_HEIGHT,r.toDouble(this.pixelHeight_)),null!=this.hasAlpha_&&e.setBooleanProperty(o.PROPERTY_IMAGE_HAS_ALPHA,this.hasAlpha_),null!=this.imageColorData_&&e.setProperty(o.PROPERTY_IMAGE_COLOR_DATA,this.encodeImageColorData()),e.setNumberProperty(o.PROPERTY_SALIENCY_WIDTH,r.toDouble(this.saliencyWidth_)),e.setNumberProperty(o.PROPERTY_SALIENCY_HEIGHT,r.toDouble(this.saliencyHeight_)),null!=this.focusRegion_&&e.setProperty(o.PROPERTY_FOCUS_REGION,this.focusRegion_.encodeJson()),null!=this.saliencyData_&&e.setProperty(o.PROPERTY_SALIENCY_DATA,r.as(this.saliencyData_,"AnyObject")),null!=this.edgeData_&&e.setProperty(o.PROPERTY_EDGE_DATA,r.as(this.edgeData_,"AnyObject"))},encodeImageColorData:function(){var e=[];if(null!=this.imageColorData_)for(var t=r.iter(this.imageColorData_);!t.done;t.next()){var n=t.value;e.push(n.encodeJson())}return r.as(e,"AnyObject")}}}),i)},151:function(e,t,n){var i,o=t,r=n(0),a=n(305),s=n(191);o.TheoDOMPublishingElement=(i=function(){this.publishing_=new a.TheoBasePublishing,s.TheoDOMElement.call(this),this.publishing_.owner=this},r.defineClass({name:"TheoDOMPublishingElement",ctor:i,superName:"TheoDOMElement",statics:{_implements:function(e){return"TheoMessagePublisher"==e}},props:{subscribeWithCallback:function(e,t){return this.publishing_.subscribeWithCallback(e,t)},subscribe:function(e,t){return this.publishing_.subscribe(e,t)},unsubscribe:function(e){return this.publishing_.unsubscribe(e)},publish:function(e){return this.publishing_.publish(e)}}}),i)},153:function(e,t,n){var i,o=t,r=n(0),a=n(48),s=n(132);o.PROPERTY_WIDTH="width",o.PROPERTY_HEIGHT="height",o.PROPERTY_DURATION="duration",o.PROPERTY_TIME_SAMPLES="time-samples",o.VideoContentNode=(i=function(e,t){this.width_=0,this.height_=0,this.duration_=a.TheoTime.Zero,this.times_=[],s.URLBasedContentNode.call(this,e,t)},r.defineClass({name:"VideoContentNode",ctor:i,superName:"URLBasedContentNode",statics:{LIVE_PHOTO_TAG:"LivePhoto",KIND:{get:function(){return"video"}},decodeTimesSamples:function(e){if(null==e)return null;var t;if(t=r.as(e,["Array","AnyObject"])){for(var n=[],i=r.iter(t);!i.done;i.next()){var o=i.value;n.push(a.TheoTime.decodeJson(o))}return n}return null},_implements:function(e){return"TheoMessagePublisher"==e}},props:{url:{get:function(){return s.URLBasedContentNode._getters.url.call(this)},set:function(e){s.URLBasedContentNode._setters.url.call(this,e)}},width:{get:function(){return this.width_},set:function(e){this.width_=e}},height:{get:function(){return this.height_},set:function(e){this.height_=e}},duration:{get:function(){return this.duration_},set:function(e){this.duration_=e}},times:{get:function(){return this.times_},set:function(e){this.times_=e}},isGIF:{get:function(){var e;return null!=(e=this.mimeType)&&e.includes("gif")}},addTime:function(e){this.times_.push(e)},timesAsNSArray:{get:function(){for(var e=[],t=r.iter(this.times_);!t.done;t.next()){var n=t.value;e.push(n)}return e.concat()}},decode:function(e){s.URLBasedContentNode.prototype.decode.call(this,e),this.width_=r.toInt(e.numberProperty(o.PROPERTY_WIDTH,0)),this.height_=r.toInt(e.numberProperty(o.PROPERTY_HEIGHT,0)),this.duration_=a.TheoTime.decodeJson(e.property(o.PROPERTY_DURATION)),this.times_=i.decodeTimesSamples(e.property(o.PROPERTY_TIME_SAMPLES))},encode:function(e){s.URLBasedContentNode.prototype.encode.call(this,e),e.setNumberProperty(o.PROPERTY_WIDTH,r.toDouble(this.width_)),e.setNumberProperty(o.PROPERTY_HEIGHT,r.toDouble(this.height_)),e.setProperty(o.PROPERTY_DURATION,this.duration_.encodeJson()),e.setProperty(o.PROPERTY_TIME_SAMPLES,this.encodeTimeSamples())},encodeTimeSamples:function(){for(var e=[],t=r.iter(this.times_);!t.done;t.next()){var n=t.value;e.push(n.encodeJson())}return r.as(e,"AnyObject")}}}),i)},191:function(e,t,n){var i,o=t,r=n(0),a=n(4);o.TheoDOMElement=(i=function(){a.CoreObject.call(this)},r.defineClass({name:"TheoDOMElement",ctor:i,superName:"CoreObject"}),i)},193:function(e,t,n){var i,o=t,r=n(0),a=n(236),s=n(192),c=n(194);o.PROPERTY_TEXT_MODEL="text-model",o.TextContentNode=(i=function(e,t){this.textModel_=new c.ContentTextModel,a.ContentNode.call(this,e,t)},r.defineClass({name:"TextContentNode",ctor:i,superName:"ContentNode",statics:{KIND:{get:function(){return"text"}},_implements:function(e){return"TheoMessagePublisher"==e}},props:{text:{get:function(){return this.textModel_.text},set:function(e){this.textModel_.text=e}},insert:function(e,t){void 0===t&&(t=0),this.textModel_.insert(e,t)},removeText:function(){this.textModel_.remove(this.textModel_.rangeAll)},subscribeWithCallbackToTextModel:function(e,t){return this.textModel_.subscribeWithCallback(e,t)},match:function(e){var t;(t=r.as(e,i))&&this.textModel_.match(t.textModel_),a.ContentNode.prototype.match.call(this,e)},decode:function(e){var t;a.ContentNode.prototype.decode.call(this,e),(t=c.TextModel.decodeJson(e.property(o.PROPERTY_TEXT_MODEL),this.document.parent))&&(this.textModel_.text=t.text)},encode:function(e){var t;a.ContentNode.prototype.encode.call(this,e),e.setProperty(o.PROPERTY_TEXT_MODEL,this.textModel_.encodeJson()),(t=r.as(e,s.IExportDataObjectDocument))&&t.setManifestProperty(o.PROPERTY_TEXT_MODEL,this.textModel_.encodeJson())}}}),i)},195:function(e,t,n){var i,o=t,r=n(0),a=n(313);o.RootContentNode=(i=function(e,t){a.GroupContentNode.call(this,e,t)},r.defineClass({name:"RootContentNode",ctor:i,superName:"GroupContentNode",statics:{DOCUMENT_SOURCE_ID_TAG:"document:source:id",DOCUMENT_SOURCE_TYPE_TAG:"document:source:type",THEME_ID_TAG:"theme:id",PALETTE_ID_TAG:"palette:id",SUMMIT_LOGO_TAG:"SummitLogo",KIND:{get:function(){return"root"}},_implements:function(e){return"TheoMessagePublisher"==e}}}),i)},196:function(e,t,n){var i,o=t,r=n(0),a=n(48);o.AnimationStyleCategory=r.defineEnum("AnimationStyleCategory",{None:"none",Text:"text",Image:"image"}),o.AnimationStyle=(i=function(){},r.defineClass({name:"AnimationStyle",ctor:i,superName:"CoreObject",statics:{DEFAULT_TIMESCALE:{get:function(){return 30}},DEFAULT_START:{get:function(){return new a.TheoTime(0,i.DEFAULT_TIMESCALE)}},DEFAULT_DURATION:{get:function(){return new a.TheoTime(75,i.DEFAULT_TIMESCALE)}},STILL_DURATION:{get:function(){return new a.TheoTime(60,i.DEFAULT_TIMESCALE)}},END_GIF_DURATION:{get:function(){return new a.TheoTime(150,i.DEFAULT_TIMESCALE)}},GIF_DURATION:{get:function(){return new a.TheoTime(150,i.DEFAULT_TIMESCALE)}},FADE_DURATION:{get:function(){return new a.TheoTime(30,i.DEFAULT_TIMESCALE)}},COLOR_SWAP_DURATION:{get:function(){return new a.TheoTime(180,i.DEFAULT_TIMESCALE)}},PROPERTY_NAME:"name",PROPERTY_VARIANT:"variant",PROPERTY_VARIANT_COUNT:"variant-count",PROPERTY_START_TIME:"start-time",PROPERTY_END_TIME:"end-time",PROPERTY_LOOPING:"looping",PROPERTY_CATEGORY:"category",DEPRECATED_PROPERTY_TEXT_STYLE:"text-style",DEPRECATED_PROPERTY_IMAGE_STYLE:"image-style",NAME_NO_STYLE:"None",NAME_TYPE:"Type",LETTER_APPEAR_VARIANT:10,LETTER_RANDOM_FADE_VARIANT:11,LETTER_APPEAR_FADE_VARIANT:12,NAME_FLICKER:"Flicker",NAME_GROW:"Grow",NAME_FADE:"Fade",NAME_DYNAMIC:"Dynamic",WORD_ZOOM_IN_VARIANT:0,WORD_CENTERED_VARIANT:1,WORD_APPEAR_VARIANT:2,NAME_COLORSWAP:"ColorSwap",NAME_SLIDE:"Slide",NAME_ZOOM:"Zoom",NAME_PAN:"Pan",NAME_GRAYSCALE:"Greyscale",NAME_BLUR:"Blur",NAME_COLOR:"Color",NAME_FILL:"Fill",decodeJson:function(e){var t,n,s,c,l;if(null==e)return null;if(l=r.as(e,["Dictionary","String","Any"])){var u,h=l[i.PROPERTY_NAME],_=l[i.PROPERTY_VARIANT],d=l[i.PROPERTY_VARIANT_COUNT],f=a.TheoTime.decodeJson(r.as(l[i.PROPERTY_START_TIME],"AnyObject")),m=a.TheoTime.decodeJson(r.as(l[i.PROPERTY_END_TIME],"AnyObject")),T=!(!(t=r.as(l[i.PROPERTY_LOOPING],"Bool"))&&null==t)&&t,p=o.AnimationStyleCategory.None;null!=(u=r.as(l[i.PROPERTY_CATEGORY],"String"))&&(p=(n=o.AnimationStyleCategory.toCaseValue(u))||null!=n?n:o.AnimationStyleCategory.None);var g=!(!(s=r.as(l[i.DEPRECATED_PROPERTY_TEXT_STYLE],"Bool"))&&null==s)&&s,R=!(!(c=r.as(l[i.DEPRECATED_PROPERTY_IMAGE_STYLE],"Bool"))&&null==c)&&c;if(g&&(p=o.AnimationStyleCategory.Text),R&&(p=o.AnimationStyleCategory.Image),null!=f&&null!=m)return i.init_d915(h,_,d,f,m,p,T);var E=new a.TheoTime(0,i.DEFAULT_DURATION.timescale);return i.init_d915(h,_,d,E,i.DEFAULT_DURATION,p,T)}return null},noStyleAsString:function(){return i.NAME_NO_STYLE+"_0"}},props:{init_b946:function(e,t){void 0===e&&(e=i.NAME_NO_STYLE),void 0===t&&(t=o.AnimationStyleCategory.None),this.name_=e,this.variant_=0,this.variantCount_=1,this.startTime_=i.DEFAULT_START,this.endTime_=i.DEFAULT_DURATION,this.looping_=!1,this.category_=t},init_e14f:function(e,t,n,r,a){void 0===r&&(r=o.AnimationStyleCategory.None),void 0===a&&(a=!1),this.name_=e,this.variant_=t,this.variantCount_=n,this.looping_=a,this.startTime_=i.DEFAULT_START,this.endTime_=i.DEFAULT_DURATION,this.category_=r},init_d915:function(e,t,n,i,r,a,s){void 0===a&&(a=o.AnimationStyleCategory.None),void 0===s&&(s=!1),this.name_=e,this.variant_=t,this.variantCount_=n,this.startTime_=i,this.endTime_=r,this.looping_=s,this.category_=a},name:{get:function(){return this.name_}},startTime:{get:function(){return this.startTime_},set:function(e){this.startTime_=e}},endTime:{get:function(){return this.endTime_},set:function(e){this.endTime_=e}},variant:{get:function(){return this.variant_},set:function(e){this.variant_=e}},textStyle:{get:function(){return this.category_==o.AnimationStyleCategory.Text}},imageStyle:{get:function(){return this.category_==o.AnimationStyleCategory.Image}},category:{get:function(){return this.category_}},variantCount:{get:function(){return this.variantCount_},set:function(e){this.variantCount_=e}},looping:{get:function(){return this.looping_},set:function(e){this.looping_=e}},modifiesFormaTree:{get:function(){return this.name==i.NAME_FLICKER||this.name==i.NAME_TYPE||this.name==i.NAME_FADE}},isNewTextAnimation:{get:function(){return this.name==i.NAME_TYPE||this.name==i.NAME_DYNAMIC||this.name==i.NAME_FLICKER||this.name==i.NAME_COLORSWAP}},clone:function(){return i.init_d915(this.name,this.variant,this.variantCount,this.startTime,this.endTime,this.category,this.looping)},equals:function(e){return e.name==this.name_&&e.variant==this.variant_},encodeJson:function(){var e={};return e[i.PROPERTY_NAME]=this.name_,e[i.PROPERTY_VARIANT]=this.variant_,e[i.PROPERTY_VARIANT_COUNT]=this.variantCount_,e[i.PROPERTY_START_TIME]=this.startTime.encodeJson(),e[i.PROPERTY_END_TIME]=this.endTime.encodeJson(),e[i.PROPERTY_LOOPING]=this.looping_,e[i.PROPERTY_CATEGORY]=this.category_,e},asString:{get:function(){return this.name_+"_"+this.variant_}},isNoStyle:function(){return this.name==i.NAME_NO_STYLE}}}),i)},236:function(e,t,n){var i,o=t,r=n(0),a=n(56),s=n(151);o.ContentNode=(i=function(e,t){this.tags_={},this.doc_=e,this.uuid_=a.GUIDUtils.makeGUID(),this.id_=a.GUIDUtils.makeGUID(),this.kind=t,this.parent_=null,s.TheoDOMPublishingElement.call(this)},r.defineClass({name:"ContentNode",ctor:i,superName:"TheoDOMPublishingElement",statics:{PROPERTY_TAGS:"tags",_implements:function(e){return"TheoMessagePublisher"==e}},props:{match:function(e){this.clearTags();for(var t=r.iter(e.tags);!t.done;t.next()){var n=t.value;this.setTag(n,e.getTag(n))}},uuid:{get:function(){return this.uuid_}},id:{get:function(){return this.id_},set:function(e){this.id_=e}},nodeByID:function(e){return e==this.id_?this:null},nodeWithTag:function(e,t){return this.tags_[e]==t?this:null},tags:{get:function(){for(var e=[],t=r.iter(this.tags_);!t.done;t.next()){var n=t.key;e.push(n)}return e}},clearTags:function(){this.tags_={}},getTag:function(e){return this.tags_[e]},setTag:function(e,t){this.tags_[e]=t},document:{get:function(){return this.doc_}},parent:{get:function(){return this.parent_},set:function(e){this.parent_=e}},removeFromParent:function(){null!=this.parent_&&this.parent_.removeChild(this)},visit:function(e){return e(this)?this:null},visitAll:function(e){this.visit(function(t){return e(t),!1})},releaseResources:function(){},publish:function(e){s.TheoDOMPublishingElement.prototype.publish.call(this,e),r.opt(this.doc_,function(t){return t.publishForChild(e)})},decode:function(e){var t;if(this.uuid_=e.id,this.id_=e.path,this.tags_={},t=r.as(e.property(i.PROPERTY_TAGS),["Dictionary","String","String"]))for(var n=r.iter(t);!n.done;n.next()){var o=n.key,a=n.value;this.tags_[o]=a}},postDecode:function(){},encode:function(e){if(e.setStringProperty("kind",this.kind),e.setPath(this.id_),r.count(this.tags_)>0){for(var t={},n=r.iter(this.tags_);!n.done;n.next()){var o=n.key,a=n.value;t[o]=a}e.setProperty(i.PROPERTY_TAGS,t)}}}}),i)},250:function(e,t,n){var i,o,r,a,s,c=t,l=n(0),u=n(49),h=n(1),_=n(4),d=n(11),f=n(26),m=n(23),T=n(56),p=n(8),g=n(17),R=n(160),E=n(37),P=n(199),C=n(57),D=n(30),O=n(14),I=n(94),S=n(15),M=n(10),A=n(132);c.PairingFeatures=l.defineEnum("PairingFeatures",{BOUNDARY_DISTANCE:"boundary_distance",CENTER_DISTANCE:"center_distance",X_ALIGNED:"x_aligned",Y_ALIGNED:"y_aligned",LEFT_ALIGNED:"left_aligned",CENTER_X_ALIGNED:"center_x_aligned",RIGHT_ALIGNED:"right_aligned",TOP_ALIGNED:"top_aligned",CENTER_Y_ALIGNED:"center_y_aligned",BOTTOM_ALIGNED:"bottom_aligned",HEIGHT_DIFF:"height_diff",WIDTH_DIFF:"width_diff",AREA_DIFF:"area_diff",CONTAINMENT_MISMATCH:"containment_mismatch",INTERSECTION:"intersection",CONTAINMENT_CHILD_COUNT:"containment_child_count",CHILD_COUNT_MATCH:"child_count_match",UNION_POSITION_X:"union_position_x",UNION_POSITION_Y:"union_position_y",UNION_NUM_NON_INTERSECT:"union_num_non_intersect",UNION_AREA:"union_area",UNION_EMPTY_SPACE:"union_empty_space",OUT_OF_BOUNDS_MISMATCH:"out_of_bounds_mismatch",OPACITY_DIFFERENCE:"opacity_difference",COLOR_DISTANCE:"color_distance",FONT_SIZE_DISTANCE:"font_size_distance",POSITION_X_FIRST:"position_x_first",POSITION_Y_FIRST:"position_y_first",POSITION_X_SECOND:"position_x_second",POSITION_Y_SECOND:"position_y_second",AREA_FIRST:"area_first",AREA_SECOND:"area_second",IS_SHAPE_FIRST:"is_shape_first",IS_TEXT_FIRST:"is_text_first",IS_IMAGE_FIRST:"is_image_first",IS_SHAPE_SECOND:"is_shape_second",IS_TEXT_SECOND:"is_text_second",IS_IMAGE_SECOND:"is_image_second",TYPE_MISMATCH:"type_mismatch"}),c.GroupLayoutStrategy=l.defineEnum("GroupLayoutStrategy",{Default:0,VerticalFlow:1,HorizontalFlow:2}),c.VisualNode=(i=function(){this.origNode=null,this.constraintLeft=!1,this.constraintRight=!1,this.constraintWidth=!1,this.constraintTop=!1,this.constraintBottom=!1,this.constraintHeight=!1,this.bgConstraint=!1,this.id=T.GUIDUtils.makeGUID()},l.defineClass({name:"VisualNode",ctor:i,superName:"CoreObject",props:{frame:{get:function(){return this.frame_},set:function(e){null==this.frame_&&(this.initFrame=e),this.frame_=e}},root:{get:function(){for(var e=this.parent;null!=e&&null!=e.parent;)e=e.parent;return e}},shortID:{get:function(){return this.id.substr(0,4)}},maintainAspectRatio:{get:function(){return!1}},clone:function(){var e=new i;return e.frame=this.frame,e.initFrame=this.initFrame,e.origNode=this,e.bgConstraint=this.bgConstraint,e},description:{get:function(){return"???: "+this.shortID+" "+this.frameString}},frameString:{get:function(){var e=l.toString(Math.round(this.frame.minX)),t=l.toString(Math.round(this.frame.maxX)),n=l.toString(Math.round(this.frame.minY)),i=l.toString(Math.round(this.frame.maxY));return" x: "+e+" "+t+" ("+l.toString(Math.round(this.frame.width))+"), y:"+n+" "+i+" ("+l.toString(Math.round(this.frame.height))+")"}},resetConstraints:function(e){void 0===e&&(e=null),null!=e&&e||this.resetXConstraints(),(null==e||e)&&this.resetYConstraints()},resetXConstraints:function(){this.constraintLeft=!1,this.constraintRight=!1,this.constraintWidth=!1},resetYConstraints:function(){this.constraintTop=!1,this.constraintBottom=!1,this.constraintHeight=!1},print:function(){for(var e="",t=[this];t.length>0;){var n,i=t[0];t.splice(0,1),(n=l.as(i,c.VisualNodeGroup))&&(t=n.children.concat(t));for(var o=i.parent;null!=o;)o=l.opt(o,function(e){return e.parent}),e+="\t";e+=i.description+"\n"}return e}}}),i),c.VisualNodeLeaf=(o=function(e,t){this.hasForegroundRole_=null,this.hasBackgroundRole_=null,void 0===t&&(t=null),this.forma=e,c.VisualNode.call(this),this.frame=null!=t?t:e.frame},l.defineClass({name:"VisualNodeLeaf",ctor:o,superName:"VisualNode",props:{maintainAspectRatio:{get:function(){return this.forma.controller.maintainAspectRatio}},clone:function(){var e=new o(this.forma,this.frame);return e.origNode=this,e},hasForegroundRole:{get:function(){if(null!=this.hasForegroundRole_)return this.hasForegroundRole_;if(this.forma.isTypeLockup())return this.hasForegroundRole_=!0,!0;var e=l.clone((new C.RoleSuggester).getRole(this.forma));return e.role!=C.InferredRoleType.Seperator&&e.role!=C.InferredRoleType.GraphicContent||!this.forma.isTypeLockup()?(this.hasForegroundRole_=!1,!1):(this.hasForegroundRole_=!0,!0)}},hasBackgroundRole:{get:function(){if(null!=this.hasBackgroundRole_)return this.hasBackgroundRole_;var e=l.clone((new C.RoleSuggester).getRole(this.forma));return e.role==C.InferredRoleType.Background&&e.confidence>.5||e.secondaryRole==C.InferredRoleType.Background&&e.secondaryConfidence>.5?(this.hasBackgroundRole_=!0,!0):(this.hasBackgroundRole_=!1,!1)}},description:{get:function(){var e,t,n="";if(e=l.as(this.forma.controller,O.TypeLockupController)){var i=l.replace(e.text.substr(0,6),"\n","");n="T: "+this.shortID+" "+i}else if(t=l.as(this.forma,D.ShapeForma)){var o,r;n="S: "+this.shortID+" ",(o=l.opt(l.as(t.contentNode,A.URLBasedContentNode),function(e){return e.mediaMetadata}))&&null!=(r=o.searchTerm)&&(n+=r)}else n=this.forma.controller instanceof f.FrameController?"I: "+this.shortID+" ":"???: "+this.shortID+" "+this.forma.controller.kind;return n+=this.frameString}}}}),o),c.VisualNodeGroup=(r=function(e,t){if(this.alignments=[],void 0===t&&(t=null),this.children=l.clone(e),this.maintainAspectRatio_=!1,c.VisualNode.call(this),null==t){if(this.frame=M.TheoRect.Zero,e.length>0){this.frame=e[0].frame;for(var n=l.iter(e);!n.done;n.next()){var i=n.value;this.frame=this.frame.unionWith(i.frame)}}}else this.frame=t;for(var o=l.iter(e);!o.done;o.next()){var r;(r=(i=o.value).parent)&&r.removeChildren([i]),i.parent=this}this.setMaintainAspectRatio()},l.defineClass({name:"VisualNodeGroup",ctor:r,superName:"VisualNode",statics:{extractNodeInfo:function(e){var t,n,i={};if(t=l.as(e,r)){i.type=l.as("Group","AnyObject"),i.frame=t.frame.encodeJson(),i.layoutStrategy=l.as(t.layoutStrategyString,"AnyObject");for(var o=[],a=l.iter(t.children);!a.done;a.next()){var s=a.value;o.push(l.clone(r.extractNodeInfo(s)))}i.children=l.as(o,"AnyObject")}return(n=l.as(e,c.VisualNodeLeaf))&&(i.type=l.as(n.forma.controller.kind,"AnyObject"),i.formaId=l.as(n.forma.formaID,"AnyObject"),i.frame=n.forma.finalFrame.encodeJson(),i.role=l.as((new C.RoleSuggester).getRole(n.forma).role,"AnyObject")),i}},props:{maintainAspectRatio:{get:function(){return this.maintainAspectRatio_},set:function(e){this.maintainAspectRatio_=e}},layoutStrategyString:{get:function(){var e;if(null!=(e=this.layoutStrategy)){if(e==c.GroupLayoutStrategy.Default)return"default";if(e==c.GroupLayoutStrategy.VerticalFlow)return"vertical";if(e==c.GroupLayoutStrategy.HorizontalFlow)return"horizontal"}return"None"}},setMaintainAspectRatio:function(){this.maintainAspectRatio_=!1;for(var e=l.iter(this.children);!e.done;e.next()){var t,n=e.value;if((t=this.frame.intersectionWith(n.frame))&&Math.abs(t.area-this.frame.area)/this.frame.area<.1)return void(this.maintainAspectRatio_=n.maintainAspectRatio)}for(var i=0,o=l.iter(this.children);!o.done;o.next()){var r;n=o.value,(r=l.as(n,c.VisualNodeLeaf))&&r.maintainAspectRatio&&(i+=1)}i==this.children.length&&this.children.length>0&&(this.maintainAspectRatio_=!0)},clone:function(){for(var e=[],t=l.iter(this.children);!t.done;t.next()){var n=t.value;e.push(n.clone())}var i=new r(l.clone(e),this.frame);i.origNode=this,i.layoutStrategy=this.layoutStrategy,i.alignments=l.clone(this.alignments),i.bgConstraint=this.bgConstraint;for(var o=l.iter(e);!o.done;o.next())(n=o.value).parent=i;return i},addChildren:function(e){for(var t={},n=[],i=l.iter(e);!i.done;i.next()){var o=i.value;n.push(o.id),t[o.id]=o}for(var r=l.iter(n);!r.done;r.next()){var a;(a=(o=t[r.value]).parent)&&a.removeChildren([o]),this.children.push(o),o.parent=this}},removeChildren:function(e){for(var t=l.iter(e);!t.done;t.next()){var n=t.value;this.children.includes(n)&&l.remove(this.children,n)}},descendents:{get:function(){for(var e=[],t=l.iter(this.children);!t.done;t.next()){var n,i=t.value;e.push(i),(n=l.as(i,r))&&(e=e.concat(n.descendents))}return e}},leafDescendents:{get:function(){for(var e=[],t=l.iter(this.children);!t.done;t.next()){var n,i,o=t.value;(n=l.as(o,c.VisualNodeLeaf))&&e.push(n),(i=l.as(o,r))&&(e=e.concat(i.leafDescendents))}return e}},filledGroup:{get:function(){for(var e=l.iter(this.leafDescendents);!e.done;e.next())if(e.value.frame.equalWithAccuracy(this.frame,1))return!0;return!1}},description:{get:function(){var e=this.bgConstraint?" bg":"";return"G: "+this.shortID+" "+this.layoutStrategyString+e+" "+this.frameString}},encodeToJson:function(){return l.clone(r.extractNodeInfo(this))}}}),r),c.VisualNodeData=(a=function(){this.formae=[],this.fontSize=[],this.opacities=[],this.colors=[],this.unionIntersections={},this.nodeDistances={},this.alignments={},this.intersections=[],this.parentContainment=[],this.childContainment=[]},l.defineClass({name:"VisualNodeData",ctor:a,props:{frame:{get:function(){return this.node.frame}},init_d79d:function(e){this.node=e},init_b16c:function(e,t,n){this.node=e,this.formae=t.formae.concat(n.formae),this.fontSize=t.fontSize.concat(n.fontSize),this.opacities=t.opacities.concat(n.opacities),this.colors=t.colors.concat(n.colors);for(var i=l.iter(t.alignments);!i.done;i.next())for(var o=i.key,r=i.value,a=l.iter(n.alignments);!a.done;a.next()){var s=a.key,c=a.value;o==s&&(this.alignments[o]=r.concat(c))}},init_ff0a:function(e,t){this.node=e;var n,i,o=e.forma;this.formae.push(o),(n=o.style.colors.fieldPrimary)&&this.colors.push(n),(n=o.style.colors.fieldSecondary)&&this.colors.push(n),this.opacities.push(o.style.opacity),(i=l.as(o.controller,O.TypeLockupController))&&this.fontSize.push(i.getCurrentFontSize());for(var r=u.AlignmentDetector.init_a05b(o),a=l.iter(r.detectFormaAlignments(u.AlignmentDetector.DISTANCE_THRESHOLD,void 0,!1));!a.done;a.next()){var s=a.value;if(l.containsEq(t,s.forma,d._equality_Forma_Forma)){var c=s.forma.formaID;null==this.alignments[c]&&(this.alignments[c]=[]),this.alignments[c].push(l.clone(s))}}},nodeIntersection:function(e,t){for(var n=[],i=l.iter(e);!i.done;i.next()){var o=i.value;t.includes(o)&&n.push(o)}return n},setPairwiseDistanceTerms:function(e){if(this.intersections=l.clone(this.nodeIntersection(l.clone(this.intersections),l.clone(e))),this.parentContainment=l.clone(this.nodeIntersection(l.clone(this.parentContainment),l.clone(e))),this.childContainment=l.clone(this.nodeIntersection(l.clone(this.childContainment),l.clone(e))),null==this.node||l.opt(this.node,function(e){return null==e.frame}))l.info("ERROR: in setPairwiseDistanceTerms");else for(var t=l.iter(e);!t.done;t.next()){var n=t.value,i=n.id;if(n!=this.node&&null==this.nodeDistances[i]){if(null!=n.inferenceData)for(var o=l.iter(n.inferenceData.formae);!o.done;o.next()){var r=o.value,a=l.clone(this.alignments[r.formaID]);null!=a&&(this.alignments[i]=l.clone(a))}if(null==n.frame)return void l.info("ERROR: in setPairwiseDistanceTerms");var s,c=n.frame;(s=c.intersectionWith(this.node.frame))&&(s.area/this.frame.area>.95?this.parentContainment.push(n):s.area/c.area>.95&&this.childContainment.push(n),this.intersections.push(n)),this.nodeDistances[i]=this.frame.L1Distance(c),this.unionIntersections[i]=[];for(var u=this.frame.unionWith(c),h=l.iter(e);!h.done;h.next()){var _=h.value;_!=n&&this.node!=_&&_.frame.intersects(u)&&this.unionIntersections[i].push(_)}}}}}}),a),c.VisualStructureDetector=(s=function(e,t){this.SPACING_REL_MERGE_THRESHOLD=.25,this.SPACING_ABS_MERGE_THRESHOLD=20,this.nodes_=[],this.pairwiseGroupScores_={};var n,i,o=this;this.parentForma_=t;for(var r=l.iter(e);!r.done;r.next()){var a=r.value,s=new c.VisualNodeLeaf(a),u=c.VisualNodeData.init_ff0a(s,l.clone(e));s.inferenceData=u,s.frame=l.opt(s.frame,function(e){return e.intersectionWith(o.parentForma_.bounds)}),null!=s.frame?this.nodes_.push(s):l.opt(p.Host.logging,function(e){return e.error(" node.frame == nil in VisualStructureDetector")})}for(var d=l.iter(this.nodes_);!d.done;d.next())(s=d.value).inferenceData.node=s,s.inferenceData.setPairwiseDistanceTerms(l.clone(this.nodes_));if(this.bgFrames_=[],(n=t.finalFrame)&&(i=l.opt(this.parentForma_.root,function(e){return e.filterWithCallback(function(e){return null!=e.controller&&e.isGridCell()})}))){for(var f=l.iter(i);!f.done;f.next()){var m;if((m=(a=f.value).finalFrame)&&n.contains(m)){var T=a.bounds.transform(a.totalPlacement.concat(t.totalPlacement.inverse));n.equal(m)&&h.CoreAssert.isTrue(t.bounds.equal(T)),this.bgFrames_.push(T)}}if(this.bgFrames_.length>0)for(var g=l.iter(l.range(0,4,!1));!g.done;g.next()){for(var R=null,E=[new S.TheoPoint(.5,0),new S.TheoPoint(0,.5),new S.TheoPoint(.5,1),new S.TheoPoint(1,.5)],P=l.iter(E);!P.done;P.next()){for(var C=P.value,D=t.bounds.eval(C),O=null,I=1/0,A=l.iter(this.bgFrames_);!A.done;A.next()){var N=(T=A.value).eval(C),v=.5==C.x?Math.abs(D.y-N.y):Math.abs(D.x-N.x);I>v&&(I=v,O=T)}if(null!=O&&I>0){var y=.5==C.x?t.bounds.horizontalLine(C.y):t.bounds.verticalLine(C.x),Y=.5==C.x?O.horizontalLine(C.y):O.verticalLine(C.x),b=M.TheoRect.boundsOfPoints([y.p1,y.p2,Y.p1,Y.p2]);(null==R||R.area<b.area)&&(R=b)}}if(null==R)break;this.bgFrames_.push(R)}}_.CoreObject.call(this)},l.defineClass({name:"VisualStructureDetector",ctor:s,superName:"CoreObject",props:{inferVisualStructure:function(){if(0==this.nodes_.length)return null;for(var e=[],t=[],n=l.iter(this.nodes_);!n.done;n.next()){var i=n.value;this.isBackgroundElement(i)?e.push(i):t.push(i)}var o=this.groupNodes(l.clone(e)),r=this.groupNodes(l.clone(t));return null==o?r:null==r?o:(o.addChildren(l.clone(r.children)),o)},groupNodes:function(e){if(0==e.length)return null;for(var t=l.clone(this.mergeNodes(l.clone(e))),n=(new c.VisualNodeGroup(l.clone(t),this.parentForma_.bounds),l.clone(this.createBackgroundGroupNodes(l.clone(t)))),i=l.iter(t);!i.done;i.next())i.value.inferenceData.setPairwiseDistanceTerms(l.clone(n));return new c.VisualNodeGroup(l.clone(n),this.parentForma_.bounds)},scoreNodeGrouping:function(e,t){var n,i,o,r={};if((n=e.inferenceData)&&(i=t.inferenceData)&&(o=l.opt(i.formae[0].parent,function(e){return e.bounds}))){var a,s=e.frame.unionWith(t.frame);if(a=n.unionIntersections[t.id]){for(var h=l.clone(n.intersections),_=l.clone(i.intersections),d=0,f=l.iter(a);!f.done;f.next()){var m=f.value;h.includes(m)||_.includes(m)||(d+=1)}r[c.PairingFeatures.UNION_NUM_NON_INTERSECT]=l.toDouble(d)}var T=l.clone(n.parentContainment),p=l.clone(i.parentContainment);n.childContainment.includes(t)?r[c.PairingFeatures.CONTAINMENT_CHILD_COUNT]=l.toDouble(n.childContainment.length-1):i.childContainment.includes(e)&&(r[c.PairingFeatures.CONTAINMENT_CHILD_COUNT]=l.toDouble(i.childContainment.length-1)),T.includes(t)&&l.remove(T,t),p.includes(e)&&l.remove(p,e);for(var g=0,E=l.iter(T.concat(p));!E.done;E.next()){var C=E.value;T.includes(C)&&p.includes(C)||(g+=1)}r[c.PairingFeatures.CONTAINMENT_MISMATCH]=g,r[c.PairingFeatures.BOUNDARY_DISTANCE]=n.nodeDistances[t.id],r[c.PairingFeatures.CENTER_DISTANCE]=n.frame.center.distanceTo(i.frame.center);var D,O=l.clone(n.alignments[t.id]),S=l.clone(i.alignments[e.id]);if(null!=O&&null!=S)for(var M=l.iter(O);!M.done;M.next())for(var A=M.value,N=l.iter(S);!N.done;N.next()){var v=N.value;A.line.type==v.line.type&&(A.line.type==u.AlignmentType.CenterX?r[c.PairingFeatures.CENTER_X_ALIGNED]=1:A.line.type==u.AlignmentType.Left?r[c.PairingFeatures.LEFT_ALIGNED]=1:A.line.type==u.AlignmentType.Right?r[c.PairingFeatures.RIGHT_ALIGNED]=1:A.line.type==u.AlignmentType.Top?r[c.PairingFeatures.TOP_ALIGNED]=1:A.line.type==u.AlignmentType.CenterY?r[c.PairingFeatures.CENTER_Y_ALIGNED]=1:A.line.type==u.AlignmentType.Bottom&&(r[c.PairingFeatures.BOTTOM_ALIGNED]=1),A.line.type==u.AlignmentType.CenterX||A.line.type==u.AlignmentType.Left||A.line.type==u.AlignmentType.Right?r[c.PairingFeatures.X_ALIGNED]=1:r[c.PairingFeatures.Y_ALIGNED]=1)}if(D=n.frame.intersectionWith(i.frame)){var y=D.area/Math.max(n.frame.area,i.frame.area);r[c.PairingFeatures.INTERSECTION]=y}for(var Y=0,b=l.iter(n.formae);!b.done;b.next()){for(var x=b.value,L=!1,F=l.iter(i.formae);!F.done;F.next())((G=F.value).isTypeLockup()&&x.isTypeLockup()||G.isGraphic()&&x.isGraphic())&&(L=!0);L||(Y=1)}for(var U=l.iter(i.formae);!U.done;U.next()){x=U.value,L=!1;for(var w=l.iter(n.formae);!w.done;w.next()){var G;((G=w.value).isTypeLockup()&&x.isTypeLockup()||G.isGraphic()&&x.isGraphic())&&(L=!0)}L||(Y=1)}r[c.PairingFeatures.TYPE_MISMATCH]=Y;for(var k=null,B=l.iter(n.colors);!B.done;B.next())for(var H=B.value,V=l.iter(i.colors);!V.done;V.next()){var W=V.value;k=null==k?H.distanceTo(W):Math.min(k,H.distanceTo(W))}r[c.PairingFeatures.COLOR_DISTANCE]=null!=k?k:0;for(var j=null,X=l.iter(n.opacities);!X.done;X.next())for(var J=X.value,z=l.iter(i.opacities);!z.done;z.next()){var K=z.value;j=null==j?Math.abs(J-K):Math.min(j,Math.abs(J-K))}r[c.PairingFeatures.OPACITY_DIFFERENCE]=null!=j?j:0;for(var Z=null,q=l.iter(n.fontSize);!q.done;q.next())for(var Q=q.value,$=l.iter(i.fontSize);!$.done;$.next()){var ee=$.value;Z=null==Z?Math.abs(Q-ee):Math.min(Z,Math.abs(Q-ee))}r[c.PairingFeatures.FONT_SIZE_DISTANCE]=null!=Z?Z:0;var te=!o.contains(n.frame)&&o.contains(i.frame)||o.contains(n.frame)&&!o.contains(i.frame);r[c.PairingFeatures.OUT_OF_BOUNDS_MISMATCH]=te?1:0;var ne=n,ie=i;n.frame.center.y>i.frame.center.y&&(ne=i,ie=n),r[c.PairingFeatures.POSITION_X_FIRST]=ne.frame.center.x/o.width,r[c.PairingFeatures.POSITION_Y_FIRST]=ne.frame.center.y/o.height,r[c.PairingFeatures.AREA_FIRST]=ne.frame.area,r[c.PairingFeatures.POSITION_X_SECOND]=ie.frame.center.x/o.width,r[c.PairingFeatures.POSITION_Y_SECOND]=ie.frame.center.y/o.height,r[c.PairingFeatures.AREA_SECOND]=ie.frame.area;for(var oe=l.iter(ne.formae);!oe.done;oe.next())(x=oe.value).isTypeLockup()?r[c.PairingFeatures.IS_TEXT_FIRST]=1:x.isShape()?r[c.PairingFeatures.IS_SHAPE_FIRST]=1:x.isImage()&&(r[c.PairingFeatures.IS_IMAGE_FIRST]=1);for(var re=l.iter(ie.formae);!re.done;re.next())(x=re.value).isTypeLockup()?r[c.PairingFeatures.IS_TEXT_SECOND]=1:x.isShape()?r[c.PairingFeatures.IS_SHAPE_SECOND]=1:x.isImage()&&(r[c.PairingFeatures.IS_IMAGE_SECOND]=1);r[c.PairingFeatures.UNION_EMPTY_SPACE]=Math.max(0,s.area-n.frame.area-i.frame.area),r[c.PairingFeatures.UNION_AREA]=s.area,r[c.PairingFeatures.UNION_POSITION_X]=s.center.x/o.height,r[c.PairingFeatures.UNION_POSITION_Y]=s.center.y/o.width,r[c.PairingFeatures.HEIGHT_DIFF]=Math.abs(n.frame.height-i.frame.height),r[c.PairingFeatures.WIDTH_DIFF]=Math.abs(n.frame.width-i.frame.width),r[c.PairingFeatures.AREA_DIFF]=Math.abs(n.frame.area-i.frame.area);for(var ae,se=[],ce=l.iter(["union_position_x","y_aligned","is_text_second","right_aligned","is_shape_first","containment_child_count","is_image_first","is_image_second","type_mismatch","position_x_second","containment_mismatch","height_diff","union_area","union_empty_space","area_first","top_aligned","area_second","bottom_aligned","center_y_aligned","center_distance","union_position_y","is_text_first","opacity_difference","intersection","out_of_bounds_mismatch","position_y_first","is_shape_second","position_x_first","width_diff","union_num_non_intersect","left_aligned","color_distance","center_x_aligned","boundary_distance","position_y_second","x_aligned","area_diff","font_size_distance"]);!ce.done;ce.next()){var le;null!=(le=r[ce.value])?se.push(le):se.push(0)}if(ae=R.MLPModel.loadNNModel("VisualGrouping")){var ue=l.clone(se),he=new I.TheoMatrix([ue]).subtract(ae.featureScalingMean).divide(ae.featureScalingStd);return{score:1-new P.NNMLPClassifier(l.clone(ae.coefficients),l.clone(ae.intercepts),ae.finalSoftmax).predict(he.transpose()).transpose().asArray[0][0],features:r}}}return{score:1/0,features:{}}},mergeWithParentIfPossible:function(e,t){var n,i,o,r;if(void 0===t&&(t=!1),(n=l.as(e,c.VisualNodeGroup))&&null!=(i=n.spacing)&&(o=n.parent)&&null!=(r=o.spacing)){if(n.layoutStrategy!=o.layoutStrategy)return;if(n.layoutStrategy==c.GroupLayoutStrategy.Default)return l.remove(o.children,n),void o.addChildren(l.clone(n.children));for(var a=[],s=l.iter(o.alignments);!s.done;s.next())for(var u=s.value,h=l.iter(n.alignments);!h.done;h.next())u==h.value&&(a.includes(u)||a.push(u));(a.length>0||!t)&&(o.alignments=l.clone(a),o.spacing=(i+r)/2,l.remove(o.children,n),o.addChildren(l.clone(n.children)))}},getNodeForForma:function(e){for(var t=l.iter(this.nodes_);!t.done;t.next()){var n=t.value;if(l.containsEq(n.inferenceData.formae,e,d._equality_Forma_Forma))return n}return null},getScoreNodeFeatures:function(e,t){return this.scoreNodeGrouping(this.getNodeForForma(e),this.getNodeForForma(t))},isBackgroundElement:function(e){var t,n;if((t=l.as(e,c.VisualNodeLeaf))&&(n=t.forma.finalFrame)){if(t.forma.isBackgroundImage())return!0;if(t.forma.isGridCell())return!0;if(n.contains(this.parentForma_.finalFrame)||t.forma.isGraphic()&&!this.parentForma_.finalFrame.contains(n.insetRel(.1,.1,.1,.1)))return!0;var i;if(i=l.as(t.forma.controller,O.TypeLockupController)){var o=i.getAverageFontSize();return 1==i.text.length&&o>1e3}return t.hasBackgroundRole}return!1},nodesMergeable:function(e,t){return this.isBackgroundElement(e)!=this.isBackgroundElement(t)},getPairwiseScore:function(e,t){var n,i=e.id+t.id;if(null!=(n=this.pairwiseGroupScores_[i]))return n;var o=this.scoreNodeGrouping(e,t);return this.pairwiseGroupScores_[i]=o.score,o.score},scoreVisualGroupMerge:function(e,t,n){if(e==t)return h.CoreAssert.fail("probably an error if we're trying to merge something with outself"),1;var i,o;if((i=l.as(e,c.VisualNodeLeaf))&&(o=l.as(t,c.VisualNodeLeaf)))return this.getPairwiseScore(i,o);var r,a=[e];(r=l.as(e,c.VisualNodeGroup))&&(a=l.clone(r.children));var s,u=[t];(s=l.as(t,c.VisualNodeGroup))&&(u=l.clone(s.children));for(var _=0,d=l.iter(a);!d.done;d.next())for(var f=d.value,m=l.iter(u);!m.done;m.next()){var T=m.value;_=Math.max(_,this.scoreVisualGroupMerge(f,T,l.clone(n)))}for(var p=l.iter(n);!p.done;p.next()){var g=p.value;if(g!=e&&g!=t){var R=e.frame.unionWith(t.frame).intersectionWith(g.frame);if(!e.frame.intersects(g.frame)&&!t.frame.intersects(g.frame)&&null!=R&&R.area/g.frame.area>.25)return 0}}return _},scoreRegionMerge:function(e,t,n,i){void 0===i&&(i=0);var o=e.frame.yDistance(t.frame,!1),r=e.frame.xDistance(t.frame,!1);if(o>0&&r>0)return-1/0;for(var a=l.iter(n);!a.done;a.next()){var s,u=a.value;if(u!=e&&u!=t&&(s=e.frame.unionWith(t.frame).intersectionWith(u.frame))&&s.area/u.frame.area>.1)return-1/0}if(o<i&&r<i)return-1/0;var h=r<o,_=Math.max(o,r),d=Math.max(-1*Math.min(o,r),0);if(_>200)return-1/0;for(var f=d/(h?Math.max(e.frame.width,t.frame.width):Math.max(e.frame.height,t.frame.height)),m=_/Math.max(this.parentForma_.bounds.width,this.parentForma_.bounds.height),T=0,p=l.iter([e,t]);!p.done;p.next()){var g,R=p.value;(g=l.as(R,c.VisualNodeGroup))&&(g.layoutStrategy==c.GroupLayoutStrategy.VerticalFlow&&h&&(T+=1),g.layoutStrategy!=c.GroupLayoutStrategy.HorizontalFlow||h||(T+=1))}var E,P,C=h?M.TheoRect.ONE_BY_ONE.scaleXY(1e3,1):M.TheoRect.ONE_BY_ONE.scaleXY(1,1e3),D=.5*(1-C.similarity(e.frame))+.5*(1-C.similarity(t.frame));return(E=this.getBackgroundFrame(e))&&(P=this.getBackgroundFrame(t))&&(f=d/(h?Math.min(e.frame.width,t.frame.width):Math.min(e.frame.height,t.frame.height)),!E.equal(P)&&f<.9)?0:.5+(f+10*(1-m)+.1*T+.5*D)},getContainingGraphicNode:function(e,t){for(var n=l.iter(t);!n.done;n.next()){var i,o=n.value;if((i=l.as(o,c.VisualNodeLeaf))&&i.forma.isGraphic()&&i.frame.contains(e.frame))return i}return null},createBackgroundGroupNodes:function(e){for(var t=[],n=l.iter(e);!n.done;n.next()){var i=n.value,o=l.as(i,c.VisualNodeLeaf),r=l.as(i,c.VisualNodeGroup),a=this.getBackgroundFrame(i),s=null!=a&&a.equal(this.parentForma_.bounds);if(null!=o||null!=r&&r.filledGroup||!s){var u=i.parent,h=new c.VisualNodeGroup([i]);if(l.opt(u,function(e){return e.addChildren([h])}),t.push(h),h.layoutStrategy=c.GroupLayoutStrategy.Default,null!=o){var _=c.VisualNodeData.init_ff0a(o,[o.forma]);h.inferenceData=_}else h.inferenceData=i.inferenceData;s||(h.frame=a,h.bgConstraint=!0)}else t.push(i)}return t=l.sort(t,function(e,t){return e.frame.center.y<t.frame.center.y})},mergeNodes:function(e){for(var t=this,n=l.clone(e),i=l.iter(n);!i.done;i.next()){var o=i.value;l.opt(o.inferenceData,function(e){return e.setPairwiseDistanceTerms(l.clone(n))})}for(var r=0,a=l.iter([!0,!1]);!a.done;a.next())for(var s=a.value,u=l.iter([!0,!1]);!u.done;u.next())for(var h=u.value;n.length>1||r>100;){r+=1;for(var _=0,d=null,f=l.iter(l.range(0,n.length,!1));!f.done;f.next())for(var m=f.value,T=l.sort(n,function(e,t){return e.frame.L1Distance(n[m].frame)<t.frame.L1Distance(n[m].frame)}),p=l.iter(l.range(0,Math.min(5,T.length),!1));!p.done;p.next()){var g=p.value;if(n[m]!=T[g]){if(h){var R=this.getContainingGraphicNode(n[m],l.clone(e)),P=this.getContainingGraphicNode(T[g],l.clone(e));if(R==T[g]||P==n[m])continue;if(null!=R&&R!=P||null!=P&&R!=P)continue}var C=s?this.scoreVisualGroupMerge(n[m],T[g],l.clone(n)):this.scoreRegionMerge(n[m],T[g],l.clone(n));C>.5&&C>_&&(d={nodeA:n[m],nodeB:T[g]},_=C)}}if(null==d)break;var D=new c.VisualNodeGroup([d.nodeA,d.nodeB]);D.frame=l.opt(D.frame,function(e){return e.intersectionWith(t.parentForma_.bounds)});var O=-1*E.MathUtils.minDouble(d.nodeA.frame.maxX-d.nodeB.frame.minX,d.nodeB.frame.maxX-d.nodeA.frame.minX),I=-1*E.MathUtils.minDouble(d.nodeA.frame.maxY-d.nodeB.frame.minY,d.nodeB.frame.maxY-d.nodeA.frame.minY);D.layoutStrategy=O<0&&I>=0?c.GroupLayoutStrategy.VerticalFlow:I<0&&O>=0?c.GroupLayoutStrategy.HorizontalFlow:c.GroupLayoutStrategy.Default,D.bgConstraint=d.nodeA.bgConstraint&&d.nodeB.bgConstraint;var S,M,A=l.clone(l.opt(d.nodeA.inferenceData,function(e){return e.alignments[d.nodeB.id]}));if(null!=A){var N=l.sort(A,function(e,t){return e.offset.length()<t.offset.length()});D.alignments.includes(N[0].line.type)||D.alignments.push(N[0].line.type)}if(D.spacing=d.nodeA.frame.L1Distance(d.nodeB.frame),(S=d.nodeA.inferenceData)&&(M=d.nodeB.inferenceData)){var v=c.VisualNodeData.init_b16c(D,S,M);D.inferenceData=v,s&&(D.spacing=l.opt(d.nodeA.inferenceData,function(e){return e.nodeDistances[d.nodeB.id]}))}n.push(D),this.mergeWithParentIfPossible(d.nodeA,!1),this.mergeWithParentIfPossible(d.nodeB,!1),l.remove(n,d.nodeA),l.remove(n,d.nodeB);for(var y=l.iter(n);!y.done;y.next())o=y.value,l.opt(o.inferenceData,function(e){return e.setPairwiseDistanceTerms(l.clone(n))})}return n},getBackgroundFrame:function(e){if(!this.parentForma_.bounds.contains(e.frame))return null;var t,n=[];(t=l.as(e,c.VisualNodeGroup))?n=l.clone(t.leafDescendents):(r=l.as(e,c.VisualNodeLeaf))&&(n=[r]);for(var i=null,o=l.iter(n);!o.done;o.next()){var r,a,s,u=(r=o.value).frame;(a=l.as(r.forma.controller,O.TypeLockupController))&&null!=(s=l.opt(a.lockupStyle,function(e){return e.backing}))&&(s!=g.LockupBacking.BannerHorizontal&&s!=g.LockupBacking.BannerVertical&&s!=g.LockupBacking.Banner||(u=l.opt(l.as(r.forma,m.GroupForma),function(e){return e.childrenFrame})));var h,_=!1;if(h=u)for(var d=l.iter(this.bgFrames_);!d.done;d.next()){var f=d.value;f.contains(h)&&(_=!0,i=l.opt(i,function(e){return e.unionWith(f)})||f)}_||(i=this.parentForma_.bounds)}return i||this.parentForma_.bounds}}}),s)},313:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(420),c=n(236);o.GroupContentNode=(i=function(e,t){this.children_=[],c.ContentNode.call(this,e,t)},r.defineClass({name:"GroupContentNode",ctor:i,superName:"ContentNode",statics:{KIND:{get:function(){return"group"}},_implements:function(e){return"TheoMessagePublisher"==e}},props:{nodeByID:function(e){if(e==this.id)return this;for(var t=r.iter(this.children_);!t.done;t.next()){var n=t.value;if(null!=n.nodeByID(e))return n}return null},nodeWithTag:function(e,t){if(this.getTag(e)==t)return this;for(var n=r.iter(this.children_);!n.done;n.next()){var i=n.value;if(null!=i.nodeWithTag(e,t))return i}return null},insertChildrenAt:function(e,t){for(var n=e,i=r.iter(t);!i.done;i.next())null!=(c=i.value).parent&&(a.CoreAssert.isTrue(c.parent!=this,"attempting to insert a child that is already a child"),c.parent.removeChild(c));for(var o=r.iter(t);!o.done;o.next()){var c;(c=o.value).parent=this,this.children_.splice(n,0,c)}this.publish(new s.InsertedContentChildrenMessage(this,e,r.clone(t)))},removeChildrenAt:function(e,t){if(e<0||t<0||e+t>this.children_.length)a.CoreAssert.fail("removeChildrenAt: invalid index and/or count");else{for(var n=r.clone(this.children_.splice(e,t)),i=r.iter(n);!i.done;i.next())i.value.parent=null;this.publish(new s.RemovedContentChildrenMessage(this,e,r.clone(n)))}},appendChild:function(e){this.insertChildrenAt(this.children_.length,[e])},insertChild:function(e,t){this.insertChildrenAt(e,[t])},removeChild:function(e){var t;a.CoreAssert.isTrue(e.parent==this),e.parent==this&&null!=(t=r.indexOf(this.children_,e))&&this.removeChildrenAt(t,1)},removeChildAt:function(e){a.CoreAssert.isTrue(e>=0&&e<this.children_.length),this.removeChildrenAt(e,1)},removeAllChildren:function(){this.removeChildrenAt(0,this.children_.length)},childAt:function(e){return a.CoreAssert.isTrue(e>=0&&e<this.children_.length),this.children_[e]},childCount:{get:function(){return this.children_.length}},forEachChild:function(e){for(var t=r.iter(this.children_);!t.done;t.next())e(t.value)},visit:function(e){if(e(this))return this;for(var t=r.iter(this.children_);!t.done;t.next()){var n=t.value;if(e(n))return n}return null},decode:function(e){var t=this;c.ContentNode.prototype.decode.call(this,e),this.removeAllChildren();var n=[];e.forEachChild(function(e,i){var o=t.document.decodeNode(e);null==o?a.CoreAssert.warning("GroupContentNode.decode: Could not instantiate child node"):n.push(o)}),this.insertChildrenAt(0,r.clone(n))},postDecode:function(){for(var e=r.iter(this.children_);!e.done;e.next())e.value.postDecode()},encode:function(e){c.ContentNode.prototype.encode.call(this,e);for(var t=r.iter(this.children_);!t.done;t.next()){var n=t.value;n.encode(e.appendChild(n.uuid))}}}}),i)},314:function(e,t,n){var i,o=t,r=n(0),a=n(423),s=n(22);o.PROPERTY_COLOR="color",o.SimpleSwatch=(i=function(e,t){a.ColorSwatch.call(this,e,t)},r.defineClass({name:"SimpleSwatch",ctor:i,superName:"ColorSwatch",statics:{KIND:{get:function(){return"simple"}}},props:{color:{get:function(){return this.color_},set:function(e){this.color_=e}},match:function(e){var t=r.as(e,i);null!=t&&(this.color=t.color_),a.ColorSwatch.prototype.match.call(this,e)},solidRepresentation:{get:function(){return this.color_}},decode:function(e){a.ColorSwatch.prototype.decode.call(this,e),this.color_=s.SolidColor.decodeJson(e.property(o.PROPERTY_COLOR))},encode:function(e){a.ColorSwatch.prototype.encode.call(this,e),null!=this.color_&&e.setProperty(o.PROPERTY_COLOR,this.color_.encodeJson())}}}),i)},357:function(e,t,n){var i,o=t,r=n(0),a=n(4);o.MoaConstants=(i=function(){a.CoreObject.call(this)},r.defineClass({name:"MoaConstants",ctor:i,superName:"CoreObject",statics:{kMoaColorMapSizeRGB:256,kSatVibranceSumMax:150}}),i)},419:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(313),c=n(56),l=n(150),u=n(195),h=n(193),_=n(151),d=n(88),f=n(153);o.ContentDocument=(i=function(e){this.factory_={},this.uuid_=c.GUIDUtils.makeGUID(),this.parent_=e,_.TheoDOMPublishingElement.call(this),this.factory_[u.RootContentNode.KIND]=function(e,t){return new u.RootContentNode(e,t)},this.factory_[s.GroupContentNode.KIND]=function(e,t){return new s.GroupContentNode(e,t)},this.factory_[l.ImageContentNode.KIND]=function(e,t){return new l.ImageContentNode(e,t)},this.factory_[d.VectorContentNode.KIND]=function(e,t){return new d.VectorContentNode(e,t)},this.factory_[h.TextContentNode.KIND]=function(e,t){return new h.TextContentNode(e,t)},this.factory_[f.VideoContentNode.KIND]=function(e,t){return new f.VideoContentNode(e,t)},this.root_=new u.RootContentNode(this,u.RootContentNode.KIND)},r.defineClass({name:"ContentDocument",ctor:i,superName:"TheoDOMPublishingElement",statics:{DCXTYPE:{get:function(){return"application/vnd.adobe.theo.content+dcx"}},PATH:{get:function(){return"content"}},_implements:function(e){return"TheoMessagePublisher"==e}},props:{uuid:{get:function(){return this.uuid_},set:function(e){this.uuid_=e}},parent:{get:function(){return this.parent_},set:function(e){this.parent_=e}},root:{get:function(){return this.root_}},nodeByID:function(e){return this.root.nodeByID(e)},nodeWithTag:function(e,t){return this.root.nodeWithTag(e,t)},publishForChild:function(e){this.publish(e)},createNode:function(e){var t=this.factory_[e];return null==t?(a.CoreAssert.warning("Could not instantiate a contentnode of kind "+e+": no factory"),null):t(this,e)},decodeNode:function(e){var t=this.createNode(e.stringProperty("kind",""));return null!=t&&t.decode(e),t},decode:function(e){var t=this;this.uuid_=e.id,e.forEachChild(function(e,n){var i=t.decodeNode(e);a.CoreAssert.isTrue(null!=i&&i instanceof u.RootContentNode),t.root_=r.as(i,u.RootContentNode)})},encode:function(e){e.setType(i.DCXTYPE),e.setPath(i.PATH),this.root.encode(e.appendChild(this.root.uuid))},postDecode:function(){this.root.postDecode()}}}),i)},420:function(e,t,n){var i,o,r=t,a=n(0),s=n(50);r.InsertedContentChildrenMessage=(i=function(e,t,n){this.index=t,this.children=a.clone(n),s.TheoMessage.call(this,i.TYPE,e)},a.defineClass({name:"InsertedContentChildrenMessage",ctor:i,superName:"TheoMessage",statics:{TYPE:{get:function(){return"InsertedContentChildrenMessage"}}}}),i),r.RemovedContentChildrenMessage=(o=function(e,t,n){this.index=t,this.removed=a.clone(n),s.TheoMessage.call(this,o.TYPE,e)},a.defineClass({name:"RemovedContentChildrenMessage",ctor:o,superName:"TheoMessage",statics:{TYPE:{get:function(){return"RemovedContentChildrenMessage"}}}}),o)},421:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(422),c=n(56),l=n(314),u=n(151);o.ColorThemeDocument=(i=function(e){this.swatches_=[],this.factory_={},this.uuid_=c.GUIDUtils.makeGUID(),this.parent_=e,this.factory_[l.SimpleSwatch.KIND]=function(e,t){return new l.SimpleSwatch(e,t)},u.TheoDOMPublishingElement.call(this)},r.defineClass({name:"ColorThemeDocument",ctor:i,superName:"TheoDOMPublishingElement",statics:{DCXTYPE:{get:function(){return"application/vnd.adobe.theo.color+dcx"}},PATH:{get:function(){return"colortheme"}},_implements:function(e){return"TheoMessagePublisher"==e}},props:{uuid:{get:function(){return this.uuid_}},parent:{get:function(){return this.parent_},set:function(e){this.parent_=e}},swatchByID:function(e){for(var t=r.iter(this.swatches_);!t.done;t.next()){var n=t.value;if(n.id==e)return n}return null},swatchByTag:function(e,t){for(var n=r.iter(this.swatches_);!n.done;n.next()){var i=n.value;if(i.tag(e)==t)return i}return null},swatchesByTag:function(e){for(var t=[],n=r.iter(this.swatches_);!n.done;n.next()){var i=n.value;null!=i.tag(e)&&t.push(i)}return t},createSwatch:function(e){var t=this.factory_[e];return null==t?(a.CoreAssert.fail("ColorThemeDocument: Did not find a constructor for "+e),null):t(this,e)},decodeSwatch:function(e){var t=e.stringProperty("kind",""),n=this.createSwatch(t);return null==n?null:(n.decode(e),n)},appendSwatch:function(e){return r.opt(this.insertSwatchesAt(this.swatches_.length,[e]),function(e){return e[0]})},insertSwatch:function(e,t){return r.opt(this.insertSwatchesAt(e,[t]),function(e){return e[0]})},removeSwatch:function(e){var t;return null!=(t=r.indexOf(this.swatches_,e))?r.opt(this.removeSwatchesAt(t,1),function(e){return e[0]}):null},removeSwatchAt:function(e){return r.opt(this.removeSwatchesAt(e,1),function(e){return e[0]})},removeAllSwatches:function(){return this.removeSwatchesAt(0,this.swatches_.length)},replaceAllSwatches:function(e){if(this.swatches_==e)return this.swatches_;var t=r.clone(this.swatches_);return this.swatches_=r.clone(e),this.publish(new s.ReplacedSwatchesMessage(this,r.clone(e))),t},replaceWithDocument:function(e){for(var t=[],n=r.iter(e.copySwatches());!n.done;n.next()){var i=n.value;this.createSwatch(i.kind).match(i),t.push(i)}this.replaceAllSwatches(r.clone(t))},copySwatches:function(){return this.swatches_.concat()},insertSwatchesAt:function(e,t){if(e<0||e>this.swatches_.length)return a.CoreAssert.fail("insertSwatchesAt: "+e+" is out of range 0, "+this.swatches_.length),null;for(var n=e,i=r.iter(t);!i.done;i.next()){var o=i.value;if(o.ownerDocument!=this)return a.CoreAssert.fail("inserting swatch from different color theme document"),null;this.swatches_.splice(n,0,o),n+=1}return this.publish(new s.InsertedSwatchesMessage(this,e,r.clone(t))),t},removeSwatchesAt:function(e,t){if(e<0||e+t>this.swatches_.length)return a.CoreAssert.fail("removeSwatchesAt: "+e+","+t+" is out of range 0, "+this.swatches_.length),null;var n=r.clone(this.swatches_.splice(e,t));return this.publish(new s.RemovedSwatchesMessage(this,e,r.clone(n))),n},swatchAt:function(e){return e<0||e>=this.swatches_.length?null:this.swatches_[e]},swatchCount:{get:function(){return this.swatches_.length}},publishForChild:function(e){this.publish(e)},addColorWithTag:function(e,t,n){var i=this.createSwatch(l.SimpleSwatch.KIND);return i.setTag(t,n),i.color=e,this.appendSwatch(i)},encode:function(e){e.setType(i.DCXTYPE),e.setPath(i.PATH);for(var t=r.iter(this.swatches_);!t.done;t.next()){var n=t.value;n.encode(e.appendChild(n.uuid))}},decode:function(e){var t,n=this;this.uuid_=(t=e.id)||null!=t?t:"",this.swatches_=[],e.forEachChild(function(e,t){var i=n.decodeSwatch(e);null!=i&&n.swatches_.push(i)})},postDecode:function(){for(var e=r.iter(this.swatches_);!e.done;e.next())e.value.postDecode()}}}),i)},422:function(e,t,n){var i,o,r,a=t,s=n(0),c=n(50);a.InsertedSwatchesMessage=(i=function(e,t,n){this.index=t,this.swatches=s.clone(n),c.TheoMessage.call(this,i.TYPE,e)},s.defineClass({name:"InsertedSwatchesMessage",ctor:i,superName:"TheoMessage",statics:{TYPE:{get:function(){return"InsertedSwatchesMessage"}}}}),i),a.RemovedSwatchesMessage=(o=function(e,t,n){this.index=t,this.swatches=s.clone(n),c.TheoMessage.call(this,o.TYPE,e)},s.defineClass({name:"RemovedSwatchesMessage",ctor:o,superName:"TheoMessage",statics:{TYPE:{get:function(){return"RemovedSwatchesMessage"}}}}),o),a.ReplacedSwatchesMessage=(r=function(e,t){this.oldSwatches=s.clone(t),c.TheoMessage.call(this,r.TYPE,e)},s.defineClass({name:"ReplacedSwatchesMessage",ctor:r,superName:"TheoMessage",statics:{TYPE:{get:function(){return"ReplacedSwatchesMessage"}}}}),r)},423:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(56),c=n(191);o.ColorSwatch=(i=function(e,t){this.tags_={},this.uuid_=s.GUIDUtils.makeGUID(),this.id_=s.GUIDUtils.makeGUID(),this.ownerDocument=e,this.kind=t,c.TheoDOMElement.call(this)},r.defineClass({name:"ColorSwatch",ctor:i,superName:"TheoDOMElement",props:{uuid:{get:function(){return this.uuid_}},id:{get:function(){return this.id_}},tags:{get:function(){for(var e=[],t=r.iter(this.tags_);!t.done;t.next()){var n=t.key;e.push(n)}return e}},tag:function(e){return this.tags_[e]},contains:function(e){return null==this.tags_[e]},clearTags:function(){this.tags_={}},match:function(e){this.clearTags();for(var t=r.iter(e.tags);!t.done;t.next()){var n=t.value;this.setTag(n,e.tag(n))}},setTag:function(e,t){null==t?r.removeKey(this.tags_,e):this.tags_[e]=t},publish:function(e){this.ownerDocument.publishForChild(e)},solidRepresentation:{get:function(){return a.CoreAssert.isTrue(!1,"stub"),null}},decode:function(e){this.uuid_=e.id,this.id_=e.path,this.tags_={};for(var t=r.toInt(e.numberProperty("numTags",0)),n=r.iter(r.range(0,t,!1));!n.done;n.next()){var i=n.value,o=e.stringProperty("key-"+r.toString(i),""),a=e.stringProperty("value-"+r.toString(i),"");this.tags_[o]=a}},postDecode:function(){},encode:function(e){e.setStringProperty("kind",this.kind),e.setPath(this.id_),e.setNumberProperty("numTags",r.toDouble(r.count(this.tags_)));for(var t=0,n=r.iter(this.tags_);!n.done;n.next()){var i=n.key,o=n.value;e.setStringProperty("key-"+r.toString(t),i),e.setStringProperty("value-"+r.toString(t),o),t+=1}}}}),i)},424:function(e,t,n){var i,o,r,a=t,s=n(0),c=n(1);a.IDatabase=s.defineProtocol("IDatabase",{beginTransaction:"(String) -> ITransaction",endTransaction:"(ITransaction) -> Void",addListener:"(IDatabaseListener) -> Void",removeListener:"(IDatabaseListener) -> Void"}),a.IDatabaseListener=s.defineProtocol("IDatabaseListener",{onBeginTransaction:"(IDatabase, ITransaction) -> Void",onEndTransaction:"(IDatabase, ITransaction) -> Void"}),a.PostDBTransaction=(i=function(e,t,n){this.name=n,this.parent=t,this.parentDB_=e},s.defineClass({name:"PostDBTransaction",ctor:i,statics:{_implements:function(e){return"ITransaction"==e}},props:{end:function(){this.parentDB_.endTransaction(this)},rollback:function(){this.parentDB_.endTransaction(this)}}}),i),a.WeakListener=(o=function(){},s.defineClass({name:"WeakListener",ctor:o,props:{init_cbb0:function(e,t){this.listener_=e,this.db_=t},onBeginTransaction:function(e){var t=this;null!=this.db_&&s.opt(this.listener_,function(n){return n.onBeginTransaction(t.db_,e)})},onEndTransaction:function(e){var t=this;null!=this.db_&&s.opt(this.listener_,function(n){return n.onEndTransaction(t.db_,e)})},init_implicit:function(e,t){this.listener_=e,this.db_=t},clone:function(){return o.init_implicit(this.listener_,this.db_)}}}),o),a.PostDB=(r=function(){this.transactions_=[],this.listeners_=[]},s.defineClass({name:"PostDB",ctor:r,statics:{_implements:function(e){return"IDatabase"==e}},props:{beginTransaction:function(e){var t=new a.PostDBTransaction(this,s.last(this.transactions_),e);c.CoreAssert.info("Transaction BEGIN @"+this.transactions_.length+": "+e),this.transactions_.push(t);for(var n=s.iter(this.listeners_);!n.done;n.next())n.value.onBeginTransaction(t);return t},endTransaction:function(e){var t=this.transactions_.pop();c.CoreAssert.isTrue(e===t);for(var n=s.iter(this.listeners_);!n.done;n.next())n.value.onEndTransaction(t);c.CoreAssert.info("Transaction END @"+this.transactions_.length+": "+e.name)},addListener:function(e){this.removeListener(e),this.listeners_.push(s.clone(a.WeakListener.init_cbb0(e,this)))},removeListener:function(e){this.listeners_=this.listeners_.filter(function(t){return null!=t.listener_&&t.listener_!==e},this)}}}),r)},482:function(e,t,n){var i,o,r=t,a=n(0),s=n(1),c=n(62);r.FormaAnimationFactory=(i=function(){this.lookup_={},this.lookup_[c.FormaAnimation.KIND]=function(){return c.FormaAnimation.createDefault()}},o={},a.defineClass({name:"FormaAnimationFactory",ctor:i,superName:"CoreObject",statics:{instance:{get:function(){return void 0===o.instance&&(o.instance=new i),o.instance}}},props:{create:function(e){var t;return null!=(t=this.lookup_[e])?t():(s.CoreAssert.warning("no constructor for forma style kind = "+e),null)}}}),i)},501:function(e,t,n){var i,o,r,a=t,s=n(0),c=n(50);a.ITransaction=s.defineProtocol("ITransaction",{name:"String",parent:"ITransaction",end:"() -> Void",rollback:"() -> Void"}),a.TransactionMessage=(i=function(e,t,n){this.transaction=e,c.TheoMessage.call(this,t,n)},s.defineClass({name:"TransactionMessage",ctor:i,superName:"TheoMessage"}),i),a.TransactionBegunMessage=(o=function(e,t){a.TransactionMessage.call(this,e,o.TYPE,t)},s.defineClass({name:"TransactionBegunMessage",ctor:o,superName:"TransactionMessage",statics:{TYPE:"DatabaseTransactionBegunMessage"}}),o),a.TransactionEndedMessage=(r=function(e,t){a.TransactionMessage.call(this,e,r.TYPE,t)},s.defineClass({name:"TransactionEndedMessage",ctor:r,superName:"TransactionMessage",statics:{TYPE:"DatabaseTransactionEndedMessage"}}),r)},502:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(4);o.TheoDocumentData=(i=function(){this._data={},s.CoreObject.call(this)},r.defineClass({name:"TheoDocumentData",ctor:i,superName:"CoreObject",statics:{decode:function(e){var t,n=new i;if(t=r.as(e,["Dictionary","String","Any"])){var o,a=r.clone(t);(o=r.as(t.shareData,["Dictionary","String","Any"]))&&(a.shareData=r.clone(o)),n._data=a}return n}},props:{hasBeenPublished:{get:function(){return null!=this._data.shareData}},listed:{get:function(){var e;return null!=(e=r.as(r.opt(r.as(this._data.shareData,["Dictionary","String","Any"]),function(e){return e.scope}),"String"))&&(a.CoreAssert.isTrue("public"==e||"private"==e),"public"==e)},set:function(e){var t;(t=r.as(this._data.shareData,["Dictionary","String","Any"]))?t.scope=e?"public":"private":((t={}).scope=e?"public":"private",this._data.shareData=t)}},encode:function(){return this._data}}}),i)},512:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(4),c=n(10),l=n(28);o.PROPERTY_ID="id",o.PROPERTY_IMAGE="image",o.PROPERTY_NAME="name",o.PROPERTY_SIZE="size",o.PROPERTY_EDITING_RESOLUTION="editing-resolution",o.PROPERTY_PUBLISH_RESOLUTION="publish-resolution",o.PROPERTY_URI="uri",o.PROPERTY_LOCKUP_STRINGS="lockup-strings",o.PROPERTY_FOCUS="focus",o.PROPERTY_NUM_IMAGES="num-images",o.PROPERTY_NUM_SHAPES="num-shapes",o.PROPERTY_EDGE_MAP="edges",o.PROPERTY_LAYOUT_ID="layout-id",o.PROPERTY_NUM_GRID_CELLS="num-grids-cells",o.PROPERTY_VISUAL_GROUP_INFO="visual-group-info",o.PROPERTY_TEXT_ROLES="text-roles",o.PROPERTY_SHAPE_ROLES="shape-roles",o.PROPERTY_SALIENT_COVERAGE="salient-coverage",o.PROPERTY_NUM_MOVEABLE="num-moveable",o.PROPERTY_NUM_GIFS="gifs-count",o.PROPERTY_CP_DOCID="cpId",o.PROPERTY_PREVIEW_URL="previewUrl",o.PROPERTY_MANIFEST_URL="manifestUrl",o.RetargetDocumentExemplar=(i=function(e,t,n,i,o,a,c,l,u,h,_,d,f,m,T,p,g,R,E,P,C,D,O){this.id=e,this.cpId=n,this.previewUrl=i,this.manifestUrl=o,this.uri=h,this.name=t,this.size=a,this.editingResolution=c,this.publishResolution=l,this.image=u,this.lockupStrings=r.clone(_),this.focus=d,this.numImages=f,this.edgeMap=r.clone(m),this.layoutID=T,this.numGridCells=p,this.numMoveable=g,this.numShapes=R,this.visualGroupInfo=r.clone(E),this.textRoles=r.clone(P),this.shapeRoles=r.clone(C),this.salientCoverage=D,this.gifsCount=O,s.CoreObject.call(this)},r.defineClass({name:"RetargetDocumentExemplar",ctor:i,superName:"CoreObject",statics:{decodeJson:function(e){var t,n,s,u,h,_,d,f,m,T,p,g,R,E,P;if(null==e);else if(P=r.as(e,["Dictionary","String","Any"])){var C;if(null!=(C=r.as(P[o.PROPERTY_ID],"String"))){var D,O=P[o.PROPERTY_EDGE_MAP];null!=O&&null!=(N=r.clone(r.as(O,["Array","Double"])))&&(D=r.clone(N));var I=[],S=P[o.PROPERTY_LOCKUP_STRINGS];null!=S&&(N=r.as(S,["Array","String"]))&&r.append(I,N);var M=[],A=P[o.PROPERTY_TEXT_ROLES];null!=A&&(N=r.as(A,["Array","String"]))&&r.append(M,N);var N,v=[],y=P[o.PROPERTY_SHAPE_ROLES];null!=y&&(N=r.as(y,["Array","String"]))&&r.append(v,N);var Y=r.clone(P[o.PROPERTY_VISUAL_GROUP_INFO]),b=r.as(P[o.PROPERTY_FOCUS],"AnyObject"),x=null!=b?b.length:0;return new i(C,(t=r.as(P[o.PROPERTY_NAME],"String"))||null!=t?t:"",(n=r.as(P[o.PROPERTY_CP_DOCID],"String"))||null!=n?n:"",(s=r.as(P[o.PROPERTY_PREVIEW_URL],"String"))||null!=s?s:"",(u=r.as(P[o.PROPERTY_MANIFEST_URL],"String"))||null!=u?u:"",l.TheoSize.decodeJson(r.as(P[o.PROPERTY_SIZE],"AnyObject"))||l.TheoSize.Zero,(h=r.as(P[o.PROPERTY_EDITING_RESOLUTION],"Double"))||null!=h?h:1,(_=r.as(P[o.PROPERTY_PUBLISH_RESOLUTION],"Double"))||null!=_?_:1,(d=r.as(P[o.PROPERTY_IMAGE],"String"))||null!=d?d:"",(f=r.as(P[o.PROPERTY_URI],"String"))||null!=f?f:"",r.clone(I),null!=b&&x>0?c.TheoRect.decodeJson(b):null,(m=r.as(P[o.PROPERTY_NUM_IMAGES],"Double"))||null!=m?m:1,r.clone(D),(T=r.as(P[o.PROPERTY_LAYOUT_ID],"String"))||null!=T?T:"",(p=r.as(P[o.PROPERTY_NUM_GRID_CELLS],"Double"))||null!=p?p:0,r.toDouble(I.length),(g=r.as(P[o.PROPERTY_NUM_SHAPES],"Double"))||null!=g?g:0,r.clone(null!=Y?Y:{}),r.clone(M),r.clone(v),(R=r.as(P[o.PROPERTY_SALIENT_COVERAGE],"Double"))||null!=R?R:0,(E=r.as(P[o.PROPERTY_NUM_GIFS],"Double"))||null!=E?E:0)}}else a.CoreAssert.isTrue(!1,"decodeJson: not a dictionary");return null}},props:{editingSize:{get:function(){return this.size.multiply(this.editingResolution)}},publishSize:{get:function(){return this.size.multiply(this.publishResolution)}},encodeJson:function(){var e={};return e[o.PROPERTY_ID]=this.id,e[o.PROPERTY_NAME]=this.name,e[o.PROPERTY_CP_DOCID]=this.cpId,e[o.PROPERTY_PREVIEW_URL]=this.previewUrl,e[o.PROPERTY_MANIFEST_URL]=this.manifestUrl,e[o.PROPERTY_SIZE]=this.size.encodeJson(),e[o.PROPERTY_PUBLISH_RESOLUTION]=this.publishResolution,e[o.PROPERTY_IMAGE]=this.image,e[o.PROPERTY_URI]=this.uri,e[o.PROPERTY_LOCKUP_STRINGS]=r.clone(this.lockupStrings),null!=this.focus&&(e[o.PROPERTY_FOCUS]=this.focus.encodeJson()),e[o.PROPERTY_NUM_IMAGES]=this.numImages,e[o.PROPERTY_LAYOUT_ID]=this.layoutID,e[o.PROPERTY_NUM_GRID_CELLS]=this.numGridCells,e[o.PROPERTY_NUM_MOVEABLE]=this.numMoveable,e[o.PROPERTY_NUM_SHAPES]=this.numShapes,e[o.PROPERTY_VISUAL_GROUP_INFO]=r.clone(this.visualGroupInfo),e[o.PROPERTY_TEXT_ROLES]=r.clone(this.textRoles),e[o.PROPERTY_SHAPE_ROLES]=r.clone(this.shapeRoles),e[o.PROPERTY_SALIENT_COVERAGE]=this.salientCoverage,e[o.PROPERTY_NUM_GIFS]=this.gifsCount,e}}}),i)},515:function(e,t,n){var i,o=t,r=n(0),a=n(4),s=n(357);o.MoaColorMap=(i=function(){a.CoreObject.call(this)},r.defineClass({name:"MoaColorMap",ctor:i,superName:"CoreObject",statics:{createIdentityColorMap:function(){for(var e=[],t=r.iter(r.range(0,s.MoaConstants.kMoaColorMapSizeRGB,!1));!t.done;t.next()){var n=t.value;e.push(r.toDouble(n))}return e},createBrightnessColorMap:function(e){var t=Math.max(-100,Math.min(100,e))/100*85,n=[42.5+.6*t,127.5+t,212.5+.5*t];return i.createColorMapFromListOfYValues(0,255,r.clone(n),3)},createContrastColorMap:function(e){var t=Math.max(-100,Math.min(100,e)),n=63.75*(e<0?t/200:t/100),o=[63.75-n,191.25+n];return i.createColorMapFromListOfYValues(0,255,r.clone(o),2)},createExposureColorMap:function(e){var t=Math.max(-100,Math.min(100,e));return t=t<0?-e*e/100:e*e/100,i.createColorMapFromListOfYValues(e,255+e,[],0)},createShadowsColorMap:function(e){if(0!=e){var t=Math.max(-100,Math.min(100,e))/100;t<0&&(t*=1.25);var n=25.5*t,o=[25.5+n,76.5+.75*n,127.5,178.5,229.5];return i.createColorMapFromListOfYValues(n,255,r.clone(o),5)}return i.createIdentityColorMap()},createHighlightsColorMap:function(e){if(0!=e){var t=Math.max(-100,Math.min(100,e))/100;t>0&&(t*=1.25);var n=25.5*t,o=[25.5,76.5,127.5,178.5+n,229.5+n];return i.createColorMapFromListOfYValues(0,255+.75*n,r.clone(o),5)}return i.createIdentityColorMap()},createFadeColorMap:function(e){var t,n=Math.max(-100,Math.min(100,e))/100,o=[63.75,191.25];return i.createColorMapFromListOfYValues(t=n<0?128*n:72*n,255-.5*t,r.clone(o),2)},createWarmthColorMaps:function(e){var t,n,o,a=r.repeat(r.repeat(0,s.MoaConstants.kMoaColorMapSizeRGB),3),c=Math.max(-100,Math.min(100,e))/100;if(c<-.6)t=-15*(1-(l=-(c+.6)/.4))+-90*l,n=5*(1-l)+-10*l,o=60*(1-l)+100*l;else if(c<0)t=-15*(l=-c/.6),n=5*l,o=60*l;else if(c>.6)t=30*(1-(l=(c-.6)/.4))+65*l,n=10*(1-l)+-5*l,o=-30*(1-l)+-127.5*l;else{var l;t=30*(l=c/.6),n=10*l,o=-30*l}var u=[127.5+t],h=[127.5+n],_=[127.5+o],d=.35*t,f=.35*n,m=.35*o,T=t<0?255+t:255+.5*t,p=n<0?255+n:255+.5*n,g=o<0?255+o:255+.5*o;return a[0]=r.clone(i.createColorMapFromListOfYValues(d,T,r.clone(u),1)),a[1]=r.clone(i.createColorMapFromListOfYValues(f,p,r.clone(h),1)),a[2]=r.clone(i.createColorMapFromListOfYValues(m,g,r.clone(_),1)),a},createTintColorMaps:function(e){var t,n,o,a=r.repeat(r.repeat(0,s.MoaConstants.kMoaColorMapSizeRGB),3),c=Math.max(-100,Math.min(100,e))/100;if(c<-.6)t=-10*(1-(l=-(c+.6)/.4))+-90*l,n=45*(1-l)+40*l,o=-20*(1-l)+-70*l;else if(c<0)t=-10*(l=-c/.6),n=45*l,o=-20*l;else if(c>.6)t=15*(1-(l=(c-.6)/.4))+45*l,n=-15*(1-l)+-75*l,o=25*(1-l)+45*l;else{var l;t=15*(l=c/.6),n=-15*l,o=25*l}var u=[127.5+t],h=[127.5+n],_=[127.5+o],d=.35*t,f=.35*n,m=.35*o,T=t<0?255+t:255+.5*t,p=n<0?255+n:255+.5*n,g=o<0?255+o:255+.5*o;return a[0]=r.clone(i.createColorMapFromListOfYValues(d,T,r.clone(u),1)),a[1]=r.clone(i.createColorMapFromListOfYValues(f,p,r.clone(h),1)),a[2]=r.clone(i.createColorMapFromListOfYValues(m,g,r.clone(_),1)),a},createColorMapFromListOfYValues:function(e,t,n,o){if(o<1)return i.createColorMapForTwoYVals(e,t);var a=r.repeat(0,s.MoaConstants.kMoaColorMapSizeRGB),c=(r.toDouble(s.MoaConstants.kMoaColorMapSizeRGB)-1)/r.toDouble(o),l=0;if(1==o){for(var u=e,h=n[0],_=t,d=r.iter(r.range(0,s.MoaConstants.kMoaColorMapSizeRGB-1,!1));!d.done;d.next()){var f=d.value,m=(R=1-(g=r.toDouble(f)/(r.toDouble(s.MoaConstants.kMoaColorMapSizeRGB)-1)))*R*u+2*R*g*h+g*g*_;a[f]=i.MoaColorClamp(m)}return a[0]=i.MoaColorClamp(e),a[s.MoaConstants.kMoaColorMapSizeRGB-1]=i.MoaColorClamp(t),a}var T=0,p=c;for(u=e,h=n[l],_=.5*(n[l]+n[l+1]),f=0;f<=r.toInt(c)&&f<s.MoaConstants.kMoaColorMapSizeRGB;)m=(R=1-(g=r.toDouble(f)/c))*R*u+2*R*g*h+g*g*_,a[f]=i.MoaColorClamp(m),f+=1;for(;l<o-2;)for(l+=1,T=r.toDouble(l)*c,p+=c,u=.5*(n[l-1]+n[l]),h=n[l],_=.5*(n[l]+n[l+1]);f<=r.toInt(p)&&f<s.MoaConstants.kMoaColorMapSizeRGB;)m=(R=1-(g=(r.toDouble(f)-T)/c))*R*u+2*R*g*h+g*g*_,a[f]=i.MoaColorClamp(m),f+=1;for(T=(r.toDouble(l)+1)*c,u=.5*(n[l]+n[l+1]),h=n[l+1],_=t;f<s.MoaConstants.kMoaColorMapSizeRGB-1;){var g,R;m=(R=1-(g=(r.toDouble(f)-T)/c))*R*u+2*R*g*h+g*g*_,a[f]=i.MoaColorClamp(m),f+=1}return a[0]=i.MoaColorClamp(e),a[s.MoaConstants.kMoaColorMapSizeRGB-1]=i.MoaColorClamp(t),a},createColorMapForTwoYVals:function(e,t){for(var n=r.repeat(0,s.MoaConstants.kMoaColorMapSizeRGB),i=r.iter(r.range(0,s.MoaConstants.kMoaColorMapSizeRGB,!1));!i.done;i.next()){var o=i.value,a=r.toDouble(o)/r.toDouble(s.MoaConstants.kMoaColorMapSizeRGB),c=1-a;n[o]=a*t+c*e}return n},combineColorMaps:function(e,t){for(var n=r.repeat(0,s.MoaConstants.kMoaColorMapSizeRGB),i=s.MoaConstants.kMoaColorMapSizeRGB-1,o=r.iter(r.range(0,s.MoaConstants.kMoaColorMapSizeRGB,!1));!o.done;o.next()){var a=o.value,c=e[a];if(c<=0)n[a]=t[0];else if(c>=r.toDouble(i))n[a]=t[i];else{var l=r.toInt(c),u=c-r.toDouble(l);n[a]=(1-u)*t[l]+u*t[l+1]}}return n},MoaColorClamp:function(e){return e>255?255:e<0?0:e},roundColorMap:function(e){for(var t=r.iter(r.range(0,s.MoaConstants.kMoaColorMapSizeRGB,!1));!t.done;t.next()){var n=t.value;e[n]=Math.round(e[n])}}}}),i)},516:function(e,t,n){var i,o=t,r=n(0),a=n(4),s=n(517);o.MoaColorMatrix=(i=function(){a.CoreObject.call(this)},r.defineClass({name:"MoaColorMatrix",ctor:i,superName:"CoreObject",statics:{applyVibranceToColorMatrix:function(e,t){var n=Math.max(-100,Math.min(100,t)),o=n/100;i.MoaColorMatrixAdjustVibrance(e,o=n<0?1-o*o:1+1.8*o*o)},MoaColorMatrixAdjustVibrance:function(e,t){var n=1+.7*(t-1),o=t,a=45*Math.PI/180,c=35.26*Math.PI/180,l=s.MoaTransform.init_d41d();l.preRotateX(a),l.preRotateY(-c),l.preScaleXY(n,o),l.preRotateY(c),l.preRotateX(-a);for(var u=r.repeat(0,12),h=r.iter(r.range(0,11,!0));!h.done;h.next()){var _=h.value;u[_]=l.transformMatrix[_]}i.MoaColorMatrixMultiply(e,r.clone(u))},applySaturationToColorMatrix:function(e,t){var n=Math.max(-100,Math.min(100,t)),o=n/100;i.MoaColorMatrixAdjSaturation(e,o=n<0?1-o*o:1+1.5*o*o)},MoaColorMatrixAdjSaturation:function(e,t){var n=.213*(1-t),o=.715*(1-t),a=.072*(1-t),s=[n+t,o,a,0,n,o+t,a,0,n,o,a+t,0];i.MoaColorMatrixMultiply(e,r.clone(s))},MoaColorMatrixMultiply:function(e,t){var n=r.repeat(0,12);n[0]=e[0]*t[0]+e[1]*t[4]+e[2]*t[8],n[1]=e[0]*t[1]+e[1]*t[5]+e[2]*t[9],n[2]=e[0]*t[2]+e[1]*t[6]+e[2]*t[10],n[4]=e[4]*t[0]+e[5]*t[4]+e[6]*t[8],n[5]=e[4]*t[1]+e[5]*t[5]+e[6]*t[9],n[6]=e[4]*t[2]+e[5]*t[6]+e[6]*t[10],n[8]=e[8]*t[0]+e[9]*t[4]+e[10]*t[8],n[9]=e[8]*t[1]+e[9]*t[5]+e[10]*t[9],n[10]=e[8]*t[2]+e[9]*t[6]+e[10]*t[10],n[3]=e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3],n[7]=e[4]*t[3]+e[5]*t[7]+e[6]*t[11]+e[7],n[11]=e[8]*t[3]+e[9]*t[7]+e[10]*t[11]+e[11];for(var i=r.iter(r.range(0,11,!0));!i.done;i.next()){var o=i.value;e[o]=n[o]}}}}),i)},517:function(e,t,n){var i,o=t,r=n(0),a=n(4);o.MoaTransform=(i=function(){this.transformMatrix_=[],this.identityTransform=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},r.defineClass({name:"MoaTransform",ctor:i,superName:"CoreObject",props:{init_d41d:function(){a.CoreObject.call(this),this.copy(r.clone(this.identityTransform))},init_8c4b:function(e){a.CoreObject.call(this),this.copy(r.clone(e))},transformMatrix:{get:function(){return this.transformMatrix_}},setIdentity:function(){this.transformMatrix_=r.clone(this.identityTransform)},copy:function(e){this.transformMatrix_=r.clone(e)},preRotateX:function(e){var t=i.init_8c4b([1,0,0,0,0,Math.cos(e),-Math.sin(e),0,0,Math.sin(e),Math.cos(e),0,0,0,0,1]);this.preTransform(t)},preTransform:function(e){var t=i.init_d41d();t.copy(r.clone(this.transformMatrix)),this.matrixMultiply(e,t)},matrixMultiply:function(e,t){var n=r.clone(e.transformMatrix),i=r.clone(t.transformMatrix);this.transformMatrix_[0]=n[0]*i[0]+n[1]*i[4]+n[2]*i[8]+n[3]*i[12],this.transformMatrix_[1]=n[0]*i[1]+n[1]*i[5]+n[2]*i[9]+n[3]*i[13],this.transformMatrix_[2]=n[0]*i[2]+n[1]*i[6]+n[2]*i[10]+n[3]*i[14],this.transformMatrix_[3]=n[0]*i[3]+n[1]*i[7]+n[2]*i[11]+n[3]*i[15],this.transformMatrix_[4]=n[4]*i[0]+n[5]*i[4]+n[6]*i[8]+n[7]*i[12],this.transformMatrix_[5]=n[4]*i[1]+n[5]*i[5]+n[6]*i[9]+n[7]*i[13],this.transformMatrix_[6]=n[4]*i[2]+n[5]*i[6]+n[6]*i[10]+n[7]*i[14],this.transformMatrix_[7]=n[4]*i[3]+n[5]*i[7]+n[6]*i[11]+n[7]*i[15],this.transformMatrix_[8]=n[8]*i[0]+n[9]*i[4]+n[10]*i[8]+n[11]*i[12],this.transformMatrix_[9]=n[8]*i[1]+n[9]*i[5]+n[10]*i[9]+n[11]*i[13],this.transformMatrix_[10]=n[8]*i[2]+n[9]*i[6]+n[10]*i[10]+n[11]*i[14],this.transformMatrix_[11]=n[8]*i[3]+n[9]*i[7]+n[10]*i[11]+n[11]*i[15],this.transformMatrix_[12]=n[12]*i[0]+n[13]*i[4]+n[14]*i[8]+n[15]*i[12],this.transformMatrix_[13]=n[12]*i[1]+n[13]*i[5]+n[14]*i[9]+n[15]*i[13],this.transformMatrix_[14]=n[12]*i[2]+n[13]*i[6]+n[14]*i[10]+n[15]*i[14],this.transformMatrix_[15]=n[12]*i[3]+n[13]*i[7]+n[14]*i[11]+n[15]*i[15]},preRotateY:function(e){var t=i.init_8c4b([Math.cos(e),0,Math.sin(e),0,0,1,0,0,-Math.sin(e),0,Math.cos(e),0,0,0,0,1]);this.preTransform(t)},preScaleXY:function(e,t){var n=i.init_8c4b([e,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1]);this.preTransform(n)}}}),i)},62:function(e,t,n){var i,o,r=t,a=n(0),s=n(238),c=n(196),l=n(1),u=n(482),h=n(53),_=n(9),d=n(10),f=n(48),m=n(125);r.KeyFrame=(i=function(e,t,n,i,o,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=!1),this.time_=e,this.timingFunction_=t,this.placement_=n||_.Matrix2D.Identity,this.bounds_=i,this.style_=o,this.relativePlacement_=r},a.defineClass({name:"KeyFrame",ctor:i,superName:"TheoDOMElement",statics:{PROPERTY_TIME:"start-time",PROPERTY_TIMING_FUNCTION:"timing-function",PROPERTY_PLACEMENT:"placement",PROPERTY_BOUNDS:"bounds",PROPERTY_STYLE:"style",decodeJson:function(e,t){if(null==e)return null;var n;if(n=a.as(e,["Dictionary","String","Any"])){var o,r=f.TheoTime.decodeJson(a.as(n[i.PROPERTY_TIME],"AnyObject")),s=m.TimingFunctionType.toCaseValue(n[i.PROPERTY_TIMING_FUNCTION]),c=null;null!=(o=n[i.PROPERTY_PLACEMENT])&&(c=_.Matrix2D.decodeJson(a.as(o,"AnyObject")));var l=d.TheoRect.decodeJson(a.as(n[i.PROPERTY_BOUNDS],"AnyObject")),u=h.FormaStyle.decodeJson(a.as(n[i.PROPERTY_STYLE],"AnyObject"),null,t);return new i(r,s,c,l,u)}return null}},props:{time:{get:function(){return this.time_}},timingFunction:{get:function(){return this.timingFunction_}},placement:{get:function(){return this.placement_}},bounds:{get:function(){return this.bounds_}},relativePlacement:{get:function(){return this.relativePlacement_}},style:{get:function(){return this.style_}},stillKeyframe:{get:function(){return null==this.style&&(null==this.placement||this.placement.equal(_.Matrix2D.Identity))&&null==this.bounds}},encodeJson:function(){var e={};return e[i.PROPERTY_TIME]=this.time_.encodeJson(),e[i.PROPERTY_TIMING_FUNCTION]=this.timingFunction_,null!=this.placement_&&(e[i.PROPERTY_PLACEMENT]=this.placement_.encodeJson()),null!=this.bounds_&&(e[i.PROPERTY_BOUNDS]=this.bounds_.encodeJson()),null!=this.style_&&(e[i.PROPERTY_STYLE]=this.style_.encodeJson()),e}}}),i),r.FormaAnimation=(o=function(e,t,n,i){this.startTime_=f.TheoTime.Zero,this.endTime_=f.TheoTime.Zero,this.keyFrames_=[],this.kind=o.KIND,this.startTime_=t,this.endTime_=n,this.keyFrames_=i,this.animationStyle_=e,this.valid_=!0},a.defineClass({name:"FormaAnimation",ctor:o,superName:"TheoDOMElement",statics:{KIND:{get:function(){return"FormaAnimation"}},PROPERTY_KIND:"kind",PROPERTY_START_TIME:"start-time",PROPERTY_END_TIME:"end-time",PROPERTY_KEY_FRAMES:"key-frames",PROPERTY_ANIMATION_STYLE:"animation-style",createDefault:function(){return new o(c.AnimationStyle.init_b946(),f.TheoTime.Zero,f.TheoTime.Zero,[])},decodeJson:function(e,t,n){var i,r,s,c;return null==e?null:(r=a.as(e,["Dictionary","String","Any"]))?null!=(s=(i=t)||null!=i?i:a.as(r[o.PROPERTY_KIND],"String"))?(c=u.FormaAnimationFactory.instance.create(s))?(c.decodeFromJson(r,n),c):(l.CoreAssert.fail("FormaAnimation: could not create animation"),null):(l.CoreAssert.fail("FormaAnimation.decodeJson: no kind found or forced"),null):(l.CoreAssert.fail("FormaAnimation.decodeJson: object passed isn't a dictionary"),null)}},props:{startTime:{get:function(){return this.startTime_},set:function(e){this.startTime_=e}},endTime:{get:function(){return this.endTime_},set:function(e){this.endTime_=e}},keyFrames:{get:function(){return this.keyFrames_}},animationStyle:{get:function(){return this.animationStyle_}},clone:function(){return o.decodeJson(this.encodeJson(),null,null)},invalidate:function(){this.valid_=!1},valid:{get:function(){return this.valid_}},decodeFromJson:function(e,t){this.startTime_=f.TheoTime.decodeJson(a.as(e[o.PROPERTY_START_TIME],"AnyObject")),this.endTime_=f.TheoTime.decodeJson(a.as(e[o.PROPERTY_END_TIME],"AnyObject")),this.keyFrames_=this.decodeKeyFrames(a.as(e[o.PROPERTY_KEY_FRAMES],"AnyObject"),t),this.animationStyle_=c.AnimationStyle.init_b946();var n=c.AnimationStyle.decodeJson(a.as(e[o.PROPERTY_ANIMATION_STYLE],"AnyObject"));if(null!=n)this.animationStyle_=n;else{var i=a.as(e.name,"String");null!=i&&(this.animationStyle_=(new s.AnimationLibrary).getAnimationStyle(i),this.invalidate())}},encodeJson:function(){var e={};return e[o.PROPERTY_KIND]=this.kind,e[o.PROPERTY_START_TIME]=this.startTime_.encodeJson(),e[o.PROPERTY_END_TIME]=this.endTime_.encodeJson(),e[o.PROPERTY_KEY_FRAMES]=this.encodeKeyFrames(),e[o.PROPERTY_ANIMATION_STYLE]=this.animationStyle_.encodeJson(),e},decodeKeyFrames:function(e,t){if(null==e)return null;var n;if(n=a.as(e,["Array","AnyObject"])){for(var i=[],o=a.iter(n);!o.done;o.next()){var s=o.value;i.push(r.KeyFrame.decodeJson(s,t))}return i}return null},encodeKeyFrames:function(){for(var e=[],t=a.iter(this.keyFrames_);!t.done;t.next()){var n=t.value;e.push(n.encodeJson())}return a.as(e,"AnyObject")}}}),o)},661:function(e,t,n){var i,o,r=t,a=n(0),s=n(4),c=n(357),l=n(515),u=n(516);r.ImageAdjustmentMaps=(i=function(){this.colorMap=[],this.sMap=[],this.hMap=[],this.threeChannelColorMap=[],this.cm=[]},a.defineClass({name:"ImageAdjustmentMaps",ctor:i,superName:"CoreObject",props:{set:function(e,t,n,i,o){this.colorMap=a.clone(e),this.sMap=a.clone(t),this.hMap=a.clone(n),this.threeChannelColorMap=a.clone(i),this.cm=a.clone(o)}}}),i),r.MoaAdjustments=(o=function(){s.CoreObject.call(this)},a.defineClass({name:"MoaAdjustments",ctor:o,superName:"CoreObject",statics:{computeColorMaps:function(e){var t=new r.ImageAdjustmentMaps,n=e.brightness,i=e.exposure,o=e.contrast,s=e.shadows,h=e.highlights,_=e.warmth,d=e.tint,f=e.saturation,m=e.vibrance,T=e.fade,p=a.clone(l.MoaColorMap.createIdentityColorMap()),g=0!=n||0!=i||0!=o,R=0!=_||0!=d||0!=T;if(0!=n){var E=a.clone(l.MoaColorMap.createBrightnessColorMap(n));p=a.clone(l.MoaColorMap.combineColorMaps(a.clone(p),a.clone(E)))}if(0!=i){var P=a.clone(l.MoaColorMap.createExposureColorMap(i));p=a.clone(l.MoaColorMap.combineColorMaps(a.clone(p),a.clone(P)))}if(0!=o){var C=a.clone(l.MoaColorMap.createContrastColorMap(o));p=a.clone(l.MoaColorMap.combineColorMaps(a.clone(p),a.clone(C)))}var D=a.clone(l.MoaColorMap.createShadowsColorMap(s)),O=a.clone(l.MoaColorMap.createHighlightsColorMap(h)),I=a.clone(l.MoaColorMap.createIdentityColorMap()),S=a.clone(l.MoaColorMap.createIdentityColorMap()),M=a.clone(l.MoaColorMap.createIdentityColorMap());if(0!=T){var A=a.clone(l.MoaColorMap.createFadeColorMap(T));I=a.clone(l.MoaColorMap.combineColorMaps(a.clone(I),a.clone(A))),S=a.clone(l.MoaColorMap.combineColorMaps(a.clone(S),a.clone(A))),M=a.clone(l.MoaColorMap.combineColorMaps(a.clone(M),a.clone(A)))}if(0!=_){var N=a.clone(l.MoaColorMap.createWarmthColorMaps(_));I=a.clone(l.MoaColorMap.combineColorMaps(a.clone(I),a.clone(N[0]))),S=a.clone(l.MoaColorMap.combineColorMaps(a.clone(S),a.clone(N[1]))),M=a.clone(l.MoaColorMap.combineColorMaps(a.clone(M),a.clone(N[2])))}if(0!=d){var v=a.clone(l.MoaColorMap.createTintColorMaps(d));I=a.clone(l.MoaColorMap.combineColorMaps(a.clone(I),a.clone(v[0]))),S=a.clone(l.MoaColorMap.combineColorMaps(a.clone(S),a.clone(v[1]))),M=a.clone(l.MoaColorMap.combineColorMaps(a.clone(M),a.clone(v[2])))}if(g)for(var y=a.iter(a.range(0,c.MoaConstants.kMoaColorMapSizeRGB,!1));!y.done;y.next())p[b=y.value]=l.MoaColorMap.MoaColorClamp(Math.round(p[b]));if(R)for(var Y=a.iter(a.range(0,c.MoaConstants.kMoaColorMapSizeRGB,!1));!Y.done;Y.next()){var b;I[b=Y.value]=l.MoaColorMap.MoaColorClamp(Math.round(I[b])),S[b]=l.MoaColorMap.MoaColorClamp(Math.round(S[b])),M[b]=l.MoaColorMap.MoaColorClamp(Math.round(M[b]))}if(f+m>c.MoaConstants.kSatVibranceSumMax){var x=f+m;f=c.MoaConstants.kSatVibranceSumMax*f/x,m=c.MoaConstants.kSatVibranceSumMax*m/x}var L=[1,0,0,0,0,1,0,0,0,0,1,0];0!=m&&u.MoaColorMatrix.applyVibranceToColorMatrix(L,m),0!=f&&u.MoaColorMatrix.applySaturationToColorMatrix(L,f),l.MoaColorMap.roundColorMap(D),l.MoaColorMap.roundColorMap(O);var F=a.repeat([],3);return F[0]=a.clone(I),F[1]=a.clone(S),F[2]=a.clone(M),t.set(a.clone(p),a.clone(D),a.clone(O),a.clone(F),a.clone(L)),t}}}),o)},662:function(e,t,n){var i,o,r=t,a=n(0),s=n(4);r.GaussianKernel=(i=function(){this.glKernel=[],this.windowWidth=0},a.defineClass({name:"GaussianKernel",ctor:i,superName:"CoreObject",props:{set:function(e,t){this.glKernel=a.clone(e),this.windowWidth=t}}}),i),r.Sharpen=(o=function(){s.CoreObject.call(this)},a.defineClass({name:"Sharpen",ctor:o,superName:"CoreObject",statics:{computeGaussianKernels:function(e,t,n){var i=new r.GaussianKernel,s=4*e/100*a.toDouble(t+n)/400,c=a.toInt(Math.floor(1.5*s)+1),l=0;c>4&&(l=a.toInt(Math.floor((a.toDouble(c)/a.toDouble(4)-1)/2)+1),c=a.toInt(Math.floor(a.toDouble(c)/a.toDouble(2*l+1))+1));for(var u=2*l+1,h=2*c+1,_=[],d=0,f=a.iter(a.range(0,h,!1));!f.done;f.next()){var m=f.value;d+=a.toDouble(u)*(o.MoaMathNormalCDF(a.toDouble(m)+.5-a.toDouble(c),s/a.toDouble(u))-o.MoaMathNormalCDF(a.toDouble(m)-.5-a.toDouble(c),s/a.toDouble(u)))}for(var T=0,p=a.iter(a.range(0,h,!1));!p.done;p.next())m=p.value,_.push(1/d*a.toDouble(4096)*(o.MoaMathNormalCDF(a.toDouble(m)+.5-a.toDouble(c),s/a.toDouble(u))-o.MoaMathNormalCDF(a.toDouble(m)-.5-a.toDouble(c),s/a.toDouble(u)))),T+=_[m];for(var g=4-a.toInt((h-1)/2),R=4+a.toInt((h-1)/2),E=[],P=a.iter(a.range(0,8,!0));!P.done;P.next())(m=P.value)<g||m>R?E.push(0):E.push(a.toDouble(_[m-g])/T);return i.set(a.clone(E),u),i},get357FactorsOfClosestFactorableNumber:function(e){for(var t=!1,n=0,i=e,o=[0,0,0];!t;)if(i=e+n,(n*=-1)<=0&&(n-=1),!(i<3)){t=!0;var r=i,a=[3,5,7];o[0]=0,o[1]=0,o[2]=0;for(var s=0;r>1;)if(r%a[s]==0?(o[s]=o[s]+1,r/=a[s]):s+=1,s>=3){t=!1;break}}return o},MoaMathNormalCDF:function(e,t){return(1+o.MoaMathErf(e/1.4142135623730951/t))/2},MoaMathErf:function(e){return e>=0?1-o.MoaMathErfccheb(e):o.MoaMathErfccheb(-e)-1},MoaMathErfccheb:function(e){var t,n=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];if(e<0)return 0;for(var i=0,o=0,r=2/(2+e),s=4*r-2,c=a.iter(a.range(1,27,!0).reversed());!c.done;c.next())t=i,i=s*i-o+n[c.value],o=t;return r*Math.exp(-e*e+.5*(n[0]+s*i)-o)}}}),o)},88:function(e,t,n){var i,o=t,r=n(0),a=n(1),s=n(10),c=n(28),l=n(132);o.PROPERTY_SIZE="size",o.PROPERTY_OVERRIDE_BOUNDS="override_bounds",o.VectorContentNode=(i=function(e,t){this.size_=c.TheoSize.Zero,this.overrideBounds_=s.TheoRect.Zero,l.URLBasedContentNode.call(this,e,t)},r.defineClass({name:"VectorContentNode",ctor:i,superName:"URLBasedContentNode",statics:{KIND:{get:function(){return"vector"}},USAGE_TAG:"usage_reported",_implements:function(e){return"TheoMessagePublisher"==e}},props:{size:{get:function(){return this.size_},set:function(e){this.size_.equal(e)||(this.size_=e)}},overrideBounds:{get:function(){return this.overrideBounds_},set:function(e){this.overrideBounds_.equal(e)||(this.overrideBounds_=e)}},isUsageReported:function(){var e=this.getTag(i.USAGE_TAG);return null!=e&&"true"==e},setUsageReported:function(e){this.setTag(i.USAGE_TAG,e?"true":"false")},getUsageID:function(){return r.opt(this.mediaMetadata,function(e){return e.assetID})},decode:function(e){l.URLBasedContentNode.prototype.decode.call(this,e);var t,n=c.TheoSize.decodeJson(e.property(o.PROPERTY_SIZE));null!=n?this.size_=n:a.CoreAssert.warning("VectorContentNode.decode: could not get size attribute"),(t=s.TheoRect.decodeJson(e.property(o.PROPERTY_OVERRIDE_BOUNDS)))&&(this.overrideBounds_=t)},encode:function(e){l.URLBasedContentNode.prototype.encode.call(this,e),e.setProperty(o.PROPERTY_SIZE,this.size_.encodeJson()),e.setProperty(o.PROPERTY_OVERRIDE_BOUNDS,this.overrideBounds_.encodeJson())}}}),i)}}]);
//# sourceMappingURL=logomaker-entry_115f2f55-588ce184.js.map