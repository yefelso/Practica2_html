(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{138:function(t,e,o){var n,a,i=e,r=o(0),c=o(1);i.DecorationResults=(n=function(t){this.items=r.clone(t)},r.defineClass({name:"DecorationResults",ctor:n}),n),i.LockupDecorationStrategy=r.defineProtocol("LockupDecorationStrategy",{supportsConfiguration:"(LockupConfiguration) -> Boolean",decorate:"(LockupConfiguration, LayoutResults) -> DecorationResults"}),i.BaseDecorationStrategy=(a=function(){},r.defineClass({name:"BaseDecorationStrategy",ctor:a,statics:{getHorizontalOffsetForItalicAngle:function(t,e){var o=Math.abs(e),n=(180-o-90)*Math.PI/180,a=o*Math.PI/180,i=t/Math.sin(n)*Math.sin(a);return(i>t||i<0)&&(i=t/2),i},_implements:function(t){return"LockupDecorationStrategy"==t}},props:{supportsConfiguration:function(t){return c.CoreAssert.fail("Implement in subclass"),!1},decorate:function(t,e){return c.CoreAssert.fail("Implement in subclass"),new i.DecorationResults([])}}}),a)},245:function(t,e,o){var n,a=e,i=o(0),r=o(14);a.kOpacityRuleFaintAlpha=.5,a.kOpacityRuleMediumAlpha=.7,a.LockupConfiguration=(n=function(t,e,o,n,a,i,c){this.characterStyleRanges=[],this.highlightMethod=r.HighlightMethod.Manual,this.rowWordLengths=null,this.allowFewerLineBreaks=!1,void 0===n&&(n=null),void 0===a&&(a=null),void 0===i&&(i=!1),void 0===c&&(c=!1),this.text=t,this.style=e,this.containerSize=o,this.placement=n,this.parentBounds=a,this.useOptimization=i,this.forceLetterForma=c},i.defineClass({name:"LockupConfiguration",ctor:n}),n)},248:function(t,e,o){var n,a=e,i=o(0),r=o(9),c=o(15);a.PinBoundsType=i.defineEnum("PinBoundsType",{ChildrenBounds:0,Bounds:1}),a.TheoPin=(n=function(t,e,o,n,a,i,r,c,s,l){void 0===c&&(c=0),void 0===s&&(s=0),void 0===l&&(l=!1),this.forma=t,this.pinType=e,this.pinPoint=o,this.referenceForma=n,this.referencePinType=a,this.referencePoint=i,this.targetHeight=r,this.absoluteHeightDistance=c,this.relativeHeightDistance=s,this.useAbsoluteHeight=l,this.containedInParent=t.parent.finalFrame.insetRel(-.1,-.1,-.1,-.1).contains(t.finalFrame)},i.defineClass({name:"TheoPin",ctor:n,superName:"CoreObject",statics:{evalPinPoint:function(t,e,o){var n;if(n=i.opt(t.controller,function(t){return t.getPinBounds(e)})){var a=n.eval(o);return t.totalPlacement.transformPoint(a)}return null}},props:{offset:function(){var t,e,o;if((t=n.evalPinPoint(this.forma,this.pinType,this.pinPoint))&&(e=n.evalPinPoint(this.referenceForma,this.referencePinType,this.referencePoint))&&null!=(o=i.opt(this.referenceForma.controller,function(t){return t.currentHeightScale}))){var a=this.useAbsoluteHeight?this.absoluteHeightDistance:o*this.relativeHeightDistance,r=this.referenceForma.totalPlacement.transformValues,s=new c.TheoPoint(-1*a*r.rotSine,a*r.rotCosine),l=1==this.pinPoint.y?-1:1;return new c.TheoPoint(e.x-t.x+l*s.x,e.y-t.y+l*s.y)}return c.TheoPoint.ZERO},offsetMatrix:function(){var t=this.offset(),e=c._minus_TheoPoint_TheoPoint(this.forma.totalPlacement.inverse.concat(this.forma.placement).transformPoint(t),this.forma.totalPlacement.inverse.concat(this.forma.placement).transformPoint(c.TheoPoint.ZERO));return r.Matrix2D.translation(e)},isRelativePin:{get:function(){return 0!=this.absoluteHeightDistance||0!=this.relativeHeightDistance}}}}),n)},332:function(t,e,o){var n,a=e,i=o(0),r=o(89);a.VideoController=(n=function(t,e,o){r.ImageController.call(this,t,e,o)},i.defineClass({name:"VideoController",ctor:n,superName:"ImageController",statics:{KIND:{get:function(){return"video"}}},props:{replaceable:{get:function(){return!0}}}}),n)},435:function(t,e,o){var n,a=e,i=o(0),r=o(1),c=o(138),s=o(71),l=o(17),u=o(9),h=o(81),p=o(15),g=o(10),f=o(28);a.BannerDecorationStrategy=(n=function(){this.spacingScalar=.75,c.BaseDecorationStrategy.call(this)},i.defineClass({name:"BannerDecorationStrategy",ctor:n,superName:"BaseDecorationStrategy",statics:{_implements:function(t){return"LockupDecorationStrategy"==t}},props:{easeOutQuad:function(t,e,o,n){var a=t/n;return-o*a*(a-2)+e},easeOut:function(t,e,o){return this.easeOutQuad(o,t,e-t,1)},supportsConfiguration:function(t){return t.style.backing==l.LockupBacking.Banner},decorate:function(t,e){function o(t,e){return new p.TheoPoint(t,e)}var n=t.style,a=n.padding;e.numberOfLines>1&&(a+=n.spacing*this.spacingScalar);var d=e.avgTextPointSize*a,R=[],m=g.TheoRect.fromSize(e.size).transform(e.placement),y=!1;t.style.backing==l.LockupBacking.BannerHorizontal?y=!1:t.style.backing==l.LockupBacking.BannerVertical?y=!0:r.CoreAssert.isTrue(!1,"Invalid backing shape.");var v=c.BaseDecorationStrategy.getHorizontalOffsetForItalicAngle(e.avgLinePointSize*e.typographicBoundingRatios.heightFromBaselineRatio,t.style.font.fontData.italicAngle),w=e.typographicBoundingRatios.backingVerticalOffsetRatio*e.avgLinePointSize,L=this.easeOut(0,w,Math.min(1,a)),S=y?m.minX-d:-4093,k=y?-4093:m.minY-d+L,A=h.TheoArbitraryPath.init_d41d(),C=v+(y?m.size.width+2*d:8186),T=y?8186:m.size.height+2*d,x=new f.TheoSize(C,T),D=u.Matrix2D.translationXY(S,k),I=function(t,e,n){var a=h.TheoArbitraryPath.init_d41d(),r=e.transformPoint(t.eval(o(0,0)));a.moveTo(r.x,r.y);var c=new g.TheoRect(r.x,r.y,r.x,r.y);if(n)for(var s=i.iter([o(0,1),o(1,1),o(1,0)]);!s.done;s.next()){var l=s.value;r=e.transformPoint(t.eval(l)),a.lineTo(r.x,r.y),c=c.expandToFit(r)}else for(var u=i.iter([o(1,0),o(1,1),o(0,1)]);!u.done;u.next())l=u.value,r=e.transformPoint(t.eval(l)),a.lineTo(r.x,r.y),c=c.expandToFit(r);return a.closePath(),{path:a,bounds:c}}(g.TheoRect.fromSize(x),u.Matrix2D.Identity,!0).path;A.addPath(I,e.placement);var b=new f.TheoSize(i.opt(A.bounds,function(t){return t.width}),i.opt(A.bounds,function(t){return t.height}));return R.push(i.clone(s.LockupItem.init_708e(!1,b,D,A))),new c.DecorationResults(i.clone(R))}}}),n)},436:function(t,e,o){var n,a=e,i=o(0),r=o(1),c=o(71),s=o(201),l=o(17),u=o(322),h=o(9),p=o(14),g=o(72),f=o(95),d=o(28);a.EvenRowHeightsLayoutStrategy=(n=function(t){this.paddingScalar=.6,this.spacingScalar=.75,t==l.LockupAlignment.Left||t==l.LockupAlignment.Right||t==l.LockupAlignment.Center?this.alignment=t:(r.CoreAssert.fail("Unexpected alignment: "+t),this.alignment=l.LockupAlignment.Left)},i.defineClass({name:"EvenRowHeightsLayoutStrategy",ctor:n,superName:"BaseLockupLayoutStrategy",statics:{_implements:function(t){return"LockupLayoutStrategy"==t}},props:{supportsConfiguration:function(t){return t.style.layout==l.LockupLayout.Standard&&t.style.alignment==this.alignment},layout:function(t){var e=t.text,o=t.style,n=o.font.fontData,a=t.containerSize,r=a.width,s=a.height,l=o.spacing*this.spacingScalar,u=r,f=s,R=u/f,m=c.getTypographicBoundingRatiosOfString(e,n,!1),y=p.TypeLockupController.HIGHLIGHT_STYLE,v=i.opt(i.opt(o.characterStyles[y],function(t){return t.font}),function(t){return t.fontData}),w=g.TypeLockupUtils.getCharFontAdjust(o,m.hasUppercase),L=!1,S=t.characterStyleRanges.length>0&&null!=o.characterStyles[y]&&-1!=o.characterStyles[y].spacing&&0!=o.characterStyles[y].spacing;S&&o.characterStyles[y].spacing>1&&((o=t.style.clone()).characterStyles[y].spacing=w,L=!0,null!=v&&(v=n,n=o.characterStyles[y].font.fontData,o.characterStyles[y].font=o.font));var k=i.clone(this.getCompactedRows(t,R,t.highlightMethod,!1,m));if(0==k.length)return c.LayoutResults.init_8322([],new d.TheoSize(0,0),h.Matrix2D.Identity,m,0);var A=this.getAspectRatioOfAllRows(i.clone(k),l),C=i.clone(this.getWidestRowAspectRatio(i.clone(k)));if(0==C.aspectRatio)return c.LayoutResults.init_8322([],new d.TheoSize(0,0),h.Matrix2D.Identity,m,0);A<R?u=f*A:f=u/A;for(var T=f,x=u,D=u/C.aspectRatio,I=u/(C.aspectRatio/l),b=D/m.heightRatio,M=b*w,B=b*n.capRatio,H=b*m.textVerticalOffsetRatio-B,z=g.TypeLockupUtils.getCharFontYAdjust(o,b,M),P=H,O=0,F=[],_=0,U=i.iter(i.range(0,k.length,!1));!U.done;U.next()){var W=U.value,E=i.clone(k[W]),G=E.words.length>20||e.length>300&&k.length>5?0:3;if(_=b,S){for(var Y=!0,j=i.iter(E.words);!j.done;j.next()){var N=j.value;if(i.isEmpty(N.characterStyle)||b==M){Y=!1;break}}_=Y?M:b}W>0&&(P+=I);var V=E.aspectRatio*D;switch(this.alignment){case 0:O=0;break;case 1:O=u-V+0;break;case 2:O=0+(u-V)/2}for(var X=0,q=0,J=i.iter(E.words);!J.done;J.next()){N=J.value;var Q=i.isEmpty(N.characterStyle)||_==M?0:z,Z=i.isEmpty(N.characterStyle)?b:M,K=N.aspectRatio*D,$=O,tt=P+0+Q,et=i.isEmpty(N.characterStyle)?null:N.characterStyle;L&&(et=i.isEmpty(N.characterStyle)?y:null);var ot,nt=i.clone(c.LockupItem.init_e7b2(!0,et,new d.TheoSize(K,B),h.Matrix2D.translationXY($,tt),N.text,i.isEmpty(N.characterStyle)?n:v||n,Z,b,m,W,N.rangeInLockup));if(ot=i.last(F)){var at=ot.font.spaceWidthRatio*ot.pointSize;if((Math.abs(at-X)<.001||0==X)&&t.useOptimization&&ot.characterStyle==nt.characterStyle&&ot.placement.ty==tt&&q>G&&q<E.words.length-G&&!t.forceLetterForma){var it=i.clone(ot);it.text=0!=X?it.text+" "+nt.text:it.text+nt.text,it.size=new d.TheoSize(it.size.width+X+nt.size.width,B),F.pop(),F.push(i.clone(it))}else F.push(i.clone(nt))}else F.push(i.clone(nt));q+=1,O+=K+(X=N.spaceAspectRatio*D)}P+=_*m.heightRatio}return c.LayoutResults.init_8322(i.clone(F),new d.TheoSize(x,T),h.Matrix2D.translationXY(0,0),m,C.aspectRatio)},calculateTracking:function(t,e){var o=t.text,n=t.style.font.fontData,a=t.containerSize.width,r=t.style.spacing*this.spacingScalar,s=c.getTypographicBoundingRatiosOfString(o,n,!1),l=0,u=e.width,h=e.height,p=u/h,g=i.clone(this.getCompactedRows(t,p,t.highlightMethod,!0,s));if(0==g.length)return t.style.tracking;var f=this.getAspectRatioOfAllRows(i.clone(g),r),d=i.clone(this.getWidestRowAspectRatio(i.clone(g))),R=d.aspectRatio;if(0==R)return t.style.tracking;var m=(u=h*f)/R,y=R*m;if(y<a){l=this.getSpacing(i.clone(g),i.clone(d),m,a,!1).letterSpacing;for(var v=i.iter(g);!v.done;v.next()){var w=v.value;if(w.words.length>1){var L=this.getSpacing(i.clone(g),i.clone(w),m,a,!1);L.letterSpacing<l&&(l=L.letterSpacing)}}(l/=m/s.heightRatio)<.01&&(l=0)}else l=-y;return l},calculateLeading:function(t,e){var o=t.containerSize,n=o.width,a=o.height,r=0,s=e.width,l=e.height,u=s/l,h=c.getTypographicBoundingRatiosOfString(t.text,t.style.font.fontData,!1),p=i.clone(this.getCompactedRows(t,u,t.highlightMethod,!1,h));if(p.length<=1)return t.style.spacing;var g=this.getAspectRatioOfAllRows(i.clone(p),r),f=i.clone(this.getWidestRowAspectRatio(i.clone(p)));l=s/g;var d=s/f.aspectRatio,R=f.aspectRatio*d;if(l<a){var m=n/((a-l)/(i.toDouble(p.length)-1));r=f.aspectRatio/m/this.spacingScalar}else i.info("fits in width. old tracking is :",t.style.tracking,R,"CW:",n,a,s,l),r=-l;return r},getSpacing:function(t,e,o,n,a){var r=0,c=0,s=0,l=0;if(e.words.length<=1)return{letterSpacing:s,wordSpacing:l};for(var u=i.iter(e.words);!u.done;u.next()){var h=u.value;r+=h.aspectRatio*o+h.spaceAspectRatio*o,0!=h.spaceAspectRatio&&h.canBreak&&(c+=1)}return r-=i.last(e.words).spaceAspectRatio*o,a?l=(n-r)/(i.toDouble(c)-1):(s=(n-r)/(i.toDouble(e.words.length)-1),c>1&&s>0&&(s=(n-r-(l=s)*(i.toDouble(c)-1))/(i.toDouble(e.words.length)-1))),{letterSpacing:s,wordSpacing:l}},getWidestRowAspectRatio:function(t){for(var e=i.clone(t[0]),o=i.iter(t);!o.done;o.next()){var n=o.value;n.aspectRatio>e.aspectRatio&&(e=i.clone(n))}return e},getAspectRatioOfAllRows:function(t,e){var o=t.length-1,n=i.clone(this.getWidestRowAspectRatio(i.clone(t)));if(0==n.aspectRatio)return 0;for(var a=n.aspectRatio/e,r=0,c=i.iter(t);!c.done;c.next()){var s=c.value;r+=1/n.aspectRatio*s.rowHeightAdjustRatio}return 1/(r+1/a*i.toDouble(o))},rowsForTargetRowAspectRatio:function(t,e,o){var n=[];n.push(i.clone(s.LockupRowInfo.init_d97e()));for(var a=0,r=0,c=!0,l=t.length,h=0;h<l;){var p=i.clone(n[a]),g=i.clone(t[h]);if(g.isNewLine)p.appendable=!1,n[a]=i.clone(p),h+=1;else{for(var f=p.aspectRatio,d=g.aspectRatio+g.spaceAspectRatio,R=h;R+1<l&&!t[R].canBreak;)d+=t[R+=1].aspectRatio+t[R].spaceAspectRatio;var m=f+d,y=u.LockupUtils.percentageDiff(e,f),v=u.LockupUtils.percentageDiff(e,m);if(r>0&&y<v||0==p.appendable||!c&&h>0&&t[h-1].canBreak){a+=1,r=1;var w=i.clone(s.LockupRowInfo.init_d97e());if(o)c=!(h>0&&!t[h-1].canBreak);else for(;!g.canBreak&&h<l;)w.addWord(i.clone(g)),(h+=1)<l&&(g=i.clone(t[h]));w.addWord(i.clone(g)),n.push(i.clone(w))}else{if(!o)for(;!g.canBreak&&h<l;)p.addWord(i.clone(g)),(h+=1)<l&&(g=i.clone(t[h]));p.addWord(i.clone(g)),r+=1,n[a]=i.clone(p)}h+=1}}return n},getCompactedRows:function(t,e,o,n,a){var r=t.text,c=t.style,l=c.font.fontData,u=c.spacing*this.spacingScalar,h=c.tracking,d=n||t.forceLetterForma,R=i.clone(t.characterStyleRanges),m=p.TypeLockupController.HIGHLIGHT_STYLE,y=i.opt(i.opt(c.characterStyles[m],function(t){return t.font}),function(t){return t.fontData}),v=g.TypeLockupUtils.getCharFontAdjust(c,a.hasUppercase);t.characterStyleRanges.length>0&&null!=c.characterStyles[m]&&-1!=c.characterStyles[m].spacing&&0!=c.characterStyles[m].spacing&&c.characterStyles[m].spacing>1&&((c=t.style.clone()).characterStyles[m].spacing=v,R=i.clone(g.TypeLockupUtils.invertRanges(i.clone(t.characterStyleRanges),r.length)),null!=y&&(y=l,l=c.characterStyles[m].font.fontData,c.characterStyles[m].font=c.font));var w=i.clone(g.TypeLockupUtils.computeLockupMeasurements(r,l,a.heightRatio,!1,d,h,i.clone(R),i.clone(c.characterStyles),v,t.forceLetterForma)),L=w.length;if(0==L)return[];for(var S=s.LockupRowInfo.init_d97e(i.clone(w)).aspectRatio,k=i.clone(this.getOptimalCompactedRows(i.clone(w),S,e,u,.5,.6+1.6*S,!1,n)),A=0,C=i.iter(w);!C.done;C.next())A+=C.value.isNewLine?0:1;if(null!=t.rowWordLengths&&t.rowWordLengths.reduce(function(t,e){return t+e},0)==A&&(!t.allowFewerLineBreaks||k.length>=t.rowWordLengths.length)&&(k=i.clone(this.getPrecomputedRows(i.clone(w),i.clone(t.rowWordLengths)))),null!=c.characterStyles[m]&&null!=c.characterStyles[m].font&&(L>1&&!d||d&&k.length>1)&&(o==p.HighlightMethod.EvenRows||o==p.HighlightMethod.OddRows||o==p.HighlightMethod.Bracket||o==p.HighlightMethod.InsideBracket)){var T=i.clone(g.TypeLockupUtils.computeLockupMeasurements(r,l,a.heightRatio,!1,d,h,i.clone([]),i.clone({}),void 0,t.forceLetterForma)),x=[new f.TextRange(0,i.chars(r).length)],D=i.clone(g.TypeLockupUtils.computeLockupMeasurements(r,y,a.heightRatio,!1,d,h,i.clone(x),i.clone(c.characterStyles),v,t.forceLetterForma));k=i.clone(this.getOptimalCompactedAutoRows(i.clone(T),i.clone(D),S,e,u,.5,.6+1.6*S,!1,!1,o))}if(n&&c.tracking>0)for(var I=i.iter(i.range(0,k.length,!1));!I.done;I.next()){var b=I.value;k[b].aspectRatio=0;for(var M=i.iter(i.range(0,k[b].words.length,!1));!M.done;M.next()){var B=M.value;k[b].aspectRatio+=k[b].words[B].aspectRatio,k[b].words[B].canBreak&&B!=k[b].words.length-1?(k[b].words[B].spaceAspectRatio=l.spaceWidthRatio/a.heightRatio,k[b].aspectRatio+=k[b].words[B].spaceAspectRatio):k[b].words[B].spaceAspectRatio=0}}return k},getOptimalCompactedRows:function(t,e,o,n,a,r,c,s){var l=r-a,h=.25*l,p=a+.5*l,g=a+h,f=r-h,d=i.clone(this.rowsForTargetRowAspectRatio(i.clone(t),g,c)),R=i.clone(this.rowsForTargetRowAspectRatio(i.clone(t),f,c)),m=this.getAspectRatioOfAllRows(i.clone(d),n),y=this.getAspectRatioOfAllRows(i.clone(R),n),v=u.LockupUtils.percentageDiff(o,m),w=u.LockupUtils.percentageDiff(o,y);return l<.2?v<w?d:R:v<=w?this.getOptimalCompactedRows(i.clone(t),e,o,n,a,p,c,s):this.getOptimalCompactedRows(i.clone(t),e,o,n,p,r,c,s)},getWordForAutoMethod:function(t,e,o,n,a){var r=a==p.HighlightMethod.EvenRows?0:1,c=i.clone(o%2==r?e:t);return a!=p.HighlightMethod.Bracket&&a!=p.HighlightMethod.InsideBracket||(c=0==o||n?i.clone(a==p.HighlightMethod.Bracket?e:t):i.clone(a==p.HighlightMethod.InsideBracket?e:t)),c},rowsForTargetRowAspectRatioAutoRows:function(t,e,o,n,a,r){var c=[];c.push(i.clone(s.LockupRowInfo.init_d97e()));for(var l=0,h=0,g=!0,f=t.length,d=0,R=0;d<f;){var m=i.clone(c[l]),y=i.clone(this.getWordForAutoMethod(i.clone(t[d]),i.clone(e[d]),l,d==f-1,r));if(y.isNewLine)m.appendable=!1,c[l]=i.clone(m),d+=1;else{for(var v=m.aspectRatio,w=y.aspectRatio+y.spaceAspectRatio,L=d;L+1<f&&!t[L].canBreak;)w+=t[L+=1].aspectRatio+t[L].spaceAspectRatio;var S=v+w,k=u.LockupUtils.percentageDiff(n,v),A=u.LockupUtils.percentageDiff(n,S);if(h>0&&k<A||0==m.appendable||!g&&d>0&&t[d-1].canBreak){l+=1,R=d,y=i.clone(this.getWordForAutoMethod(i.clone(t[d]),i.clone(e[d]),l,d==f-1,r)),h=1;var C=i.clone(s.LockupRowInfo.init_d97e());if(a)g=!(d>0&&!t[d-1].canBreak);else for(;!y.canBreak&&d<f;)C.addWord(i.clone(y)),(d+=1)<f&&(y=i.clone(this.getWordForAutoMethod(i.clone(t[d]),i.clone(e[d]),l,d==f-1,r)));C.addWord(i.clone(y)),c.push(i.clone(C))}else{if(!a)for(;!y.canBreak&&d<f;)m.addWord(i.clone(y)),(d+=1)<f&&(y=i.clone(this.getWordForAutoMethod(i.clone(t[d]),i.clone(e[d]),l,d==f-1,r)));m.addWord(i.clone(y)),h+=1,c[l]=i.clone(m)}d+=1}}if(r==p.HighlightMethod.Bracket||r==p.HighlightMethod.InsideBracket){for(var T=i.clone(s.LockupRowInfo.init_d97e()),x=i.iter(i.range(R,f,!1));!x.done;x.next()){d=x.value;var D=i.clone(r==p.HighlightMethod.Bracket?e[d]:t[d]);T.addWord(i.clone(D))}c[c.length-1]=i.clone(T)}return c},getOptimalCompactedAutoRows:function(t,e,o,n,a,c,s,l,h,p){r.CoreAssert.isTrue(t.length==e.length);var g=s-c,f=.25*g,d=c+.5*g,R=c+f,m=s-f,y=i.clone(this.rowsForTargetRowAspectRatioAutoRows(i.clone(t),i.clone(e),a,R,l,p)),v=i.clone(this.rowsForTargetRowAspectRatioAutoRows(i.clone(t),i.clone(e),a,m,l,p)),w=this.getAspectRatioOfAllRows(i.clone(y),a),L=this.getAspectRatioOfAllRows(i.clone(v),a);if(h){if(w>n&&L<n)return v;if(L>n&&w<n)return y}var S=u.LockupUtils.percentageDiff(n,w),k=u.LockupUtils.percentageDiff(n,L);return g<.2?S<k?y:v:S<=k?this.getOptimalCompactedAutoRows(i.clone(t),i.clone(e),o,n,a,c,d,l,h,p):this.getOptimalCompactedAutoRows(i.clone(t),i.clone(e),o,n,a,d,s,l,h,p)}}}),n)},440:function(t,e,o){var n,a=e,i=o(0),r=o(1),c=o(71),s=o(201),l=o(17),u=o(322),h=o(9),p=o(14),g=o(72),f=o(95),d=o(28);a.EvenRowWidthsLayoutStrategy=(n=function(){this.paddingScalar=.6,this.spacingScalar=.75,c.BaseLockupLayoutStrategy.call(this)},i.defineClass({name:"EvenRowWidthsLayoutStrategy",ctor:n,superName:"BaseLockupLayoutStrategy",statics:{getCombinedAspectOfAllRows:function(t,e){for(var o=0,n=i.iter(t);!n.done;n.next())o+=1/n.value.aspectRatio;return e>0?1/(i.toDouble(t.length-1)*(1/e)+o):1/o},getCombinedAspectOfAllRowsFinal:function(t,e){for(var o=0,n=i.iter(t);!n.done;n.next()){var a=n.value,r=a.rowHeightAdjustRatio<1?a.rowHeightAdjustRatio:1;o+=1/a.aspectRatio*(r*r)}return 0!=e?1/(i.toDouble(t.length-1)*(1/e)+o):1/o},getAverageRowAspect:function(t){for(var e=0,o=i.iter(i.range(0,t.length,!1).reversed());!o.done;o.next())e+=t[o.value].aspectRatio;return e/i.toDouble(t.length)},getTallestRowPairIndex:function(t){for(var e=5e3,o=t.length,n=null,a=i.iter(i.range(0,o-1,!1));!a.done;a.next()){var r=a.value,c=i.clone(t[r]);if(c.appendable){var s=r+1,l=i.clone(t[s]),u=c.aspectRatio+l.aspectRatio;u<e&&(e=u,n=r)}}return n},aspectDifference:function(t,e){return 1/(1/t-1/e)},aspectStacked:function(t,e){return 1/(1/t+1/e)},mergeRows:function(t,e,o){var n=i.clone(t);r.CoreAssert.isTrue(e<o);var a=n[e].words.concat(n[o].words),c=i.clone(s.LockupRowInfo.init_d97e(i.clone(a),n[o].appendable));return n.splice(o,1),n.splice(e,1),n.splice(e,0,i.clone(c)),n},mergeAutoRows:function(t,e,o,a,r,c){for(var s=i.clone(n.mergeRows(i.clone(t),e,o)),l=c==p.HighlightMethod.EvenRows?0:1,u=0,h=i.iter(i.range(0,s.length,!1));!h.done;h.next()){for(var g=h.value,f=0,d=i.iter(i.range(0,s[g].words.length,!1));!d.done;d.next()){for(var R=d.value;a[u].isNewLine;)u+=1;var m=i.clone(g%2==l?r[u]:a[u]);s[g].words[R]=i.clone(m),f+=m.aspectRatio,R-1>=0&&(f+=i.clone(s[g].words[R-1]).spaceAspectRatio),u+=1}s[g].aspectRatio=f}return s},compactRowsIntoAspect:function(t,e,o){var a=t.length;if(a<=1)return t;var r=n.getCombinedAspectOfAllRows(i.clone(t),0),c=n.getTallestRowPairIndex(i.clone(t));if(null==c)return t;for(var s=c+1,l=i.clone(t[c]),h=i.clone(t[s]),p=l.aspectRatio,g=h.aspectRatio,f=p+g,d=0,R=0,m=i.iter(i.toSequence(t));!m.done;m.next()){var y=m.value,v=y.offset,w=y.element;d+=w.aspectRatio,v==c?R+=f:v!=s&&(R+=w.aspectRatio)}var L=d/i.toDouble(a),S=R/i.toDouble(a)/o,k=L/o/i.toDouble(a-1),A=S/i.toDouble(a-2),C=n.aspectStacked(n.aspectDifference(r,n.aspectStacked(g,p)),f),T=n.aspectStacked(A,C),x=n.aspectStacked(k,r);if(u.LockupUtils.percentageDiff(e,x)<=u.LockupUtils.percentageDiff(e,T))return t;var D=i.clone(n.mergeRows(i.clone(t),c,s));return n.compactRowsIntoAspect(i.clone(D),e,o)},compactAutoRowsIntoAspect:function(t,e,o,a,r,c){var s=t.length;if(s<=1)return t;var l=n.getCombinedAspectOfAllRows(i.clone(t),0),h=n.getTallestRowPairIndex(i.clone(t));if(null==h)return t;for(var p=h+1,g=i.clone(t[h]),f=i.clone(t[p]),d=g.aspectRatio,R=f.aspectRatio,m=d+R,y=0,v=0,w=i.iter(i.toSequence(t));!w.done;w.next()){var L=w.value,S=L.offset,k=L.element;y+=k.aspectRatio,S==h?v+=m:S!=p&&(v+=k.aspectRatio)}var A=y/i.toDouble(s),C=v/i.toDouble(s)/o,T=A/o/i.toDouble(s-1),x=C/i.toDouble(s-2),D=n.aspectStacked(n.aspectDifference(l,n.aspectStacked(R,d)),m),I=n.aspectStacked(x,D),b=n.aspectStacked(T,l);if(u.LockupUtils.percentageDiff(e,b)<=u.LockupUtils.percentageDiff(e,I))return t;var M=i.clone(n.mergeAutoRows(i.clone(t),h,p,i.clone(a),i.clone(r),c));return n.compactAutoRowsIntoAspect(i.clone(M),e,o,i.clone(a),i.clone(r),c)},getOptimalCompactedAutoRows:function(t,e,o,a,r,c){var s=t.length;if(s<=1)return t;var l=n.getCombinedAspectOfAllRows(i.clone(t),0),h=n.getTallestRowPairIndex(i.clone(t));if(null==h)return t;for(var p=h+1,g=i.clone(t[h]),f=i.clone(t[p]),d=g.aspectRatio,R=f.aspectRatio,m=d+R,y=0,v=0,w=i.iter(i.toSequence(t));!w.done;w.next()){var L=w.value,S=L.offset,k=L.element;y+=k.aspectRatio,S==h?v+=m:S!=p&&(v+=k.aspectRatio)}var A=y/i.toDouble(s),C=v/i.toDouble(s)/r,T=A/r/i.toDouble(s-1),x=C/i.toDouble(s-2),D=n.aspectStacked(n.aspectDifference(l,n.aspectStacked(R,d)),m),I=n.aspectStacked(x,D),b=n.aspectStacked(T,l);if(u.LockupUtils.percentageDiff(a,b)<=u.LockupUtils.percentageDiff(a,I))return t;var M=i.clone(n.mergeAutoRows(i.clone(t),h,p,i.clone(e),i.clone(o),c));return n.compactAutoRowsIntoAspect(i.clone(M),a,r,i.clone(e),i.clone(o),c)},_implements:function(t){return"LockupLayoutStrategy"==t}},props:{supportsConfiguration:function(t){return t.style.layout==l.LockupLayout.FitJustified},layout:function(t){var e=t.text,o=t.style.font.fontData,a=t.containerSize,s=a.width,u=a.height,R=t.style,m=R.spacing*this.spacingScalar,y=s,v=u,w=y/v,L=i.clone(t.characterStyleRanges);R.alignment!=l.LockupAlignment.UNSET&&r.CoreAssert.warning("Unexpected alignment "+R.alignment+" for fit-justified text");var S=o.allCapsAllowed?e.toUpperCase():e,k=c.getTypographicBoundingRatiosOfString(S,o),A=p.TypeLockupController.HIGHLIGHT_STYLE,C=i.opt(i.opt(R.characterStyles[A],function(t){return t.font}),function(t){return t.fontData}),T=g.TypeLockupUtils.getCharFontAdjust(R,k.hasUppercase),x=!1;t.characterStyleRanges.length>0&&null!=R.characterStyles[A]&&-1!=R.characterStyles[A].spacing&&0!=R.characterStyles[A].spacing&&R.characterStyles[A].spacing>1&&((R=t.style.clone()).characterStyles[A].spacing=T,L=i.clone(g.TypeLockupUtils.invertRanges(i.clone(t.characterStyleRanges),e.length)),x=!0,null!=C&&(C=o,o=R.characterStyles[A].font.fontData,R.characterStyles[A].font=R.font));for(var D=i.clone(g.TypeLockupUtils.computeLockupMeasurements(S,o,k.heightRatio,o.allCapsAllowed,t.forceLetterForma,R.tracking,i.clone(L),i.clone(R.characterStyles),T,t.forceLetterForma)),I=i.clone(this.getUncompactedRows(i.clone(D),!1)),b=i.clone(n.compactRowsIntoAspect(i.clone(I),w,m)),M=0,B=i.iter(D);!B.done;B.next())M+=(lt=B.value).isNewLine?0:1;if(null!=t.rowWordLengths&&t.rowWordLengths.reduce(function(t,e){return t+e},0)==M&&(!t.allowFewerLineBreaks||b.length>=t.rowWordLengths.length)&&(b=i.clone(this.getPrecomputedRows(i.clone(D),i.clone(t.rowWordLengths)))),D.length>1&&(t.highlightMethod==p.HighlightMethod.EvenRows||t.highlightMethod==p.HighlightMethod.OddRows)&&""!=A&&null!=R.characterStyles[A]&&null!=C){var H=i.clone(g.TypeLockupUtils.computeLockupMeasurements(S,o,k.heightRatio,o.allCapsAllowed,!1,R.tracking,i.clone([]),i.clone({}))),z=[new f.TextRange(0,i.chars(e).length)],P=i.clone(g.TypeLockupUtils.computeLockupMeasurements(S,C,k.heightRatio,o.allCapsAllowed,!1,R.tracking,i.clone(z),i.clone(R.characterStyles),T)),O=i.clone(this.getUncompactedAutoRows(i.clone(H),i.clone(P),!1,t.highlightMethod));b=i.clone(n.getOptimalCompactedAutoRows(i.clone(O),i.clone(H),i.clone(P),w,m,t.highlightMethod))}if(0==b.length)return c.LayoutResults.init_8322([],new d.TheoSize(0,0),h.Matrix2D.Identity,k,0);var F=n.getAverageRowAspect(i.clone(b)),_=F/m,U=n.getCombinedAspectOfAllRowsFinal(i.clone(b),_);U<w?y=v*U:v=y/U;for(var W=y/_,E=v,G=y,Y=0,j=0,N=[],V=i.iter(i.range(0,b.length,!1));!V.done;V.next()){var X=V.value,q=i.clone(b[X]),J=q.rowHeightAdjustRatio<1?q.rowHeightAdjustRatio:1,Q=y/(isFinite(q.aspectRatio)?q.aspectRatio:1)*J,Z=c.getTypographicBoundingRatiosOfString(q.text,o);j=0,J<1&&(j+=(y-q.aspectRatio*Q)/2);for(var K=Q/k.heightRatio,$=K*T,tt=K*o.capRatio,et=k.textVerticalOffsetRatio,ot=k.heightRatio,nt=Z.textVerticalOffsetRatio,at=et-(ot/2-Z.heightRatio/2)-nt,it=g.TypeLockupUtils.getCharFontYAdjust(R,K,$),rt=(k.textVerticalOffsetRatio-o.capRatio-at)*K,ct=Y+0,st=i.iter(i.range(0,q.words.length,!1));!st.done;st.next()){var lt,ut=st.value,ht=(lt=i.clone(q.words[ut])).aspectRatio*Q,pt=lt.spaceAspectRatio*Q,gt=j,ft=o.allCapsAllowed?lt.text.toUpperCase():lt.text,dt=i.isEmpty(lt.characterStyle)?K:$,Rt=i.isEmpty(lt.characterStyle)||1!=J?0:it,mt=i.isEmpty(lt.characterStyle)?null:lt.characterStyle;x&&(mt=i.isEmpty(lt.characterStyle)?A:null);var yt=i.clone(c.LockupItem.init_e7b2(!0,mt,new d.TheoSize(ht,tt),h.Matrix2D.translationXY(gt,ct+rt+Rt),ft,i.isEmpty(lt.characterStyle)?o:C||o,dt,K,Z,X,lt.rangeInLockup));N.push(i.clone(yt)),j+=ht+pt}Y+=J<1?$*k.heightRatio+W:Q+W}return c.LayoutResults.init_8322(i.clone(N),new d.TheoSize(G,E),h.Matrix2D.translationXY(0,0),k,F)},calculateTracking:function(t,e){var o=t.text,a=t.style.font.fontData,r=t.containerSize,s=r.width,l=r.height,u=t.style,h=u.spacing*this.spacingScalar,d=l,R=a.allCapsAllowed?o.toUpperCase():o,m=c.getTypographicBoundingRatiosOfString(R,a),y=0,v=p.TypeLockupController.HIGHLIGHT_STYLE,w=i.opt(i.opt(u.characterStyles[v],function(t){return t.font}),function(t){return t.fontData}),L=1;null!=w&&(L=m.hasUppercase?a.capRatio/w.capRatio:a.meanRatio/w.meanRatio);var S=i.clone(g.TypeLockupUtils.computeLockupMeasurements(R,a,m.heightRatio,!1,!0,u.tracking,i.clone(t.characterStyleRanges),i.clone(u.characterStyles),L,t.forceLetterForma));if(0==S.length)return t.style.tracking;var k=i.clone(this.getUncompactedRows(i.clone(S),!1)),A=e.width/e.height,C=i.clone(n.compactRowsIntoAspect(i.clone(k),A,h));if(S.length>1&&(t.highlightMethod==p.HighlightMethod.EvenRows||t.highlightMethod==p.HighlightMethod.OddRows)&&""!=v&&null!=u.characterStyles[v]&&null!=w){var T=i.clone(g.TypeLockupUtils.computeLockupMeasurements(R,a,m.heightRatio,a.allCapsAllowed,!0,u.tracking,i.clone([]),i.clone({}),void 0,t.forceLetterForma)),x=[new f.TextRange(0,i.chars(o).length)],D=i.clone(g.TypeLockupUtils.computeLockupMeasurements(R,w,m.heightRatio,a.allCapsAllowed,!0,u.tracking,i.clone(x),i.clone(u.characterStyles),L,t.forceLetterForma)),I=i.clone(this.getUncompactedAutoRows(i.clone(T),i.clone(D),!1,t.highlightMethod));C=i.clone(n.getOptimalCompactedAutoRows(i.clone(I),i.clone(T),i.clone(D),A,h,t.highlightMethod))}if(0==C.length)return t.style.tracking;if(u.tracking>0)for(var b=i.iter(i.range(0,C.length,!1));!b.done;b.next()){var M=b.value;C[M].aspectRatio=0;for(var B=i.iter(i.range(0,C[M].words.length,!1));!B.done;B.next()){var H=B.value;C[M].aspectRatio+=C[M].words[H].aspectRatio,C[M].words[H].canBreak&&H!=C[M].words.length-1?(C[M].words[H].spaceAspectRatio=a.spaceWidthRatio/m.heightRatio,C[M].aspectRatio+=C[M].words[H].spaceAspectRatio):C[M].words[H].spaceAspectRatio=0}}var z=n.getAverageRowAspect(i.clone(C))/h,P=d*n.getCombinedAspectOfAllRows(i.clone(C),z)/(isFinite(C[0].aspectRatio)?C[0].aspectRatio:1),O=C[0].aspectRatio*P;if(O<s)if(C[0].words.length<=1)y=0;else{var F=(s-O)/i.toDouble(C[0].words.length-1);y=F<1?0:F/(P/m.heightRatio)}else y=-O;return y},calculateLeading:function(t,e){var o=t.text,a=t.style.font.fontData,r=t.containerSize,s=r.width,l=r.height,u=t.style,h=0,d=a.allCapsAllowed?o.toUpperCase():o,R=c.getTypographicBoundingRatiosOfString(d,a),m=u.tracking,y=p.TypeLockupController.HIGHLIGHT_STYLE,v=i.opt(i.opt(u.characterStyles[y],function(t){return t.font}),function(t){return t.fontData}),w=1;null!=v&&(w=R.hasUppercase?a.capRatio/v.capRatio:a.meanRatio/v.meanRatio);var L=i.clone(g.TypeLockupUtils.computeLockupMeasurements(d,a,R.heightRatio,!1,!0,m,i.clone(t.characterStyleRanges),i.clone(u.characterStyles),w,t.forceLetterForma));if(0==L.length)return t.style.spacing;var S=i.clone(this.getUncompactedRows(i.clone(L),!1)),k=e.width,A=e.height,C=k/A,T=i.clone(n.compactRowsIntoAspect(i.clone(S),C,t.style.spacing));if(L.length>1&&(t.highlightMethod==p.HighlightMethod.EvenRows||t.highlightMethod==p.HighlightMethod.OddRows)&&""!=y&&null!=u.characterStyles[y]&&null!=v){var x=i.clone(g.TypeLockupUtils.computeLockupMeasurements(d,a,R.heightRatio,a.allCapsAllowed,!0,u.tracking,i.clone([]),i.clone({}),void 0,t.forceLetterForma)),D=[new f.TextRange(0,i.chars(o).length)],I=i.clone(g.TypeLockupUtils.computeLockupMeasurements(d,v,R.heightRatio,a.allCapsAllowed,!0,u.tracking,i.clone(D),i.clone(u.characterStyles),w,t.forceLetterForma)),b=i.clone(this.getUncompactedAutoRows(i.clone(x),i.clone(I),!1,t.highlightMethod));T=i.clone(n.getOptimalCompactedAutoRows(i.clone(b),i.clone(x),i.clone(I),C,h,t.highlightMethod))}if(T.length<=1)return u.spacing;var M=n.getAverageRowAspect(i.clone(T))/h;if((A=k/n.getCombinedAspectOfAllRows(i.clone(T),M))<l){var B=s/((l-A)/(i.toDouble(T.length)-1));h=T[0].aspectRatio/B/this.spacingScalar}else h=-A;return h},getUncompactedRows:function(t,e){for(var o=[],n=0;n<t.length;){var a=i.clone(t[n]),r=i.clone(s.LockupRowInfo.init_d97e());if(a.isNewLine)o.length>0&&(o[o.length-1].appendable=!1);else{if(!e)for(;!a.canBreak&&n<t.length;)r.addWord(i.clone(a)),(n+=1)<t.length&&(a=i.clone(t[n]));r.addWord(i.clone(a)),o.push(i.clone(r))}n+=1}return o},getUncompactedAutoRows:function(t,e,o,n){r.CoreAssert.isTrue(t.length==e.length);for(var a=[],c=0,l=n==p.HighlightMethod.EvenRows?0:1,u=0;u<t.length;){var h=i.clone(c%2==l?e[u]:t[u]),g=i.clone(s.LockupRowInfo.init_d97e());if(h.isNewLine)a.length>0&&(a[a.length-1].appendable=!1);else{if(!o)for(;!h.canBreak&&u<t.length;)g.addWord(i.clone(h)),(u+=1)<t.length&&(h=i.clone(t[u]));g.addWord(i.clone(h)),a.push(i.clone(g)),c+=1}u+=1}return a}}}),n)},442:function(t,e,o){var n,a=e,i=o(0),r=o(138),c=o(71),s=o(17),l=o(9),u=o(204),h=o(14),p=o(10);a.LetterDecorationStrategy=(n=function(){r.BaseDecorationStrategy.call(this)},i.defineClass({name:"LetterDecorationStrategy",ctor:n,superName:"BaseDecorationStrategy",statics:{_implements:function(t){return"LockupDecorationStrategy"==t}},props:{supportsConfiguration:function(t){return s.LockupStyle.isLetterGrid(t.style.layout)},decorate:function(t,e){var o,n,a,u=[];if(0==e.items.length)return new r.DecorationResults(i.clone(u));var g,f,d,R=t.style,m=R.font.fontData;R.backing==s.LockupBacking.SVGBackground&&(g=R.backingArtworkID);var y,v,w,L=0;if(0==!t.characterStyleRanges.length&&(f=R.characterStyles[h.TypeLockupController.HIGHLIGHT_STYLE],d=i.opt(f.font,function(t){return t.fontData}),L=f.padding,f.backing==s.LockupBacking.SVGBackground&&(y=f.backingArtworkID)),null==g&&null==y)return new r.DecorationResults(i.clone(u));for(var S=i.iter(i.toSequence(e.items));!S.done;S.next()){var k=S.value,A=k.offset,C=k.element,T=m,x=g,D=!1;if(C.characterStyle==h.TypeLockupController.HIGHLIGHT_STYLE&&(D=!0,T=d||T,x=(o=y)||null!=o?o:g),null!=x){var I=p.TheoRect.fromXYWH(C.placement.tx,C.placement.ty,C.size.width,C.size.height).outsetXY((n=i.opt(C.margins,function(t){return t.width}))||null!=n?n:0,(a=i.opt(C.margins,function(t){return t.height}))||null!=a?a:0),b=D?w:v;null==b&&(b=this.getSVGConfig(t.style,D?L:null,i.clone(e),x,i.clone(C),I),D?w=b:v=b);var M=(e.typographicBoundingRatios.textVerticalOffsetRatio-T.capRatio)*C.pointSize;u.push(i.clone(c.LockupItem.init_9cc6(!1,b.frame.size,l.Matrix2D.translation(b.frame.origin).translate(I.origin).translateXY(0,-M),x,b.preScale,A+e.numberOfLines,C.characterStyle)))}}return new r.DecorationResults(i.clone(u))},getSVGConfig:function(t,e,o,n,a,r){var s=i.clone(c.LayoutResults.init_8322([a],r.size,o.placement,o.typographicBoundingRatios,o.avgRowAspect)),l=t;return null!=e&&((l=t.clone()).padding=e),new u.SVGBackgroundDecorationStrategy(n).calcSVGConfiguration(l,i.clone(s))}}}),n)},443:function(t,e,o){var n,a,i=e,r=o(0),c=o(444),s=o(8),l=o(71),u=o(201),h=o(17),p=o(326),g=o(9),f=o(14),d=o(72),R=o(95),m=o(28);i.LetterGridLayoutStrategy=(n=function(){this.trackingScalar=3,this.spacingScalar=3,l.BaseLockupLayoutStrategy.call(this)},r.defineClass({name:"LetterGridLayoutStrategy",ctor:n,superName:"BaseLockupLayoutStrategy",statics:{_implements:function(t){return"LockupLayoutStrategy"==t}},props:{supportsConfiguration:function(t){return h.LockupStyle.isLetterGrid(t.style.layout)},layout:function(t){var e=[],o=0,n=0,a=0,i=this.getWireframeLayout(t),c=i.typographicBoundingRatios,s=r.clone(i.rows);if(0==!s.length){var u=i.horizontalPaddingRatio,h=i.verticalPaddingRatio,p=this.getCombinedAspectRatio(r.clone(s),u,h);p<i.constraintAspectRatio?(n=i.constraintHeight,o=i.constraintHeight*p):(o=i.constraintWidth,n=i.constraintWidth/p);var R=t.style,y=i.font,v=n/r.toDouble(s.length),w=v/(1+h),L=h*w,S=u*w,k=w/c.heightRatio;i.charFontAdjustRatio>1&&(k/=i.charFontAdjustRatio);for(var A=k*y.capRatio,C=k*c.textVerticalOffsetRatio-A,T=r.opt(r.opt(R.characterStyles[f.TypeLockupController.HIGHLIGHT_STYLE],function(t){return t.font}),function(t){return t.fontData})||y,x=k*i.charFontAdjustRatio,D=d.TypeLockupUtils.getCharFontYAdjust(R,k,x),I=L/2+C,b=r.iter(r.toSequence(s));!b.done;b.next()){var M=b.value,B=M.offset,H=M.element;if(0==!H.words.length)for(var z=r.first(H.words).aspectRatio*w,P=z+S,O=S/2+H.colOffsetLeft*P,F=r.iter(H.words);!F.done;F.next()){var _=F.value,U=_.characterStyle,W=U==f.TypeLockupController.HIGHLIGHT_STYLE,E=W?T:y,G=W?x:k,Y=_.relativeMargins.multiply(w),j=Y.width,N=O+j,V=I+(W?D:0),X=r.clone(l.LockupItem.init_e7b2(!0,U,new m.TheoSize(z-2*j,A),g.Matrix2D.translationXY(N,V),_.text,E,G,k,c,B,_.rangeInLockup,Y));e.push(r.clone(X)),O+=P}I+=v}a=this.getWidestRowAndAspectRatio(r.clone(s),u,h).aspectRatio}return l.LayoutResults.init_8322(r.clone(e),new m.TheoSize(o,n),g.Matrix2D.Identity,c,a)},getCharacterStyle:function(t,e,o){for(var n=r.iter(t);!n.done;n.next()){var a=n.value;if(e>=a.start&&e<a.end)return f.TypeLockupController.HIGHLIGHT_STYLE}return""},getWireframeLayout:function(t,e){void 0===e&&(e=null);for(var o=t.text.toUpperCase(),n=t.style,a=n.alignment,h=t.containerSize,g=(e||h).width,y=(e||h).height,v=g/y,w=n.spacing*this.spacingScalar,L=n.tracking*this.trackingScalar,S=n.font.fontData,k=l.getTypographicBoundingRatiosOfString(o,S,!1),A=0,C=0,T=[],x=r.opt(r.opt(n.characterStyles[f.TypeLockupController.HIGHLIGHT_STYLE],function(t){return t.font}),function(t){return t.fontData})||S,D=d.TypeLockupUtils.getCharFontAdjust(n,k.hasUppercase,!1),I=32*D,b=[],M=r.iter(r.toSequence(r.chars(o)));!M.done;M.next()){var B=M.value,H=B.offset,z=B.element,P=r.toString(z);if(d.TypeLockupUtils.isWhiteSpace(P)){if("\n"==P){var O=C;C=H-A,T.push(C-O)}A+=1}var F=this.getCharacterStyle(r.clone(t.characterStyleRanges),H,H+1)==f.TypeLockupController.HIGHLIGHT_STYLE,_=F?x:S,U=F?I:32,W=s.Host.textModelUtils.measureInkBounds(P,_,U);b.push(W.width)}var E=b.length-A;T.push(E-C);for(var G=Math.max(32,I)*k.heightRatio,Y=r.max(b)/G,j=(Y+L)/(1+w),N=c.GridArrangementUtils.getArrangement(v,j,E,r.clone(T)),V=(N.numRows,N.numCols),X=r.clone(u.LockupRowInfo.init_d97e()),q=[],J=(H=0,r.iter(r.chars(o)));!J.done;J.next()){if(z=J.value,P=r.toString(z),d.TypeLockupUtils.isWhiteSpace(P))"\n"==z&&(this.commitRow(q,r.clone(X),V,a),X=r.clone(u.LockupRowInfo.init_d97e()));else{P=r.toString(z);var Q=(Y-b[H]/G)/2,Z=r.clone(p.LockupWordInfo.init_e9d6(P,Y,0,this.getCharacterStyle(r.clone(t.characterStyleRanges),H,H+1),1,!1,!0,new R.TextRange(H,H+1),new m.TheoSize(Q,0)));X.words.length==V&&(this.commitRow(q,r.clone(X),V,a),X=r.clone(u.LockupRowInfo.init_d97e())),X.addWord(r.clone(Z))}H+=1}return this.commitRow(q,r.clone(X),V,a),i.WireframeLayout.init_c604(S,k,D,g,y,v,L,w,r.clone(q),V)},commitRow:function(t,e,o,n){var a=r.toDouble(o-e.words.length);n==h.LockupAlignment.Right?e.colOffsetLeft=a:n==h.LockupAlignment.Center&&(e.colOffsetLeft=a/2,e.colOffsetRight=a/2),t.push(r.clone(e))},calculateTracking:function(t,e){var o=this.getWireframeLayout(t,e),n=r.clone(o.rows);if(0==n.length)return t.style.tracking;var a=this.getCombinedAspectRatio(r.clone(n),0,o.verticalPaddingRatio),i=o.constraintHeight*a,c=t.containerSize.width;if(i<c){var s=r.toDouble(n.length);return(c-i)/r.toDouble(o.numCols)/(o.constraintHeight/s/(1+o.verticalPaddingRatio))/this.trackingScalar}return-i},calculateLeading:function(t,e){var o=this.getWireframeLayout(t,e),n=r.clone(o.rows);if(0==n.length)return t.style.spacing;var a=this.getCombinedAspectRatio(r.clone(n),o.horizontalPaddingRatio,0),i=o.constraintWidth/a,c=t.containerSize.height;if(i<c){var s=r.toDouble(n.length),l=i/s;return(c/s-l)/l/this.spacingScalar}return-i},adjustHeightForLeading:function(t,e,o,n){if(0==!e.items.length){var a=n-o,i=r.clone(r.first(e.items));return r.toDouble(e.numberOfLines)*i.rowPointSize*i.typographicBoundingRatios.heightRatio*a*this.spacingScalar}return 0},adjustWidthForTracking:function(t,e,o,n){var a=this.getNumColsInLayout(r.clone(e));if(a>0){var i=n-o,c=r.clone(r.first(e.items));return c.rowPointSize*c.typographicBoundingRatios.heightRatio*i*this.trackingScalar*r.toDouble(a)}return 0},getNumColsInLayout:function(t){for(var e=0,o=0,n=-1,a=r.iter(t.items);!a.done;a.next()){var i=a.value;n!=i.rowIndex?(n=i.rowIndex,o=1):o+=1,e=Math.max(e,o)}return e},calculateRowAspectRatio:function(t,e,o,n){var a=r.toDouble(t.words.length),i=a+r.toDouble(n),c=t.aspectRatio*i/a;return(c+=i*e)/(1+o)},getWidestRowAndAspectRatio:function(t,e,o){for(var n,a=0,i=r.iter(t);!i.done;i.next()){var c=i.value,s=this.calculateRowAspectRatio(r.clone(c),e,o,r.toInt(c.colOffsetLeft+c.colOffsetRight));s>a&&(n=r.clone(c),a=s)}return{row:n,aspectRatio:a}},getCombinedAspectRatio:function(t,e,o){return this.getWidestRowAndAspectRatio(r.clone(t),e,o).aspectRatio/r.toDouble(t.length)}}}),n),i.WireframeLayout=(a=function(){},r.defineClass({name:"WireframeLayout",ctor:a,props:{init_c604:function(t,e,o,n,a,i,c,s,l,u){this.font=t,this.typographicBoundingRatios=e,this.charFontAdjustRatio=o,this.constraintWidth=n,this.constraintHeight=a,this.constraintAspectRatio=i,this.horizontalPaddingRatio=c,this.verticalPaddingRatio=s,this.rows=r.clone(l),this.numCols=u},init_implicit:function(t,e,o,n,a,i,c,s,l,u){this.font=t,this.typographicBoundingRatios=e,this.charFontAdjustRatio=o,this.constraintWidth=n,this.constraintHeight=a,this.constraintAspectRatio=i,this.horizontalPaddingRatio=c,this.verticalPaddingRatio=s,this.rows=r.clone(l),this.numCols=u}}}),a)},444:function(t,e,o){var n,a=e,i=o(0);a.GridArrangementUtils=(n=function(){},i.defineClass({name:"GridArrangementUtils",ctor:n,statics:{MAX_COLS:100,ASPECT_RATIO_EPSILON:.005,getArrangement:function(t,e,o,a){var r=i.max(a),c=t*i.toDouble(o)/i.toDouble(r),s=n.getBestFittingArrangement(c,e,r),l=s.numCols,u=n.evaluateAllSegments(t,e,o,i.clone(a),l),h=u.penalty,p=u.aspectRatioDelta;if(0!=h)for(var g=n.getColumnCountSearchRange(o,l),f=i.iter(i.range(g.start,g.end,!0));!f.done;f.next()){var d=f.value;if(d!=s.numCols){var R=(u=n.evaluateAllSegments(t,e,o,i.clone(a),d)).penalty,m=u.aspectRatioDelta;(R<h||R==h&&m<p)&&(l=d,h=R,p=m)}}return{numRows:n.getNumRows(o,l),numCols:l}},getNumRows:function(t,e){return i.toInt(t/e)+(t%e==0?0:1)},getGridAspectRatio:function(t,e,o){var a=n.getNumRows(e,o);return i.toDouble(o)/i.toDouble(a)*t},getBestFittingArrangement:function(t,e,o,a,r){var c,s;void 0===a&&(a=1),void 0===r&&(r=n.MAX_COLS);var l=Math.min(o,r);if(a<l){c=i.toInt((a+l)/2),s=n.getGridAspectRatio(e,o,c);var u=Math.abs(t-s);if(u>n.ASPECT_RATIO_EPSILON){var h,p=(h=s<t?n.getBestFittingArrangement(t,e,o,c+1,l):n.getBestFittingArrangement(t,e,o,a,c-1)).numCols,g=h.aspectRatio;Math.abs(t-g)<u&&(c=p,s=g)}}else s=n.getGridAspectRatio(e,o,c=a);return{numCols:c,aspectRatio:s}},evaluateAllSegments:function(t,e,o,a,r){for(var c=0,s=0,l=i.iter(a);!l.done;l.next()){var u=l.value;n.evaluateOneSegment(u,r)||(c+=1),s+=1/n.getGridAspectRatio(e,u,r)}return s=1/s,{penalty:c,aspectRatioDelta:Math.abs(t-s)}},evaluateOneSegment:function(t,e){if(t<=e)return!0;var o=t%e;0==o&&(o=e);var a=i.toDouble(o)/i.toDouble(e),r=.5;return e>4&&n.getNumRows(t,e)>2&&(r=.25),a>=r},getColumnCountSearchRange:function(t,e){var o=Math.min(2,i.toInt(t/6));return{start:Math.max(1,e-o),end:Math.min(e+o,t)}}}}),n)},71:function(t,e,o){var n,a,i,r,c=e,s=o(0),l=o(1),u=o(201),h=o(9),p=o(28);c.LockupItemType=s.defineEnum("LockupItemType",{Text:0,Path:1,Artwork:2}),c.LockupItem=(n=function(){this.isFullCanvas=!1},s.defineClass({name:"LockupItem",ctor:n,props:{init_e7b2:function(t,e,o,n,a,i,r,s,l,u,h,p){void 0===p&&(p=null),this.type=c.LockupItemType.Text,this.hasPrimaryColor=t,this.characterStyle=e,this.size=o,this.placement=n,this.text=a,this.font=i,this.pointSize=r,this.rowPointSize=s,this.typographicBoundingRatios=l,this.rowIndex=u,this.rangeInLockup=h,this.margins=p},init_708e:function(t,e,o,n,a,i,r){void 0===a&&(a=null),void 0===i&&(i=!1),void 0===r&&(r=null),this.type=c.LockupItemType.Path,this.hasPrimaryColor=t,this.size=e,this.placement=o,this.path=n,this.rowIndex=a,this.isFullCanvas=i,this.characterStyle=r},init_9cc6:function(t,e,o,n,a,i,r){void 0===i&&(i=null),void 0===r&&(r=null),this.type=c.LockupItemType.Artwork,this.hasPrimaryColor=t,this.size=e,this.placement=o,this.artworkID=n,this.preScale=a,this.rowIndex=i,this.characterStyle=r},init_implicit:function(t,e,o,n,a,i,r,c,s,l,u,h,p,g,f,d,R){void 0===R&&(R=!1),this.type=t,this.hasPrimaryColor=e,this.size=o,this.placement=n,this.text=a,this.font=i,this.pointSize=r,this.rowPointSize=c,this.rowIndex=s,this.margins=l,this.typographicBoundingRatios=u,this.characterStyle=h,this.rangeInLockup=p,this.path=g,this.artworkID=f,this.preScale=d,this.isFullCanvas=R},clone:function(){return n.init_implicit(this.type,this.hasPrimaryColor,this.size,this.placement,this.text,this.font,this.pointSize,this.rowPointSize,this.rowIndex,this.margins,this.typographicBoundingRatios,this.characterStyle,this.rangeInLockup,this.path,this.artworkID,this.preScale,this.isFullCanvas)}}}),n),c.descenderCharacters="gjqpyQ",c.shortCharacters=" qweryuopasg;zxcvnm,.*-~",c.tallSpecialsThatAreNotCaps="!^'",c.TypographicBoundingRatios=(a=function(t,e,o,n,a,i){this.sideInsetRatio=t,this.textVerticalOffsetRatio=e,this.backingVerticalOffsetRatio=o,this.heightRatio=n,this.heightFromBaselineRatio=a,this.hasUppercase=i},s.defineClass({name:"TypographicBoundingRatios",ctor:a}),a),c.getTypographicBoundingRatiosOfString=function(t,e,o){void 0===o&&(o=!0);for(var n=t.split("\n").join(),a=!1,i=!1,r=!1,l=!1,u=!1,h=!1,p=!1,g=!1,f=!1,d=e.meanRatio,R=0,m=0,y=0,v=0,w=0,L=0,S=s.iter(s.chars(n));!S.done;S.next()){var k=S.value,A=!1,C=!1;" "!=k&&(m+=1,!A&&e.upperCaseCharsArray.includes(k)?A=!0:!C&&e.lowerCaseCharsArray.includes(k)&&(C=!0),!a&&A?a=!0:!i&&C&&(i=!0),e.meanCharsArray.includes(k)?y+=e.meanRatio:e.capCharsArray.includes(k)?(u=!0,y+=e.capRatio):e.ascentCharsArray.includes(k)?(l=!0,y+=e.ascentRatio):e.meanAccentCharsArray.includes(k)?(h=!0,y+=e.meanAccentRatio):e.capAccentCharsArray.includes(k)?(r=!0,y+=e.capAccentRatio):(u=!0,y+=e.capRatio),A&&(m+=1,y+=e.capRatio),A||C||"•"==k||"–"==k||"—"==k||(f=!0),e.tailCharsArray.includes(k)?(p=!0,v+=e.tailRatio):e.descentCharsArray.includes(k)&&(g=!0,v+=e.descentRatio))}if(f&&(d=1),r&&(d=Math.max(d,e.capAccentRatio)),l&&(d=Math.max(d,e.ascentRatio)),u&&(d=Math.max(d,e.capRatio)),h&&(d=Math.max(d,e.meanAccentRatio)),p&&(R=Math.max(R,e.tailRatio)),g&&(R=Math.max(R,e.descentRatio)),m>0&&(w=y/m,L=v/m),o){var T=d-(a?e.capRatio:e.meanRatio);w=d+=Math.max(0,R-T),L=R}var x=R/2,D=e.baselineOffsetRatio+d,I=.8*(d-w-R+L),b=d+R;return new c.TypographicBoundingRatios(x,D,I,b,d,a)},c.LayoutResults=(i=function(){},s.defineClass({name:"LayoutResults",ctor:i,props:{init_8322:function(t,e,o,n,a){for(var i=0,r=0,l=0,u=1e5,h=0,p=0,g=0,f={},d=s.iter(t);!d.done;d.next()){var R=d.value;R.type==c.LockupItemType.Text&&(i+=R.size.height,r+=R.pointSize,l+=1,R.rowIndex<u&&(u=R.rowIndex),R.rowIndex>h&&(h=R.rowIndex),null==f[R.rowIndex]&&(p+=R.pointSize,f[R.rowIndex]=!0),R.pointSize>g&&(g=R.pointSize))}this.items=s.clone(t),this.size=e,this.placement=o,this.numberOfLines=h<u?0:h-u+1,this.avgLinePointSize=p/s.toDouble(this.numberOfLines),this.avgTextItemHeight=i/l,this.avgTextPointSize=r/l,this.largestPointSize=g,this.typographicBoundingRatios=n,this.avgRowAspect=a},flipForRightToLeft:function(){for(var t=this.size.width,e=[],o=s.iter(this.items);!o.done;o.next()){var n=o.value;n.placement=h.Matrix2D.scalingXY(-1,1).translateXY(n.size.width,0).concat(n.placement.scaleXY(-1,1)).translateXY(t,0),e.splice(0,0,s.clone(n))}this.items=s.clone(e)},init_implicit:function(t,e,o,n,a,i,r,c,l,u){this.items=s.clone(t),this.size=e,this.placement=o,this.avgTextItemHeight=n,this.avgTextPointSize=a,this.avgLinePointSize=i,this.largestPointSize=r,this.typographicBoundingRatios=c,this.numberOfLines=l,this.avgRowAspect=u},clone:function(){return i.init_implicit(this.items,this.size,this.placement,this.avgTextItemHeight,this.avgTextPointSize,this.avgLinePointSize,this.largestPointSize,this.typographicBoundingRatios,this.numberOfLines,this.avgRowAspect)}}}),i),c.LockupLayoutStrategy=s.defineProtocol("LockupLayoutStrategy",{supportsConfiguration:"(LockupConfiguration) -> Boolean",layout:"(LockupConfiguration) -> LayoutResults",calculateTracking:"(LockupConfiguration, TheoSize) -> Double",calculateLeading:"(LockupConfiguration, TheoSize) -> Double",adjustHeightForLeading:"(TheoRect, LayoutResults, Double, Double) -> Double",adjustWidthForTracking:"(String, LayoutResults, Double, Double) -> Double"}),c.LockupLayoutStrategyFactory=s.defineProtocol("LockupLayoutStrategyFactory",{supportsConfiguration:"(LockupConfiguration) -> Boolean",createForConfiguration:"(LockupConfiguration) -> LockupLayoutStrategy"}),c.BaseLockupLayoutStrategy=(r=function(){},s.defineClass({name:"BaseLockupLayoutStrategy",ctor:r,statics:{_implements:function(t){return"LockupLayoutStrategy"==t}},props:{supportsConfiguration:function(t){return l.CoreAssert.fail("Implement in subclass"),!1},layout:function(t){return l.CoreAssert.fail("implement in subclass"),c.LayoutResults.init_8322([],new p.TheoSize(0,0),h.Matrix2D.Identity,new c.TypographicBoundingRatios(0,1,0,1,1,!1),0)},calculateTracking:function(t,e){return l.CoreAssert.fail("implement in subclass"),0},calculateLeading:function(t,e){return l.CoreAssert.fail("implement in subclass"),0},adjustHeightForLeading:function(t,e,o,n){var a=n-o;return s.toDouble(e.numberOfLines-1)*(t.width/e.avgRowAspect)*(.75*a)},adjustWidthForTracking:function(t,e,o,n){var a=0,i=n-o;if(0!=i){for(var r=-1,c=0,l=0,u=0,h=0,p=t,g=s.iter(e.items);!g.done;g.next()){var f=g.value;f.rowIndex!=r?(u>h&&(h=u,a=c),l=f.placement.tx,c=0):c+=i*f.pointSize,c+=i*f.pointSize*s.toDouble(f.text.length-1),u=f.placement.tx+f.size.width-l,f.rangeInLockup.start>0&&" "==p.substr(f.rangeInLockup.start-1,1)&&l!=f.placement.tx&&(n<0?c-=i*f.pointSize:c+=i*f.pointSize),r=f.rowIndex}u>h&&(h=u,a=c)}return a},getPrecomputedRows:function(t,e){var o=[];if(0==t.length||0==e.length)return o;for(var n=s.clone(u.LockupRowInfo.init_d97e()),a=0,i=0,r=s.iter(t);!r.done;r.next()){var c=r.value;c.isNewLine||(i>=e[a]&&(o.push(s.clone(n)),n=s.clone(u.LockupRowInfo.init_d97e()),a+=1,i=0),n.addWord(s.clone(c)),i+=1)}return o.push(s.clone(n)),o}}}),r)}}]);
//# sourceMappingURL=logomaker-entry_67d3788f-38f9cfba.js.map