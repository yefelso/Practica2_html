(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{238:function(e,t,n){var i,o,a=t,r=n(0),l=n(196),s=n(1),u=n(4),m=n(19),c=n(104),y=n(11),p=n(62),d=n(26),f=n(29),T=n(25),h=n(8),v=n(89),A=n(21),F=n(136),S=n(91),g=n(80),b=n(17),I=n(9),k=n(254),L=n(105),x=n(37),D=n(35),C=n(22),M=n(30),_=n(58),E=n(14),O=n(72),w=n(15),N=n(48),P=n(125),K=n(73);a.AnimationLibrary=(i=function(){u.CoreObject.call(this);for(var e=r.clone(k.MotionFacade.createAllAnimationStyles()),t=r.iter(e);!t.done;t.next()){var n=t.value;i.animationStyles.push(n)}},o={},r.defineClass({name:"AnimationLibrary",ctor:i,superName:"CoreObject",statics:{animationStyles:{get:function(){return void 0===o.animationStyles&&(o.animationStyles=[l.AnimationStyle.init_b946(l.AnimationStyle.NAME_NO_STYLE),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_TYPE,0,3,l.AnimationStyleCategory.Text),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_DYNAMIC,0,4,l.AnimationStyleCategory.Text),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_FLICKER,0,3,l.AnimationStyleCategory.Text),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_COLORSWAP,0,3,l.AnimationStyleCategory.Text),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_FADE,0,3,l.AnimationStyleCategory.Text),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_SLIDE,0,3,l.AnimationStyleCategory.Text),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_GROW,0,2,l.AnimationStyleCategory.Text),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_ZOOM,0,2,l.AnimationStyleCategory.Image),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_PAN,0,2,l.AnimationStyleCategory.Image),l.AnimationStyle.init_b946(l.AnimationStyle.NAME_GRAYSCALE,l.AnimationStyleCategory.Image),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_BLUR,0,1,l.AnimationStyleCategory.Image),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_COLOR,0,5,l.AnimationStyleCategory.Image),l.AnimationStyle.init_e14f(l.AnimationStyle.NAME_FILL,0,5,l.AnimationStyleCategory.Image)]),o.animationStyles},set:function(e){o.animationStyles=e}},determineAnalyticName:function(e){var t="";if(e=e){switch(e.name){case"Type":t="Typewriter";break;case"ColorSwap":t="ColorShuffle";break;default:t=e.name}t=(t+e.variant).toLowerCase()}else t=(l.AnimationStyle.NAME_NO_STYLE+0).toLowerCase();return t},getDisplayableAnimationStyles:function(e){var t=!1,n=!1,o=!1,a=!1,s=!1,u=!1,m=!1;e.visitAll(y.FormaTraversal.PreOrder,function(e){var i,l;if(e.isBackgroundImage()&&(a=!0),T.GridController.isBackgroundColoredCell(e)&&(s=!0),u||(u=T.GridController.hasLayoutPadding(e)),e.kind==_.TextForma.KIND&&(t=!0),(i=S.ImageFacade.getImageFormaForForma(e))&&(l=r.as(i.style,g.ImageStyle))&&l.isColorizedFilter&&(m=!0),e.style instanceof b.LockupStyle){var c=e.style;c.backing==b.LockupBacking.Knockout&&(n=!0),b.LockupStyle.isKnockoutLook(c.textLook)||(o=!0)}});for(var c=[],p=r.iter(i.animationStyles);!p.done;p.next()){var d=p.value;if((t||d.name!=l.AnimationStyle.NAME_FLICKER&&d.name!=l.AnimationStyle.NAME_DYNAMIC&&d.name!=l.AnimationStyle.NAME_TYPE)&&(a||!d.imageStyle)&&(t||!d.textStyle)){var f=d.clone();d.name==l.AnimationStyle.NAME_GROW&&n?f.variantCount=3:d.name==l.AnimationStyle.NAME_GROW&&!o||d.name==l.AnimationStyle.NAME_SLIDE&&!o?f.variantCount=1:d.name!=l.AnimationStyle.NAME_DYNAMIC||o?d.name!=l.AnimationStyle.NAME_COLORSWAP||s||m||u||(f.variantCount=2):f.variantCount=3,c.push(f)}}return c},isPremiumAnimationStyle:function(e){return e.name==l.AnimationStyle.NAME_TYPE&&2==e.variant||e.name==l.AnimationStyle.NAME_FLICKER&&2==e.variant||e.name==l.AnimationStyle.NAME_DYNAMIC&&0==e.variant},isAnimationStyleApplicable:function(e,t){var n,o=!1;if(n=r.as(t.firstPage.root,D.RootForma))for(var a=r.clone(i.getDisplayableAnimationStyles(n)),l=r.iter(a);!l.done;l.next())if(l.value.name==e.name){o=!0;break}return o},updateCurrentStyle:function(e){var t,n,o;(t=L.MotionUtils.getCurrentAnimationStyle(e))&&(t.isNoStyle()||((n=r.as(e.firstPage.root,D.RootForma))?(o=i.isAnimationStyleApplicable(t,e)?t:e.firstPage.animationLibrary.getAnimationStyle(l.AnimationStyle.NAME_NO_STYLE),e.firstPage.animationLibrary.applyStyle(o,n)):r.opt(h.Host.logging,function(e){return e.warning("Missing root")})))}},props:{getAnimationStyle:function(e){for(var t,n=r.iter(i.animationStyles);!n.done;n.next()){var o=n.value;if(e==o.name){t=o;break}}return t},getNextAnimationStyleOfSameType:function(e){var t=e.clone();return t.variantCount>0&&(t.variant=(t.variant+1)%t.variantCount),t},getAllAnimationStyles:function(){return i.animationStyles},setStillAnimation:function(e,t,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var o=n||t.startTime,a=i||t.endTime,r=[];r.push(new p.KeyFrame(o,P.TimingFunctionType.Linear)),r.push(new p.KeyFrame(a,P.TimingFunctionType.Linear)),e.animation=new p.FormaAnimation(t,o,a,r)},setScaleForma:function(e,t,n,i,o,a,l){var s,u=new w.TheoPoint(1,1),m=e.style.clone(),c=e.style.clone();(s=r.as(e.style,b.LockupStyle))&&s.backing==b.LockupBacking.Knockout&&2==t.variant?(c=L.MotionUtils.createOpacityStyle(e,0),u=new w.TheoPoint(20,20)):m=L.MotionUtils.createOpacityStyle(e,0);var y=e.frame,d=e.placement.inverse.transformPoint(y.eval(i)),f=I.Matrix2D.scaling(n),T=e.placement.concat(f).transformPoint(d),h=y.center.subtract(T),v=I.Matrix2D.scaling(u),A=e.placement.concat(v).transformPoint(d),F=y.center.subtract(A),S=[],g=I.Matrix2D.scaling(n).translate(h),k=I.Matrix2D.scaling(u).translate(F),x=a,D=l;if(2==t.variant){S.push(new p.KeyFrame(a,o,g,null,m));var C=new N.TheoTime(t.endTime.timescale,t.endTime.timescale);x=a.add(C),D=l.add(C)}S.push(new p.KeyFrame(x,o,g,null,m)),S.push(new p.KeyFrame(D,o,k,null,c)),e.animation=new p.FormaAnimation(t,a,D,S)},setGrowAnimation:function(e,t,n){if(1==t.variant||1==t.variantCount){var i=t.endTime.multiply(2/3);this.setScaleForma(e,t,new w.TheoPoint(.8,.8),new w.TheoPoint(.5,.5),P.TimingFunctionType.EaseOut,t.startTime,i)}else if(0==t.variant){var o=t.endTime.subtract(l.AnimationStyle.FADE_DURATION);r.containsEq(n,e,y._equality_Forma_Forma)?this.setScaleForma(e,t,new w.TheoPoint(.75,.75),new w.TheoPoint(.5,.5),P.TimingFunctionType.EaseOut,t.startTime,o):this.setFormaFade(e,t,t.startTime,t.endTime,o)}else 2==t.variant&&this.setScaleForma(e,t,new w.TheoPoint(1,1),new w.TheoPoint(.5,.5),P.TimingFunctionType.EaseOut,t.startTime,t.endTime)},getCenteredTransform:function(e,t,n){var i=e.parent.frame.center.subtract(new w.TheoPoint(e.parent.frame.minX,e.parent.frame.minY)),o=e.placement.inverse.transformPoint(i),a=I.Matrix2D.scalingXY(t,t),r=e.placement.concat(a).transformPoint(o),l=i.subtract(r);return I.Matrix2D.scalingXY(t,t).translate(l.add(n))},setImageAnimation:function(e,t,n,i,o){var a;if(a=r.as(r.opt(e.parent,function(e){return e.controller}),d.FrameController)){if(!e.parent.isBackgroundImage())return;for(var l=1,s=e.placement,u=r.iter(i);!u.done;u.next()){var m=u.value,c=m[1],y=m[2],f=this.getCenteredTransform(e,y,c);e.placement=s,e.move(f);var T=e.placement;a.fitChildrenToFrame();var h=e.placement.transformValues.xscale-T.transformValues.xscale,v=new w.TheoPoint(e.placement.tx-T.tx,e.placement.ty-T.ty);if(e.placement=s,o&&(v.length()>1||h>0)){var A=e.frame;l=Math.max(l,1+h+3*Math.max(Math.abs(v.x)/A.width,Math.abs(v.x)/A.height))}}for(var F=[],S=r.iter(i);!S.done;S.next()){var g=S.value,b=g[0],I=(c=g[1],y=g[2],this.getCenteredTransform(e,y*l,c));F.push(new p.KeyFrame(b,n,I,null,null))}e.animation=new p.FormaAnimation(t,t.startTime,t.endTime,F)}},applyLineFadeIn:function(e,t,n,i,o){var a,l=i.subtract(n),s=o;s.seconds*r.toDouble(e.length)>l.seconds/2&&(s=l.multiply(1/r.toDouble(2*e.length)));for(var u=l.subtract(s.multiply(r.toDouble(e.length))),m=n,c=r.iter(e);!c.done;c.next()){var y=c.value,p=(m=m.add(s)).add(u);this.setFormaAnimations(r.clone(y),t,0,(a=r.opt(r.first(y),function(e){return e.style.opacity}))||null!=a?a:1,I.Matrix2D.Identity,P.TimingFunctionType.EaseInOut,n,m,p)}},setFadeAnimationTopDown:function(e,t){for(var n=[],i=r.iter(e);!i.done;i.next()){var o=i.value;o.isTypeLockup()&&n.push(o)}if(0==!n.length){for(var a=r.clone(L.MotionUtils.getTitleLockups(r.clone(n))),s=r.clone(a[0]),u=r.clone(a[1]),m=[],c=[],y=r.iter(s);!y.done;y.next()){var p=y.value,d=r.clone(L.MotionUtils.findTextLines2(p));if(0==!d.length)for(var f=r.iter(d);!f.done;f.next()){var T=f.value;c.push(T)}}c=r.clone(L.MotionUtils.sortTextLines(r.clone(c)));for(var h=r.iter(c);!h.done;h.next())T=h.value,m.push(r.clone(T.words));var v=new N.TheoTime(r.toInt(.25*r.toDouble(t.endTime.timescale)),t.endTime.timescale);this.applyLineFadeIn(r.clone(m),t,t.startTime,t.endTime,v);for(var A=t.endTime.subtract(l.AnimationStyle.FADE_DURATION),F=r.iter(u);!F.done;F.next()){var S=F.value;this.setFormaFade(S,t,t.startTime,t.endTime,A)}}},setFadeAnimation:function(e,t,n){var i;if(2==t.variant||1==t.variantCount){var o=[];e.visitAll(y.FormaTraversal.PreOrder,function(e){(e instanceof _.TextForma||e instanceof M.ShapeForma)&&o.push(e)}),e.isImage()&&(o=[e]),this.setFormaAnimations(r.clone(o),t,.05,e.style.opacity,I.Matrix2D.Identity,P.TimingFunctionType.EaseOut,t.startTime,t.startTime,t.endTime),e.isTypeLockup()&&this.setStillAnimation(e,t)}else{var a=t.endTime.subtract(l.AnimationStyle.FADE_DURATION);if(r.containsEq(n,e,y._equality_Forma_Forma)){var u,m=!1;if((u=r.as(e.controller,E.TypeLockupController))&&r.opt(u.lockupStyle,function(e){return e.textLook==b.LockupTextLook.KnockoutOnly})&&(m=!0),0==t.variant)m&&(u=r.as(e.controller,E.TypeLockupController))&&this.modifyLockupForAnimation(u,!0,m),this.setLineAnimation(e,t,I.Matrix2D.Identity,P.TimingFunctionType.EaseInOut,t.startTime,t.endTime,new N.TheoTime(r.toInt(.25*r.toDouble(t.endTime.timescale)),t.endTime.timescale)),this.setStillAnimation(e,t);if(1==t.variant&&(u=r.as(e.controller,E.TypeLockupController))){this.modifyLockupForAnimation(u,!0,m);for(var c=[],d=r.iter(e.visitAsArray(y.FormaTraversal.PreOrder));!d.done;d.next()){var f,T=d.value;(f=r.as(T,_.TextForma))&&c.push(f)}for(var h=e.finalFrame,v=r.iter(c);!v.done;v.next()){var A=v.value,F=.8*(A.finalFrame.center.x-h.minX)/h.width+.1;s.CoreAssert.isTrue(F<=1);var S=L.MotionUtils.createOpacityStyle(A,0),g=A.style.clone();if(m){var k=(i=r.opt(r.as(r.opt(A.lockupForma,function(e){return e.style}),b.LockupStyle),function(e){return e.backingOpacity}))||null!=i?i:A.style.opacity;g=L.MotionUtils.createOpacityStyle(A,k)}var x=[],D=a.subtract(t.startTime).seconds*F,C=t.startTime.addSeconds(D),O=C.addSeconds(1);m?(x.push(new p.KeyFrame(t.startTime,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,g)),x.push(new p.KeyFrame(C,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,g)),x.push(new p.KeyFrame(O,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,S))):(x.push(new p.KeyFrame(t.startTime,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,S)),x.push(new p.KeyFrame(C,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,S)),x.push(new p.KeyFrame(O,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,g))),A.animation=new p.FormaAnimation(t,t.startTime,O,x)}this.setStillAnimation(e,t,null,a)}}else this.setFormaFade(e,t,t.startTime,t.endTime,a)}},setLineAnimation:function(e,t,n,i,o,a,l){var s,u=e.style.textLook==b.LockupTextLook.KnockoutOnly,m=b.LockupStyle.isKnockoutLook(e.style.textLook)&&!u,c=r.clone(L.MotionUtils.findTextLines(e)),y=a.subtract(o),p=l;p.seconds*r.toDouble(c.length)>y.seconds/2&&(p=y.multiply(1/r.toDouble(2*c.length)));var d=y.subtract(p.multiply(r.toDouble(c.length))),f=0,T=u?0:e.style.opacity;u&&(f=(s=r.opt(r.as(e.style,b.LockupStyle),function(e){return e.backingOpacity}))||null!=s?s:e.style.opacity);var h=o;if(!m)for(var v=r.iter(c);!v.done;v.next()){var A=v.value,F=(h=h.add(p)).add(d);this.setFormaAnimations(r.clone(A),t,f,T,n,i,o,h,F)}var S=a.multiply(.5),g=r.clone(e.filterWithCallback(function(e){return e instanceof M.ShapeForma||e instanceof _.TextForma&&m}));u||this.setFormaAnimations(r.clone(g),t,f,T,I.Matrix2D.Identity,i,o,o,S)},setColorSwapAnimation:function(e,t){var n,i;if(0!=e.length){for(var o=e[0].page,a=0==t.variant||1==t.variant,u=[],y=r.iter(e);!y.done;y.next()){var d,f,h,v=y.value;s.CoreAssert.isFalse(v instanceof _.TextForma),null!=v.controller&&v.kind!=D.RootForma.KIND&&((d=r.as(v.controller,T.GridController))?d.isBackgroundVisible()&&!a&&u.push(v.root):a&&!v.controller.moveable||((f=S.ImageFacade.getImageFormaForForma(v))?(h=r.as(f.style,g.ImageStyle))&&h.isColorizedFilter&&u.push(f):u.push(v)))}u=r.sort(u,function(e,t){return!!e.controller.moveable&&null!=(n=r.opt(e.parent,function(t){return t.indexOfChild(e)}))&&null!=(i=r.opt(t.parent,function(e){return e.indexOfChild(t)}))&&n<i;var n,i}),t.endTime=l.AnimationStyle.COLOR_SWAP_DURATION;for(var A=0==t.variant||2==t.variant?P.TimingFunctionType.Step1:P.TimingFunctionType.Linear,F=1==t.variant?.75:.5,b=r.toInt(r.toDouble(t.endTime.timescale)*F),k=r.toInt(r.toInt(t.endTime.value/b)),L={},M=t.startTime.value,O={},w={},K=[],R=r.iter(u);!R.done;R.next())if(v=R.value,(De=[]).push(new p.KeyFrame(t.startTime,A,I.Matrix2D.Identity,null,v.style.clone())),L[v.formaID]=De,!v.isImage()){for(var U=v.style.colors.colorID(m.ColorRole.FieldPrimary),B=r.iter(v.page.colorLibraryController.getThemeColorKeys());!B.done;B.next()){var V,W=B.value;(V=v.style.colors.fieldPrimary)&&(q=v.page.colorLibraryController.getSolidColorForKey(W))&&V.distanceTo(q)<2&&(U=W)}null==O[U=(n=U)||null!=n?n:"missing"+r.toString(K.length)]&&(O[U]=[],K.includes(U)||K.push(U)),O[U].push(v);for(var j=v.style.colors.colorID(m.ColorRole.FieldSecondary),Y=r.iter(v.page.colorLibraryController.getThemeColorKeys());!Y.done;Y.next()){var G,q;W=Y.value,(G=v.style.colors.fieldSecondary)&&(q=v.page.colorLibraryController.getSolidColorForKey(W))&&G.distanceTo(q)<2&&(j=W)}null==w[j=(i=j)||null!=i?i:"missing"+r.toString(K.length)]&&(w[j]=[],K.includes(j)||K.push(j)),w[j].push(v)}var Z=r.clone(r.shuffle(o.colorLibraryController.getThemeColorKeys())),X=[];if(u.length>0){for(var z=c.DesignSuggestion.init_a05b(e[0].root),H=r.iter(r.range(0,k,!1));!H.done;H.next()){for(var J={},Q=r.iter(u);!Q.done;Q.next()){var $,ee;($=(be=Q.value).style.colors.fieldPrimary)&&(J[be.formaID+"primary"]=$.asString),(ee=be.style.colors.fieldSecondary)&&(J[be.formaID+"secondary"]=ee.asString)}for(var te=x.CoreRandom.nextIntUniform(Z.length);X.length>0&&Z.length>1&&te==X[X.length-1];)te=x.CoreRandom.nextIntUniform(Z.length);X.push(te);for(var ne=r.iter(r.range(0,2,!1));!ne.done;ne.next())for(var ie=1==ne.value,oe=r.clone(ie?O:w),ae=r.iter(K);!ae.done;ae.next()){var re,le,se=ae.value;if((re=oe[se])&&null!=(le=r.indexOf(K,se)))for(var ue=r.iter(re);!ue.done;ue.next())if(!(be=ue.value).isImage())for(var me=!1,ce=0;!me&&ce<Z.length;){var ye=Z[(le+te+ce)%Z.length];ce+=1,me=!0;var pe,de,fe=ie?m.ColorRole.FieldPrimary:m.ColorRole.FieldSecondary;if(be.style.colorTableSupportsRole(fe))if((ge=r.as(be.controller,E.TypeLockupController))?(ge.beginBlockedUpdate(),be.style.colors.setColorId(fe,ye),ge.endBlockedUpdate()):be.style.colors.setColorId(fe,ye),(pe=be.style.colors.color(fe))&&null!=(de=J[be.formaID+(fe==m.ColorRole.FieldPrimary?"primary":"secondary")])&&de==pe.asString&&(me=!1),null!=be.controller&&be.controller.moveable){var Te,he=r.opt(be.controller,function(e){return e.getBackingContrastRole()});if(Te=be.style.colors.color(fe)){var ve=fe==m.ColorRole.FieldPrimary&&he==m.ColorRole.FieldSecondary?be.style.colors.fieldSecondary:r.opt(be.controller,function(e){return e.getBackgroundColor()}),Ae=be.isTypeLockup()?10:5,Fe=new C.SolidColor(Te.red,Te.green,Te.blue,be.style.opacity);null!=ve&&Fe.lightnessDifference(ve)<Ae&&(me=!1)}}}}for(var Se=r.iter(u);!Se.done;Se.next()){var ge,be=Se.value;(ge=r.as(be.controller,E.TypeLockupController))&&ge.styleController.shuffleMultiStyleLockupColors()}M+=b;for(var Ie=new N.TheoTime(M,t.endTime.timescale),ke=r.iter(u);!ke.done;ke.next()){(v=ke.value).isImage()&&r.opt(v.controller,function(e){return e.shuffleColorAssignment()});var Le=v.style.clone();s.CoreAssert.isTrue(Le.colorLibrary==v.style.colorLibrary),(v.isShape()||v.isTypeLockup())&&null==Le.colors.colorID(m.ColorRole.FieldPrimary)&&s.CoreAssert.fail("error, can't be setting a nil colors"),r.opt(L[v.formaID],function(e){return e.push(new p.KeyFrame(Ie,A,I.Matrix2D.Identity,null,Le))})}}z.apply(),z.dispose()}for(var xe=r.iter(e.concat(u));!xe.done;xe.next()){var De;(De=L[(v=xe.value).formaID])?v.animation=new p.FormaAnimation(t,t.startTime,t.endTime,De):v.kind==D.RootForma.KIND?this.setStillAnimation(e[0].root,t):v.animation=null}}},setFlickerAnimation:function(e,t){var n,i,o,a;if(0!=e.length){for(var u=[],m=r.iter(e);!m.done;m.next()){var c;null!=(h=m.value).controller&&h.controller.moveable&&!h.isGridCell()&&null==r.as(h,A.ImageForma)&&this.shouldAnimateShape(h)&&((c=S.ImageFacade.getImageFormaForForma(h))?u.push(c):u.push(h))}var d=r.clone(this.getTitleLockups(e[0].root));if(0!=d.length){for(var f=2!=t.variant,T=r.iter(d);!T.done;T.next()){var h=T.value;r.remove(u,h),(g=r.as(h.controller,E.TypeLockupController))&&r.opt(g.lockupStyle,function(e){return e.textLook!=b.LockupTextLook.KnockoutOnly})&&(f=!1)}for(var v=[],F=r.iter(d);!F.done;F.next()){var g,k=F.value;if(g=r.as(k.controller,E.TypeLockupController)){this.modifyLockupForAnimation(g,1==t.variant,f);for(var x=[],D=[],C=r.iter(k.visitAsArray(y.FormaTraversal.PreOrder));!C.done;C.next()){var O,w,K=C.value;(O=r.as(K,_.TextForma))&&x.push(O),(w=r.as(K,M.ShapeForma))&&D.push(w)}for(var R=r.iter(x);!R.done;R.next())h=R.value,v.push([h])}}2==t.variant&&(v=[d]);var U=r.toInt(2*r.toDouble(t.endTime.timescale)),B=new N.TheoTime(U+1,t.endTime.timescale),V=B.add(l.AnimationStyle.FADE_DURATION),W=P.TimingFunctionType.EaseOut,j=P.TimingFunctionType.Step,Y=r.toInt(.15*r.toDouble(t.endTime.timescale)),G=r.toInt(r.toInt(U/Y)),q={},Z=t.startTime.value;s.CoreAssert.isTrue(V.value>B.value);for(var X=r.iter(v);!X.done;X.next()){e=X.value;for(var z=r.iter(e);!z.done;z.next())h=z.value,(Fe=[]).push(new p.KeyFrame(t.startTime,j,I.Matrix2D.Identity,null,h.style.clone())),q[h.formaID]=Fe}for(var H={},J=r.iter(r.range(0,G,!1));!J.done;J.next()){Z+=Y;for(var Q=new N.TheoTime(Z,t.endTime.timescale),$=r.iter(v);!$.done;$.next()){e=$.value;for(var ee=(n=r.opt(e[0].controller,function(e){return e.currentOpacity}))||null!=n?n:e[0].style.opacity,te=2*(this.randomDbl()-.5)*ee,ne=0,ie=!1;ne<5&&!ie;){ne+=1;for(var oe=r.iter(e);!oe.done;oe.next()){h=oe.value;var ae=(i=r.opt(h.controller,function(e){return e.currentOpacity}))||null!=i?i:h.style.opacity,re=(o=H[h.formaID])||null!=o?o:ae,le=h.isTypeLockup()?ae:1;Math.abs(re-Math.min(Math.max(re+te,0),le))<.1?te=2*(this.randomDbl()-.5):ie=!0}}for(var se=r.iter(e);!se.done;se.next())h=se.value,ae=(a=r.opt(h.controller,function(e){return e.currentOpacity}))||null!=a?a:h.style.opacity,le=h.isTypeLockup()?ae:1,t=L.MotionUtils.createOpacityStyle(h,Math.min(Math.max(ae+te,0),le)),H[h.formaID]=t.opacity,r.opt(q[h.formaID],function(e){return e.push(new p.KeyFrame(Q,j,I.Matrix2D.Identity,null,t))})}}for(var ue=r.iter(v);!ue.done;ue.next()){e=ue.value;for(var me=r.iter(e);!me.done;me.next()){h=me.value;var ce=f?L.MotionUtils.createOpacityStyle(h,0):h.style.clone();q[h.formaID].push(new p.KeyFrame(V,W,I.Matrix2D.Identity,null,ce))}}for(var ye=r.iter(u);!ye.done;ye.next()){h=ye.value;var pe=L.MotionUtils.createOpacityStyle(h,0),de=h.style.clone();null==q[h.formaID]&&(q[h.formaID]=[],q[h.formaID].push(new p.KeyFrame(t.startTime,W,I.Matrix2D.Identity,null,pe)),q[h.formaID].push(new p.KeyFrame(B,W,I.Matrix2D.Identity,null,pe)),q[h.formaID].push(new p.KeyFrame(V,W,I.Matrix2D.Identity,null,de)),V.value<t.endTime.value&&q[h.formaID].push(new p.KeyFrame(t.endTime,W,I.Matrix2D.Identity,null,de)))}for(var fe=[],Te=r.iter(v);!Te.done;Te.next()){e=Te.value;for(var he=r.iter(e);!he.done;he.next())K=he.value,fe.push(K)}for(var ve=e.concat(fe),Ae=r.iter(this.uniqueFormae(r.clone(ve)));!Ae.done;Ae.next()){var Fe,Se;if(Fe=q[(h=Ae.value).formaID])h.animation=new p.FormaAnimation(t,t.startTime,t.endTime,Fe),h.kind==_.TextForma.KIND&&(Se=r.opt(r.opt(h.parent,function(e){return e.parent}),function(e){return e.parent}))&&Se.isTypeLockup()&&null==Se.animation&&this.setStillAnimation(Se,t),this.validateKeyFrames(Fe,"flicker/setStillAnimation");else h.animation=null}}}},shouldAnimateShape:function(e){return!e.isShape()||(e.isGridCell()||null!=e.controller&&e.controller.moveable,!1)},modifyLockupForAnimation:function(e,t,n){var i,o=(i=r.opt(e.lockupStyle,function(e){return e.textLook}))||null!=i?i:b.LockupTextLook.Fill,a=r.opt(e.lockupStyle,function(e){return e.colors.colorID(m.ColorRole.FieldPrimary)});if(b.LockupStyle.isKnockoutLook(o)&&n){r.opt(e.lockupStyle,function(e){return e.textLook=b.LockupTextLook.KnockoutAndFill});var l=r.opt(e.lockupStyle,function(e){return e.colors.colorID(m.ColorRole.FieldSecondary)});r.opt(e.lockupStyle,function(e){return e.colors.setColorId(m.ColorRole.FieldPrimary,l)})}s.CoreAssert.isTrue(0==e.forceLetterFormaMode),e.forceLetterFormaMode=t,e.updateGroup(),e.forceLetterFormaMode=!1,b.LockupStyle.isKnockoutLook(o)&&n&&(e.beginBlockedUpdate(),r.opt(e.lockupStyle,function(e){return e.textLook=o}),r.opt(e.lockupStyle,function(e){return e.colors.setColorId(m.ColorRole.FieldPrimary,a)}),e.endBlockedUpdate())},useKnockoutAnimation:function(e,t){var n;return!(!(n=e.lockupStyle)||!(n.textLook==b.LockupTextLook.KnockoutOnly||b.LockupStyle.isKnockoutLook(n.textLook)&&t==l.AnimationStyle.WORD_CENTERED_VARIANT))},setDynamicWordAnimation:function(e,t){var n,i;if(0!=e.length){var o=t.variant,a=t.name==l.AnimationStyle.NAME_TYPE;a&&(o+=10);var s=r.clone(this.getTitleLockups(e[0].root));if(0!=s.length){for(var u=[],m=r.iter(e);!m.done;m.next()){var c;null!=(h=m.value).controller&&h.controller.moveable&&!h.isGridCell()&&null==r.as(h,A.ImageForma)&&this.shouldAnimateShape(h)&&((c=S.ImageFacade.getImageFormaForForma(h))?u.push(c):u.push(h))}for(var d=!1,f=!1,T=r.iter(s);!T.done;T.next()){var h=T.value;r.remove(u,h),!d&&h.controller instanceof E.TypeLockupController&&(d=this.useKnockoutAnimation(h.controller,o))}var v=[],F=[],g=1,k=1;if(a||d)for(var x=r.iter(s);!x.done;x.next()){var D=x.value;(Ue=r.as(D.controller,E.TypeLockupController))&&(f=this.useKnockoutAnimation(Ue,o),this.modifyLockupForAnimation(Ue,a,f))}for(var C=r.iter(s);!C.done;C.next())D=C.value,f=!1,(Ue=r.as(D.controller,E.TypeLockupController))&&(g=Math.max(g,Ue.text.length),k=Math.max(k,Ue.text.split(" ").length),f=this.useKnockoutAnimation(Ue,o)),D.visitAll(y.FormaTraversal.PreOrder,function(e){var t,n;(t=r.as(e,_.TextForma))&&v.push(t),(n=r.as(e,M.ShapeForma))&&(o==l.AnimationStyle.WORD_APPEAR_VARIANT&&!f||o==l.AnimationStyle.WORD_ZOOM_IN_VARIANT||o==l.AnimationStyle.WORD_CENTERED_VARIANT)&&F.push(n)});r.sortInPlace(F,function(e,t){return e.frame.width>t.frame.width}),v=r.clone(O.TypeLockupUtils.sortTextFormae(r.clone(v)));var w=[];if(o==l.AnimationStyle.WORD_CENTERED_VARIANT?(F.length>0&&w.push([F[0]]),u=r.clone(u.concat(r.clone(F)))):o!=l.AnimationStyle.WORD_APPEAR_VARIANT&&o!=l.AnimationStyle.WORD_ZOOM_IN_VARIANT||w.push(r.clone(F)),o==l.AnimationStyle.LETTER_RANDOM_FADE_VARIANT){for(var K=[],R=null,U=r.iter(v);!U.done;U.next()){var B=U.value;B.parent==r.opt(R,function(e){return e.parent})&&B.rangeInLockup.start==r.opt(R,function(e){return e.rangeInLockup.start})&&b.LockupStyle.isOutlineLook(B.lockupForma.style.textLook)&&K.push(B),R=B}for(var V=r.iter(K);!V.done;V.next()){var W=V.value;r.remove(v,W)}v=r.clone(r.shuffle(v));for(var j=r.iter(v);!j.done;j.next()){h=j.value,w.push([h]);for(var Y,G=null,q=r.iter(K);!q.done;q.next())W=q.value,h.parent==W.parent&&h.rangeInLockup.start==W.rangeInLockup.start&&(w.push([W]),G=W);(Y=G)&&r.remove(K,Y)}}else for(var Z=r.iter(v);!Z.done;Z.next())h=Z.value,w.push([h]);var X=P.TimingFunctionType.Step;o==l.AnimationStyle.WORD_ZOOM_IN_VARIANT?X=P.TimingFunctionType.EaseOut:o==l.AnimationStyle.LETTER_APPEAR_FADE_VARIANT&&(X=P.TimingFunctionType.Linear);var z=P.TimingFunctionType.EaseOut,H=a?1.5:1,J=Math.max(Math.min(r.toDouble(g)/7,2),H);!a&&k>10&&(J+=.25*r.toDouble(k-10),J=Math.min(15,J));var Q=o==l.AnimationStyle.LETTER_APPEAR_VARIANT||o==l.AnimationStyle.LETTER_APPEAR_FADE_VARIANT?.15:0,$=J/r.toDouble(w.length+2),ee=r.toDouble(t.endTime.timescale)*$,te=r.toInt(r.toDouble(t.endTime.timescale)*(J+Q)),ne=new N.TheoTime(te,t.endTime.timescale),ie=ne.add(a?l.AnimationStyle.FADE_DURATION:new N.TheoTime(2,t.endTime.timescale));0==u.length&&(ie=new N.TheoTime(ne.value+1,ne.timescale)),t.endTime=ie;var oe=new N.TheoTime(t.endTime.timescale,t.endTime.timescale);o==l.AnimationStyle.LETTER_APPEAR_VARIANT&&(oe=new N.TheoTime(0,t.endTime.timescale));for(var ae={},re=r.toDouble(t.startTime.value)+Q*r.toDouble(t.endTime.timescale),le=null,se=r.iter(w);!se.done;se.next()){e=se.value;for(var ue=r.iter(e);!ue.done;ue.next()){var me,ce;if(h=ue.value,(me=r.as(h,_.TextForma))&&(R=r.as(le,_.TextForma))&&(ce=r.as(r.opt(me.lockupForma,function(e){return e.style}),b.LockupStyle))&&me.parent==R.parent&&me.rangeInLockup.start==R.rangeInLockup.start&&b.LockupStyle.isOutlineLook(ce.textLook))ae[h.formaID]=ae[R.formaID];else{le=h;var ye=new N.TheoTime(r.toInt(Math.max(re-1,0)),t.endTime.timescale);ye.value<=t.startTime.value&&(ye=new N.TheoTime(r.toInt(t.startTime.value+1),t.endTime.timescale));var pe=new N.TheoTime(r.toInt(re),t.endTime.timescale);pe.value<=ye.value&&(pe=new N.TheoTime(ye.value+1,t.endTime.timescale));var de=new N.TheoTime(r.toInt(re+ee-1),t.endTime.timescale);de.value<=pe.value&&(de=new N.TheoTime(pe.value+1,t.endTime.timescale));var fe,Te,he=new N.TheoTime(de.value+1,t.endTime.timescale),ve=h.style.clone();if(f=!1,(Ue=r.as(h.controller,E.TypeLockupController))&&(f=this.useKnockoutAnimation(Ue,o)),(fe=r.as(r.opt(r.opt(r.as(h,_.TextForma),function(e){return e.lockupForma}),function(e){return e.controller}),E.TypeLockupController))&&(f=this.useKnockoutAnimation(fe,o)),o==l.AnimationStyle.LETTER_APPEAR_VARIANT){var Ae=f?0:1;Te=L.MotionUtils.createOpacityStyle(h,Ae)}else{var Fe=f?0:Math.min(pe.seconds/oe.seconds,.8);Te=L.MotionUtils.createOpacityStyle(h,Fe)}var Se=L.MotionUtils.createOpacityStyle(h,0);if(f&&o!=l.AnimationStyle.WORD_CENTERED_VARIANT){var ge=(n=r.opt(r.as(r.opt(r.opt(r.as(h,_.TextForma),function(e){return e.lockupForma}),function(e){return e.style}),b.LockupStyle),function(e){return e.backingOpacity}))||null!=n?n:h.style.opacity;Se=L.MotionUtils.createOpacityStyle(h,ge),ve=L.MotionUtils.createOpacityStyle(h,0)}if(ae[h.formaID]=[],ae[h.formaID].push(new p.KeyFrame(t.startTime,X,I.Matrix2D.Identity,null,Se)),o==l.AnimationStyle.WORD_CENTERED_VARIANT){var be=h.totalPlacement.inverse.transformPoint(h.root.finalFrame.center),Ie=I.Matrix2D.translation(be.subtract(h.bounds.center));h.isShape()&&d?(ae[h.formaID].push(new p.KeyFrame(ye,X,I.Matrix2D.Identity,null,Se)),ae[h.formaID].push(new p.KeyFrame(pe,X,I.Matrix2D.Identity,null,Se))):(ae[h.formaID].push(new p.KeyFrame(ye,X,Ie,null,Se)),ae[h.formaID].push(new p.KeyFrame(pe,X,Ie,null,ve))),h.isShape()?d?(ae[h.formaID].push(new p.KeyFrame(ne.addVal(-10),z,I.Matrix2D.Identity,null,Se)),ae[h.formaID].push(new p.KeyFrame(ne.addVal(-9),X,I.Matrix2D.Identity,null,ve))):(ae[h.formaID].push(new p.KeyFrame(ne.addVal(-10),z,Ie,null,ve)),ae[h.formaID].push(new p.KeyFrame(ne.addVal(-9),X,Ie,null,Se))):(ae[h.formaID].push(new p.KeyFrame(de,X,Ie,null,ve)),ae[h.formaID].push(new p.KeyFrame(he,X,Ie,null,Se))),h.isShape()&&d?ae[h.formaID].push(new p.KeyFrame(ne,X,I.Matrix2D.Identity,null,ve)):ae[h.formaID].push(new p.KeyFrame(ne,X,I.Matrix2D.Identity,null,Se))}else if(o==l.AnimationStyle.WORD_ZOOM_IN_VARIANT){var ke,Le,xe=h.isFullCanvas?1:10;if(Ie=I.Matrix2D.Identity,(ke=r.opt(r.opt(h.root,function(e){return e.finalFrame}),function(e){return e.center}))&&(Le=h.totalPlacement.inverse)){var De=Le.transformPoint(ke).subtract(h.bounds.center),Ce=I.Matrix2D.scalingXYfromPoint(h.frame.center,xe,xe);Ie=Ce.translate(De)}r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(ye,X,Ie,null,Se))}),r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(pe,X,Ie,null,ve))}),r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(de,X,I.Matrix2D.Identity,null,ve))})}else if(o==l.AnimationStyle.LETTER_APPEAR_FADE_VARIANT){r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(ye,X,I.Matrix2D.Identity,null,Se))}),r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(pe,X,I.Matrix2D.Identity,null,Te))});var Me=pe.addSeconds(oe.seconds),_e=ie.seconds>Me.seconds?Me:ie.addVal(-1);r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(_e,X,I.Matrix2D.Identity,null,ve))})}else r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(ye,X,I.Matrix2D.Identity,null,Se))}),r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(pe,X,I.Matrix2D.Identity,null,ve))});this.validateKeyFrames(ae[h.formaID],"variants")}}re+=ee}for(var Ee=r.iter(u);!Ee.done;Ee.next())h=Ee.value,Se=L.MotionUtils.createOpacityStyle(h,0),f=!1,(Ue=r.as(r.opt(r.opt(r.as(h,_.TextForma),function(e){return e.lockupForma}),function(e){return e.controller}),E.TypeLockupController))&&(f=this.useKnockoutAnimation(Ue,o)),f&&h instanceof _.TextForma&&(ge=(i=r.opt(r.as(r.opt(r.opt(r.as(h,_.TextForma),function(e){return e.lockupForma}),function(e){return e.style}),b.LockupStyle),function(e){return e.backingOpacity}))||null!=i?i:h.style.opacity,Se=L.MotionUtils.createOpacityStyle(h,ge)),null==ae[h.formaID]&&((We=[]).push(new p.KeyFrame(t.startTime,z,I.Matrix2D.Identity,null,Se)),ae[h.formaID]=We,r.opt(ae[h.formaID],function(e){return e.push(new p.KeyFrame(ne,z,I.Matrix2D.Identity,null,Se))}),this.validateKeyFrames(ae[h.formaID],"createOpacityStyle"));for(var Oe=[],we=r.iter(w);!we.done;we.next()){e=we.value;for(var Ne=r.iter(e);!Ne.done;Ne.next()){var Pe=Ne.value;Oe.push(Pe)}}for(var Ke=u.concat(Oe),Re=r.iter(this.uniqueFormae(r.clone(Ke)));!Re.done;Re.next()){var Ue;ve=(h=Re.value).style.clone(),f=!1,(Ue=r.as(r.opt(r.opt(r.as(h,_.TextForma),function(e){return e.lockupForma}),function(e){return e.controller}),E.TypeLockupController))&&(f=this.useKnockoutAnimation(Ue,o)),f&&h instanceof _.TextForma&&(ve=L.MotionUtils.createOpacityStyle(h,0)),(We=ae[h.formaID])&&We.length>0&&We[We.length-1].time.value>=ie.value&&r.info("error?"),ae[h.formaID].push(new p.KeyFrame(ie,z,I.Matrix2D.Identity,null,ve)),ie.value-15<t.endTime.value&&ae[h.formaID].push(new p.KeyFrame(t.endTime.addVal(15),z,I.Matrix2D.Identity,null,ve)),this.validateKeyFrames(ae[h.formaID],"fade time checks")}for(var Be=e.concat(Oe).concat(u),Ve=r.iter(this.uniqueFormae(r.clone(Be)));!Ve.done;Ve.next()){var We,je;if(We=ae[(h=Ve.value).formaID])h.animation=new p.FormaAnimation(t,t.startTime,t.endTime,We),h.kind==_.TextForma.KIND&&(je=r.opt(r.opt(h.parent,function(e){return e.parent}),function(e){return e.parent}))&&je.isTypeLockup()&&null==je.animation&&this.setStillAnimation(je,t),this.validateKeyFrames(h.animation.keyFrames,"dynamicWord/setStillAnimation");else h.animation=null}}}},uniqueFormae:function(e){for(var t=[],n=r.iter(e);!n.done;n.next()){var i=n.value;r.containsEq(t,i,y._equality_Forma_Forma)||t.push(i)}return t},getTitleLockups:function(e){var t=r.clone(e.filterWithCallback(function(e){return e.isTypeLockup()}));if(0==t.length)return[];r.sortInPlace(t,function(e,t){return e.controller.currentHeightScale>t.controller.currentHeightScale});for(var n=t[0],i=[n],o=r.iter(t);!o.done;o.next()){var a,l,s=o.value;if(!r.eq(y._equality_Forma_Forma,s,n)&&(a=r.as(s.controller,E.TypeLockupController))&&(l=r.as(n.controller,E.TypeLockupController))){var u=a.getCurrentFontSize(),m=l.getCurrentFontSize();Math.abs(u-m)/Math.min(u,m)<.05&&i.push(s)}}return i},setSlideAnimation:function(e,t,n){var i,o=[],a=[],s=!1,u=!1;if((i=r.opt(r.as(e.controller,E.TypeLockupController),function(e){return e.lockupStyle}))&&(b.LockupStyle.isKnockoutLook(i.textLook)&&i.backing==b.LockupBacking.Knockout&&(s=!0),u=b.LockupStyle.isKnockoutLook(i.textLook)&&i.textLook!=b.LockupTextLook.KnockoutOnly),e.isTypeLockup()?e.visitAll(y.FormaTraversal.PreOrder,function(e){u||e instanceof M.ShapeForma?a.push(e):e instanceof _.TextForma&&o.push(e)}):o.push(e),2==t.variant||1==t.variantCount||s){var m=75;s&&(m=2==t.variant||1==t.variantCount?-75:0==t.variant?-200:200);var c=I.Matrix2D.translation(new w.TheoPoint(-m,0)),d=I.Matrix2D.translation(new w.TheoPoint(m,0)),f=t.endTime.multiply(2/3);if(this.setFormaAnimations(r.clone(o),t,0,e.style.opacity,c,P.TimingFunctionType.EaseInOut,t.startTime,t.startTime,f),this.setFormaAnimations(r.clone(a),t,0,e.style.opacity,d,P.TimingFunctionType.EaseInOut,t.startTime,t.startTime,f),e.isTypeLockup()){var T=[];T.push(new p.KeyFrame(t.startTime,P.TimingFunctionType.Linear)),T.push(new p.KeyFrame(f,P.TimingFunctionType.Linear)),e.animation=new p.FormaAnimation(t,t.startTime,t.endTime,T),e.animation=new p.FormaAnimation(t,t.startTime,f,T)}}else{var h=t.endTime.subtract(l.AnimationStyle.FADE_DURATION);r.containsEq(n,e,y._equality_Forma_Forma)?(c=I.Matrix2D.translation(new w.TheoPoint(0==t.variant?-200:200,0)),this.setLineAnimation(e,t,c,P.TimingFunctionType.EaseInOut,t.startTime,h,new N.TheoTime(r.toInt(.1*r.toDouble(t.endTime.timescale)),t.endTime.timescale)),this.setStillAnimation(e,t,t.startTime,h)):this.setFormaFade(e,t,t.startTime,t.endTime,h)}},setFormaFade:function(e,t,n,i,o){var a,r=e;(a=S.ImageFacade.getImageFormaForForma(e))&&(r=a);var l=r.style.clone(),s=L.MotionUtils.createOpacityStyle(r,0),u=[];u.push(new p.KeyFrame(n,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,s)),u.push(new p.KeyFrame(o,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,s)),u.push(new p.KeyFrame(i,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,l)),e.animation=new p.FormaAnimation(t,n,i,u)},getShiftingMatrix:function(e,t,n,i){var o,a=e.finalFrame,r=e.root.frame,l=e.root.placement.inverse.transformPoint(r.eval(n)),s=I.Matrix2D.scaling(t),u=e.root.placement.concat(s).transformPoint(l);return o=i?u.subtract(a.center):r.center.subtract(u),I.Matrix2D.scaling(t).translate(o)},setFormaAnimations:function(e,t,n,i,o,a,l,s,u){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=I.Matrix2D.Identity),void 0===a&&(a=P.TimingFunctionType.Linear);for(var m=r.iter(e);!m.done;m.next()){var c=m.value,y=c.style.clone(),d=null!=n?L.MotionUtils.createOpacityStyle(c,n):y,f=null!=i?L.MotionUtils.createOpacityStyle(c,i):y,T=[];l.value!=s.value&&T.push(new p.KeyFrame(l,a,o,null,d)),T.push(new p.KeyFrame(s,a,o,null,d)),T.push(new p.KeyFrame(u,a,I.Matrix2D.Identity,null,f)),c.animation=new p.FormaAnimation(t,l,u,T)}},setGreyscaleAnimation:function(e,t){var n=[],i=e.page.imageFilterLibrary.getImageStyle("Greyscale").clone();i.colorLibrary=e.style.colorLibrary;var o=e.style.clone();null==o.filter&&(o.filter=new F.CompositeFilter(void 0,"None",0,"normal",void 0,void 0,"none")),s.CoreAssert.isTrue(i.colorLibrary==e.style.colorLibrary),s.CoreAssert.isTrue(o.colorLibrary==e.style.colorLibrary),i.adjustments=e.style.adjustments,o.adjustments=e.style.adjustments,n.push(new p.KeyFrame(t.startTime,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,i)),n.push(new p.KeyFrame(t.endTime,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,o)),e.animation=new p.FormaAnimation(t,t.startTime,t.endTime,n)},setBlurAnimation:function(e,t){t.endTime=l.AnimationStyle.DEFAULT_DURATION.subtract(new N.TheoTime(30,30));var n=[],i=e.style.clone(),o=e.style.clone();null!=i.filter&&i.filter instanceof F.CompositeFilter||((i=e.page.imageFilterLibrary.getImageStyle("Blur").clone()).colorLibrary=e.style.colorLibrary,(o=e.page.imageFilterLibrary.getImageStyle("Blur").clone()).colorLibrary=e.style.colorLibrary),s.CoreAssert.isTrue(i.colorLibrary==e.style.colorLibrary),s.CoreAssert.isTrue(o.colorLibrary==e.style.colorLibrary),i.adjustments=e.style.adjustments,o.adjustments=e.style.adjustments,i.filter.blurRadius=20,o.filter.blurRadius=0,n.push(new p.KeyFrame(t.startTime,P.TimingFunctionType.EaseOut,I.Matrix2D.Identity,null,i)),n.push(new p.KeyFrame(t.endTime,P.TimingFunctionType.EaseOut,I.Matrix2D.Identity,null,o)),e.animation=new p.FormaAnimation(t,t.startTime,t.endTime,n)},setFillAnimation:function(e,t){var n,i,o=[];if((n=e.style.clone())&&(i=e.style.clone())){n.filter=new F.CompositeFilter(void 0,"Fill",1,"normal",void 0,void 0,"none"),null==i.filter&&(i.filter=new F.CompositeFilter(void 0,"None",0,"normal",void 0,void 0,"none")),n.colorLibrary=e.style.colorLibrary,i.colorLibrary=e.style.colorLibrary,n.adjustments=e.style.adjustments,i.adjustments=e.style.adjustments;var a=r.clone(e.page.colorLibraryController.getThemeColorKeys());a.length>t.variant&&(n.colors.fieldPrimary=e.page.colorLibraryController.getSolidColorForKey(r.as(a[t.variant],"String")),n.colors.fieldSecondary=null,r.opt(n.filter,function(e){return e.style=n}),r.opt(i.filter,function(e){return e.style=i}),o.push(new p.KeyFrame(t.startTime,P.TimingFunctionType.EaseInOut,I.Matrix2D.Identity,null,n)),o.push(new p.KeyFrame(t.endTime,P.TimingFunctionType.EaseInOut,I.Matrix2D.Identity,null,i)),e.animation=new p.FormaAnimation(t,t.startTime,t.endTime,o))}},setColorSwitchAnimation:function(e,t){var n,i,o=[];if((n=e.style.clone())&&(i=e.page.imageFilterLibrary.getImageStyle("Overlay").clone())){var a;if(null==n.filter&&(n.filter=new F.CompositeFilter(void 0,"None",0,"normal",void 0,void 0,"none")),a=r.as(i.filter,F.CompositeFilter)){var l=r.clone(e.page.colorLibraryController.getThemeColorKeys());l.length>t.variant&&(i.colors.fieldPrimary=e.page.colorLibraryController.getSolidColorForKey(r.as(l[t.variant],"String"))),a.mix=Math.max(a.mix,1)}s.CoreAssert.isTrue(n.colorLibrary==e.style.colorLibrary),i.colorLibrary=e.style.colorLibrary,n.adjustments=e.style.adjustments,i.adjustments=e.style.adjustments,o.push(new p.KeyFrame(t.startTime,P.TimingFunctionType.EaseInOut,I.Matrix2D.Identity,null,n)),o.push(new p.KeyFrame(t.endTime,P.TimingFunctionType.EaseInOut,I.Matrix2D.Identity,null,i)),e.animation=new p.FormaAnimation(t,t.startTime,t.endTime,o)}},setZoomAnimation:function(e,t){0==t.variant?this.setImageAnimation(e,t,P.TimingFunctionType.EaseOut,[[t.startTime,w.TheoPoint.ZERO,.8],[t.endTime,w.TheoPoint.ZERO,1]],!0):this.setImageAnimation(e,t,P.TimingFunctionType.EaseOut,[[t.startTime,w.TheoPoint.ZERO,1.2],[t.endTime,w.TheoPoint.ZERO,1]],!0)},setPanningAnimation:function(e,t){if(e.controller instanceof v.ImageController){var n=1==t.variant?-150:150;this.setImageAnimation(e,t,P.TimingFunctionType.EaseOut,[[t.startTime,new w.TheoPoint(n,0),1],[t.endTime,w.TheoPoint.ZERO,1]],!0)}},randomDbl:function(){return r.toDouble(x.CoreRandom.nextInt)/2147483647},setAnimationStyleForFormae:function(e,t){if(t.name==l.AnimationStyle.NAME_COLORSWAP)this.setColorSwapAnimation(r.clone(e),t);else if(t.name==l.AnimationStyle.NAME_FLICKER)this.setFlickerAnimation(r.clone(e),t);else if(t.name==l.AnimationStyle.NAME_DYNAMIC||t.name==l.AnimationStyle.NAME_TYPE)this.setDynamicWordAnimation(r.clone(e),t);else if(t.name==l.AnimationStyle.NAME_FADE&&0==t.variant)this.setFadeAnimationTopDown(r.clone(e),t);else{for(var n=!1,i=r.as(r.opt(r.first(e),function(e){return e.root}),D.RootForma),o=r.clone(null!=i?this.getTitleLockups(i):[]),a=r.iter(e);!a.done;a.next()){var s=a.value;n=n||!r.containsEq(o,s,y._equality_Forma_Forma)}t.name==l.AnimationStyle.NAME_SLIDE&&t.variantCount<2&&(t.endTime=t.endTime.addSeconds(-1));for(var u=N.TheoTime.Zero,m=r.iter(e);!m.done;m.next()){var c;if(null!=(s=m.value).controller){var p,d,T=s.hasIntent(y.Forma.INTENT_ICON)&&this.shouldAnimateShape(s),h=s.kind==f.FrameForma.KIND&&s.controller.moveable;if(T||s.isTypeLockup()||h)(d=r.as(s.controller,E.TypeLockupController))&&d.updateGroup(),t.name==l.AnimationStyle.NAME_NO_STYLE?s.animation=null:t.name==l.AnimationStyle.NAME_GROW?this.setGrowAnimation(s,t,r.clone(o)):t.name==l.AnimationStyle.NAME_FADE?this.setFadeAnimation(s,t,r.clone(o)):t.name==l.AnimationStyle.NAME_SLIDE&&this.setSlideAnimation(s,t,r.clone(o));else if(p=S.ImageFacade.getImageFormaForForma(s)){var v;if((v=r.as(s,K.VideoForma))&&v.videoContentNode.isGIF){this.setStillAnimation(p,t);continue}t.name==l.AnimationStyle.NAME_NO_STYLE?p.animation=null:t.name==l.AnimationStyle.NAME_ZOOM?this.setZoomAnimation(p,t):t.name==l.AnimationStyle.NAME_BLUR?this.setBlurAnimation(p,t):t.name==l.AnimationStyle.NAME_GRAYSCALE?this.setGreyscaleAnimation(p,t):t.name==l.AnimationStyle.NAME_FILL?this.setFillAnimation(p,t):t.name==l.AnimationStyle.NAME_COLOR?this.setColorSwitchAnimation(p,t):t.name==l.AnimationStyle.NAME_PAN&&this.setPanningAnimation(p,t)}}(c=s.animation)&&c.endTime.seconds>u.seconds&&(u=c.endTime)}u.seconds>0&&(t.endTime=u)}},applyStyle:function(e,t){var n=this,i=null==e?t.page.animationLibrary.getAnimationStyle(l.AnimationStyle.NAME_NO_STYLE):e;if(k.MotionFacade.canApplyStyle(i))k.MotionFacade.applyStyle(t,i);else{if(null!=i){r.opt(i,function(e){return e.endTime=i.name==l.AnimationStyle.NAME_NO_STYLE?l.AnimationStyle.DEFAULT_START:l.AnimationStyle.DEFAULT_DURATION});var o=[],a=N.TheoTime.Zero,s=[],u=!1;t.visitAll(y.FormaTraversal.PreOrder,function(e){var t,n;if((t=r.as(e,K.VideoForma))&&(n=r.opt(t.parent,function(e){return e.controller}))){var i=t.videoContentNode.times;if(i.length>0){var l=i[i.length-1];n.moveable?s.push(t):a.seconds<l.seconds&&(a=l)}}e.animation=null,null!=e.controller&&e.controller.moveable&&!e.isVideo()&&(u=!0),null!=e.controller&&e.controller.moveable&&e.isImage()&&!e.isSticker()||null!=e.controller&&o.push(e)});for(var m=r.iter(s);!m.done;m.next()){var c=m.value;r.containsEq(o,c,y._equality_Forma_Forma)&&r.remove(o,c),null!=c.parent&&o.includes(c.parent)&&r.remove(o,c.parent)}u||r.opt(i,function(e){return e.endTime=l.AnimationStyle.DEFAULT_START}),this.setAnimationStyleForFormae(r.clone(o),i);var d=i.endTime.timescale;if(s.length>0){for(var T=i.name==l.AnimationStyle.NAME_NO_STYLE?l.AnimationStyle.GIF_DURATION.seconds:l.AnimationStyle.END_GIF_DURATION.seconds,h=new N.TheoTime(r.toInt(T*r.toDouble(d)),d),v=r.iter(s);!v.done;v.next()){var A=(b=v.value).videoContentNode.duration.seconds;h.seconds<A&&(h=new N.TheoTime(r.toInt(A*r.toDouble(d)),d))}i.name==l.AnimationStyle.NAME_COLORSWAP&&(h=i.endTime);for(var F=0,g=r.iter(s);!g.done;g.next()){var b,x=(A=(b=g.value).videoContentNode.duration.seconds)*Math.max(r.toDouble(r.toInt(Math.floor(h.seconds/A))),1);F=Math.max(F,x);var D=a.seconds-(F+i.endTime.seconds);D>0&&(F+=D);var C=new N.TheoTime(r.toInt(x*r.toDouble(d)),d),M=L.MotionUtils.createOpacityStyle(b,0),_=b.style.clone(),E=[],O=i.name==l.AnimationStyle.NAME_COLORSWAP?i.startTime:i.endTime,w=O.add(C);i.name!=l.AnimationStyle.NAME_NO_STYLE&&i.name!=l.AnimationStyle.NAME_COLORSWAP?(E.push(new p.KeyFrame(i.startTime,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,M)),E.push(new p.KeyFrame(O,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,M)),E.push(new p.KeyFrame(O.addSeconds(.5),P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,_))):E.push(new p.KeyFrame(O,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,_)),E.push(new p.KeyFrame(w,P.TimingFunctionType.Linear,I.Matrix2D.Identity,null,_)),b.animation=new p.FormaAnimation(i,O,w,E)}if(i.name!=l.AnimationStyle.NAME_COLORSWAP){var R=new N.TheoTime(r.toInt(F*r.toDouble(d)),d);i.endTime=i.endTime.add(R)}}a.seconds>i.endTime.seconds&&(i.endTime=i.endTime.addSeconds(a.seconds-i.endTime.seconds));for(var U=r.iter(o);!U.done;U.next()){var B,V,W=U.value;(B=r.as(W,K.VideoForma))&&(V=r.opt(B.parent,function(e){return e.controller}))&&(V.moveable||i.name!=l.AnimationStyle.NAME_NO_STYLE||this.setStillAnimation(W,i))}if(i.name!=l.AnimationStyle.NAME_NO_STYLE&&i.name!=l.AnimationStyle.NAME_COLORSWAP&&0==s.length&&0==a.seconds){var j=new N.TheoTime(r.toInt(l.AnimationStyle.STILL_DURATION.seconds*r.toDouble(d)),d);i.endTime=i.endTime.add(j)}i.name!=l.AnimationStyle.NAME_COLORSWAP&&i.endTime.value>0&&this.setStillAnimation(t,i)}else t.animation=null;t.visitAll(y.FormaTraversal.PreOrder,function(e){var t;null!=e.animation&&(e.kind==f.FrameForma.KIND&&(t=S.ImageFacade.getImageFormaForForma(e))&&null==t.animation&&n.setStillAnimation(t,i),n.validateKeyFrames(e.animation.keyFrames,"applyStyle/setStillAnimation"))})}},validateKeyFrames:function(e,t){var n=e.length;if(!(n<=1))for(var i=r.iter(r.range(0,n-1,!1));!i.done;i.next()){var o=i.value,a=e[o],l=e[o+1];a.time.value>=l.time.value&&l.time.value>0&&r.opt(h.Host.logging,function(e){return e.error("keyframe time error on frames "+o+"/"+(o+1)+" with context "+t)})}}}}),i)},305:function(e,t,n){var i,o,a=t,r=n(0),l=n(1),s=n(4),u=n(50);a.TheoBaseSubscription=(i=function(e,t,n,i){this.active=!0,this.publisher=e,this.msgType=t,this.cbfn=n,this.subscriber=i},r.defineClass({name:"TheoBaseSubscription",ctor:i,superName:"CoreObject",statics:{_implements:function(e){return"TheoMessageSubscription"==e}},props:{unsubscribe:function(){var e=this;this.active&&r.opt(this.publisher,function(t){return t.unsubscribe(e)})}}}),i),a.TheoBasePublishing=(o=function(){this.subscriptions_={},s.CoreObject.call(this)},r.defineClass({name:"TheoBasePublishing",ctor:o,superName:"CoreObject",props:{subscribeWithCallback:function(e,t){null==this.subscriptions_[t]&&(this.subscriptions_[t]=[]);var n=new a.TheoBaseSubscription(this.owner,t,e,null);return this.subscriptions_[t].push(n),n},subscribe:function(e,t){null==this.subscriptions_[t]&&(this.subscriptions_[t]=[]);var n=new a.TheoBaseSubscription(this.owner,t,null,e);return this.subscriptions_[t].push(n),n},unsubscribe:function(e){if(e instanceof a.TheoBaseSubscription){var t,n=e,i=r.clone(this.subscriptions_[n.msgType]);null!=(t=r.indexOf(i,n))?(this.subscriptions_[n.msgType].splice(t,1),n.active=!1):l.CoreAssert.fail("TheoBasePublisher: trying to unsubscribe a subscription that isn't active")}else l.CoreAssert.fail("BasePublisher: trying to pass a sub that isn't mine!")},publish:function(e){var t;if(t=this.subscriptions_[e.type]){u.TheoMessageStatistics.instance.published(e,t.length);for(var n=r.iter(t);!n.done;n.next()){var i=n.value;null!=i&&(null!=i.cbfn?i.cbfn(e):null!=i.subscriber&&i.subscriber.onMessage(e))}}else u.TheoMessageStatistics.instance.published(e,0)}}}),o)},4:function(e,t,n){var i,o=t,a=n(0);o.CoreObject=(i=function(){},a.defineClass({name:"CoreObject",ctor:i}),i)},426:function(e,t,n){var i,o,a=t,r=n(0),l=n(196),s=n(1),u=n(4),m=n(19),c=n(11),y=n(62),p=n(26),d=n(29),f=n(44),T=n(23),h=n(136),v=n(91),A=n(17),F=n(9),S=n(105),g=n(30),b=n(58),I=n(14),k=n(48),L=n(125),x=n(73);a.KeyFrameSet=(i=function(){},r.defineClass({name:"KeyFrameSet",ctor:i}),i),a.AnimationController=(o=function(e){this.document_=e,this.staticState_={},this.playing_=!1,u.CoreObject.call(this)},r.defineClass({name:"AnimationController",ctor:o,superName:"CoreObject",props:{playing:{get:function(){return this.playing_},set:function(e){this.playing_=e}},hasAnimation:{get:function(){return this.document_.firstPage.root.filterWithCallback(function(e){return e instanceof x.VideoForma}).length>0||this.hasAnimatedFormae}},hasAnimatedFormae:{get:function(){return null!=this.animationStyle&&!this.animationStyle.isNoStyle()&&0==!r.clone(this.document_.firstPage.root.filterWithCallback(function(e){return null!=e.animation||e.isVideo()})).length}},gifStartTimeIndex:{get:function(){var e;if(e=this.animationStyle){var t=r.clone(this.document_.firstPage.root.filterWithCallback(function(e){return e instanceof x.VideoForma&&e.videoContentNode.isGIF}));if(0==t.length)return 0;for(var n=e.startTime.seconds,i=r.iter(t);!i.done;i.next()){var o,a=i.value;(o=r.opt(a.animation,function(e){return e.keyFrames}))&&o.length>1&&(n=Math.max(n,o[1].time.seconds))}for(var l=r.clone(this.times),s=r.iter(r.range(0,l.length-1,!1));!s.done;s.next()){var u=s.value;if(n>=l[u].seconds&&n<l[u+1].seconds)return u}}return 0}},animationStyle:{get:function(){return S.MotionUtils.getCurrentAnimationStyle(this.document_)},set:function(e){var t,n=e;if(null==n&&(n=l.AnimationStyle.init_b946(l.AnimationStyle.NAME_NO_STYLE)),t=this.document_){var i=new f.AnimationStyleChangedEvent(t.firstPage.root);t.firstPage.root.beginUpdate(i),t.firstPage.animationLibrary.applyStyle(n,t.firstPage.root),t.firstPage.root.endUpdate(i)}}},isCurrentAnimationValid:{get:function(){return S.MotionUtils.isCurrentAnimationValid(this.document_)}},duration:{get:function(){return r.last(this.times)||k.TheoTime.Zero}},times:{get:function(){var e;if(e=this.animationStyle){for(var t=[],n=e.endTime.value,i=r.toInt(e.endTime.timescale/l.AnimationStyle.DEFAULT_TIMESCALE),o=r.iter(r.stride(0,n,i));!o.done;o.next()){var a=o.value;t.push(new k.TheoTime(a,e.endTime.timescale))}return 0==t.length?this.document_.firstPage.root.visitAll(c.FormaTraversal.PreOrder,function(e){var n,i;(n=r.as(e,x.VideoForma))&&(i=r.opt(n.videoContentNode,function(e){return e.times}))&&(t=i.concat())}):t[t.length-1].value!=n&&t.push(e.endTime),t}return[]}},saveStaticState:function(){var e=this;this.staticState_={},this.document_.firstPage.root.visitAll(c.FormaTraversal.PreOrder,function(t){if(null!=t.animation){var n=t.style.clone(),i=new y.KeyFrame(k.TheoTime.Zero,L.TimingFunctionType.Linear,t.placement,t.bounds,n);null!=n&&t.kind==x.VideoForma.KIND&&0==n.opacity&&r.info("opacity is 0?"),e.staticState_[t.formaID]=i}})},revertToStaticState:function(){if(null!=this.document_){var e,t;if(e=this.staticState_)for(var n=r.iter(e);!n.done;n.next()){var i,o,a,l,u=n.key,m=n.value;if(i=r.opt(this.document_,function(e){return e.firstPage.root.formaByID(u)}))(o=m.placement)&&(i.placement=o),i.kind==d.FrameForma.KIND&&(a=m.bounds)&&(i.bounds=a),(l=m.style)&&(i.kind==x.VideoForma.KIND&&0==l.opacity&&r.info("opacity is 0?"),s.CoreAssert.isTrue(l.colorLibrary==i.style.colorLibrary),i.applyStyle(m.style),i.kind==b.TextForma.KIND&&(i.style.opacity=1))}if((t=this.animationStyle)&&t.modifiesFormaTree)for(var c=r.clone(this.document_.firstPage.root.filterWithCallback(function(e){return e.isTypeLockup()})),y=r.iter(c);!y.done;y.next()){var p,f=y.value;if(p=r.as(f.controller,I.TypeLockupController)){p.forceLetterFormaMode=!1;var T,h,v=r.opt(p.lockupStyle,function(e){return e.layout}),F=r.opt(p.lockupStyle,function(e){return e.alignment});v==A.LockupLayout.Standard&&F==A.LockupAlignment.Right?r.opt(p.lockupStyle,function(e){return e.alignment=A.LockupAlignment.Left}):(p.beginBlockedUpdate(),r.opt(p.lockupStyle,function(e){return e.layout=A.LockupLayout.Standard}),r.opt(p.lockupStyle,function(e){return e.alignment=A.LockupAlignment.Right}),p.endBlockedUpdate()),null!=(T=v)&&null!=(h=F)&&(p.beginBlockedUpdate(),r.opt(p.lockupStyle,function(e){return e.layout=T}),r.opt(p.lockupStyle,function(e){return e.alignment=h}),p.endBlockedUpdate()),p.updateGroup()}}}else s.CoreAssert.fail("no document. really?")},determineKeyFrameSetForTime:function(e,t){var n=new a.KeyFrameSet,i=e.keyFrames.length;if(i>0){for(var o=t.seconds,l=r.iter(r.toSequence(e.keyFrames));!l.done;l.next()){var s=l.value,u=s.offset,m=s.element;if(m.time.seconds>=o){n.kfB=m,u>0&&(n.kfA=e.keyFrames[u-1]);break}}null==n.kfB&&(n.kfA=e.keyFrames[i-1])}return n},determineAlpha:function(e,t){var n=1;if(null!=e.kfB&&null!=e.kfA){var i=new L.TheoTimingFunction(e.kfB.timingFunction),o=(t.seconds-e.kfA.time.seconds)/(e.kfB.time.seconds-e.kfA.time.seconds);n=i.evalX(o)}return n},determinePlacementShift:function(e,t){var n,i,o=F.Matrix2D.Identity;return(n=r.opt(e.kfA,function(e){return e.placement}))?o=(i=r.opt(e.kfB,function(e){return e.placement}))?n.interpolateWith(i,t):n:(i=r.opt(e.kfB,function(e){return e.placement}))&&(o=i),o},moveToTime:function(e){var t=this;if(null==this.document_)return s.CoreAssert.fail("no document. really?"),!1;if(null==this.staticState_)return s.CoreAssert.fail("no static state defined"),!1;var n,i=!1,o=new f.FormaStyleChangedEvent(this.document_.firstPage.root);if(r.opt(this.document_,function(e){return e.firstPage.beginUpdate(o)}),r.opt(this.document_,function(n){return n.firstPage.root.visitAll(c.FormaTraversal.PreOrder,function(n){var o,a;if((o=n.animation)&&(a=t.staticState_[n.formaID])){var s=t.determineKeyFrameSetForTime(o,e);if(null!=s.kfA||null!=s.kfB){i=!0;var u,m,y,F,S=t.determineAlpha(s,e);if(u=a.placement){var k=t.determinePlacementShift(s,S);n.placement=u.concat(k)}(m=r.opt(s.kfA,function(e){return e.bounds}))&&(y=r.opt(s.kfB,function(e){return e.bounds}))&&(m.equalWithAccuracy(y,.01)||(n.bounds=m.interpolateWith(y,S),(F=r.as(n.controller,p.FrameController))&&F.fitChildrenToFrame()));var L=r.opt(s.kfA,function(e){return e.style}),x=r.opt(s.kfB,function(e){return e.style});if(null==L&&null==x)return;null==L?L=x:null==x&&(x=L);var D,C,M,_=new f.FormaStyleChangedEvent(n);if(n.beginUpdate(_),t.setBlendedRoles(n.style.colors,L.colors,x.colors,S),(D=r.as(L,A.LockupStyle))&&(C=r.as(x,A.LockupStyle))&&(M=r.as(n.style,A.LockupStyle)))for(var E=r.keys(M.characterStyles),O=r.iter(E);!O.done;O.next()){var w,N,P,K=O.value;(w=D.characterStyles[K])&&(N=C.characterStyles[K])&&(P=M.characterStyles[K])&&t.setBlendedRoles(P.colors,w.colors,N.colors,S)}var R,U=(1-S)*L.opacity+S*x.opacity,B=r.as(r.opt(r.opt(r.as(n,b.TextForma),function(e){return e.lockupForma}),function(e){return e.controller}),I.TypeLockupController);if(n.isTypeLockup()||null!=B){var V,W,j=U,Y=U;(V=r.as(L,A.LockupStyle))&&(W=r.as(x,A.LockupStyle))&&(j=(1-S)*V.textOpacity+S*W.textOpacity,Y=(1-S)*V.backingOpacity+S*W.backingOpacity),n.kind==g.ShapeForma.KIND?r.opt(n.parent,function(e){return e.style.opacity=Y}):n.kind==b.TextForma.KIND?n.style.opacity=j:n.kind==T.GroupForma.KIND&&n.visitAll(c.FormaTraversal.PreOrder,function(e){e instanceof b.TextForma&&r.opt(e.parent,function(e){return e.style.opacity=j}),e instanceof g.ShapeForma&&r.opt(e.parent,function(e){return e.style.opacity=Y})})}else if(n.kind==d.FrameForma.KIND){var G;(G=v.ImageFacade.getImageFormaForForma(n))&&(G.style.opacity=U)}else n.style.opacity=U;if(null!=L.filter&&null!=x.filter)if(o.animationStyle.name==l.AnimationStyle.NAME_BLUR){if(R=L.clone()){R.colorLibrary=L.colorLibrary;var q=L.filter.blurRadius,Z=x.filter.blurRadius;R.filter.blurRadius=(1-S)*q+S*Z,n.applyStyle(R)}}else if(!r.opt(L.filter,function(e){return e.equals(x.filter)})){var X=new h.AlphaBlendFilter(void 0,S,L.filter,x.filter);X.style=n.style,n.style.filter=X}n.endUpdate(_)}}})}),n=r.opt(this.document_,function(e){return e.firstPage.root})){var a=new f.AnimationTimeChangedEvent(n,e);n.beginUpdate(a),n.endUpdate(a)}return r.opt(this.document_,function(e){return e.firstPage.endUpdate(o)}),i},setBlendedRoles:function(e,t,n,i){var o,a;(o=t.fieldPrimary)&&(a=n.fieldPrimary)&&e.setBlendedColor(m.ColorRole.FieldPrimary,o,a,i),(o=t.fieldSecondary)&&(a=n.fieldSecondary)&&e.setBlendedColor(m.ColorRole.FieldSecondary,o,a,i)}}}),o)},50:function(e,t,n){var i,o,a,r,l=t,s=n(0),u=n(1),m=n(4);l.TheoMessageStatisticsEntry=(i=function(){this.instantiationCount=0,this.publishCount=0,this.dispatchCount=0},s.defineClass({name:"TheoMessageStatisticsEntry",ctor:i}),i),l.TheoMessageStatistics=(o=function(){this.lookup_={},this.totalInstantiations_=0,this.totalPublications_=0},a={},s.defineClass({name:"TheoMessageStatistics",ctor:o,statics:{instance:{get:function(){return void 0===a.instance&&(a.instance=new o),a.instance}}},props:{inited:function(e){},published:function(e,t){},dumpStats:function(){u.CoreAssert.info("TheoMessageStatistics:"),u.CoreAssert.info("- Total messages created/published: "+this.totalInstantiations_+" / "+this.totalPublications_);for(var e=s.iter(this.lookup_);!e.done;e.next()){var t=e.key,n=e.value;u.CoreAssert.info("- "+t+": "+n.instantiationCount+" / "+n.publishCount+" -> "+n.dispatchCount)}}}}),o),l.TheoMessage=(r=function(e,t){this.type=e,this.publisher=t,m.CoreObject.call(this),l.TheoMessageStatistics.instance.inited(this)},s.defineClass({name:"TheoMessage",ctor:r,superName:"CoreObject"}),r),l.TheoMessageSubscription=s.defineProtocol("TheoMessageSubscription",{unsubscribe:"() -> Void"}),l.TheoMessagePublisher=s.defineProtocol("TheoMessagePublisher",{subscribeWithCallback:"((TheoMessage) -> Void, String) -> TheoMessageSubscription",subscribe:"(TheoMessageSubscriber, String) -> TheoMessageSubscription",unsubscribe:"(TheoMessageSubscription) -> Void"}),l.TheoMessageSubscriber=s.defineProtocol("TheoMessageSubscriber",{onMessage:"(TheoMessage) -> Void"})},90:function(e,t,n){var i,o=t,a=n(0),r=n(4),l=n(305);o.TheoPublishingObject=(i=function(){this.publishing_=new l.TheoBasePublishing,r.CoreObject.call(this),this.publishing_.owner=this},a.defineClass({name:"TheoPublishingObject",ctor:i,superName:"CoreObject",statics:{_implements:function(e){return"TheoMessagePublisher"==e}},props:{subscribeWithCallback:function(e,t){return this.publishing_.subscribeWithCallback(e,t)},subscribe:function(e,t){return this.publishing_.subscribe(e,t)},unsubscribe:function(e){return this.publishing_.unsubscribe(e)},publish:function(e){return this.publishing_.publish(e)}}}),i)}}]);
//# sourceMappingURL=logomaker-entry_c20ba88b-8b32ab87.js.map